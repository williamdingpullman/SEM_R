<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Poisson Regression | SEM and R</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Poisson Regression | SEM and R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Poisson Regression | SEM and R" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Bill" />


<meta name="date" content="2021-05-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bootstrapping.html"/>
<link rel="next" href="use-r-for-mediation.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SEM and R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> SEM and R</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#definitions-basic-concepts"><i class="fa fa-check"></i><b>2.1</b> Definitions (Basic Concepts)</a><ul>
<li class="chapter" data-level="2.1.1" data-path="intro.html"><a href="intro.html#observed-variable"><i class="fa fa-check"></i><b>2.1.1</b> Observed variable</a></li>
<li class="chapter" data-level="2.1.2" data-path="intro.html"><a href="intro.html#latent-variable"><i class="fa fa-check"></i><b>2.1.2</b> Latent variable</a></li>
<li class="chapter" data-level="2.1.3" data-path="intro.html"><a href="intro.html#exogenous-variable"><i class="fa fa-check"></i><b>2.1.3</b> Exogenous variable</a></li>
<li class="chapter" data-level="2.1.4" data-path="intro.html"><a href="intro.html#endogenous-variable"><i class="fa fa-check"></i><b>2.1.4</b> Endogenous variable</a></li>
<li class="chapter" data-level="2.1.5" data-path="intro.html"><a href="intro.html#measurement-model"><i class="fa fa-check"></i><b>2.1.5</b> Measurement model</a></li>
<li class="chapter" data-level="2.1.6" data-path="intro.html"><a href="intro.html#indicator-in-a-measurement-model"><i class="fa fa-check"></i><b>2.1.6</b> Indicator (in a measurement model)</a></li>
<li class="chapter" data-level="2.1.7" data-path="intro.html"><a href="intro.html#factor"><i class="fa fa-check"></i><b>2.1.7</b> Factor</a></li>
<li class="chapter" data-level="2.1.8" data-path="intro.html"><a href="intro.html#loading"><i class="fa fa-check"></i><b>2.1.8</b> Loading</a></li>
<li class="chapter" data-level="2.1.9" data-path="intro.html"><a href="intro.html#structural-model"><i class="fa fa-check"></i><b>2.1.9</b> Structural model</a></li>
<li class="chapter" data-level="2.1.10" data-path="intro.html"><a href="intro.html#regerssion-path"><i class="fa fa-check"></i><b>2.1.10</b> Regerssion path</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#the-path-diagram"><i class="fa fa-check"></i><b>2.2</b> The path diagram</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#lavaan-syntax"><i class="fa fa-check"></i><b>2.3</b> Lavaan syntax</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#regression-and-path-analysis"><i class="fa fa-check"></i><b>2.4</b> Regression and path analysis</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="real-data-example-simple-linear-regression.html"><a href="real-data-example-simple-linear-regression.html"><i class="fa fa-check"></i><b>3</b> Real data example (Simple linear regression)</a><ul>
<li class="chapter" data-level="3.1" data-path="real-data-example-simple-linear-regression.html"><a href="real-data-example-simple-linear-regression.html#read-the-data-into-the-r-studio-environment."><i class="fa fa-check"></i><b>3.1</b> Read the data into the R Studio environment.</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="real-data-example-multiple-linear-regression.html"><a href="real-data-example-multiple-linear-regression.html"><i class="fa fa-check"></i><b>4</b> Real data example (Multiple linear regression)</a></li>
<li class="chapter" data-level="5" data-path="bootstrapping.html"><a href="bootstrapping.html"><i class="fa fa-check"></i><b>5</b> Bootstrapping</a><ul>
<li class="chapter" data-level="5.1" data-path="bootstrapping.html"><a href="bootstrapping.html#warning"><i class="fa fa-check"></i><b>5.1</b> Warning</a></li>
<li class="chapter" data-level="5.2" data-path="bootstrapping.html"><a href="bootstrapping.html#introduction"><i class="fa fa-check"></i><b>5.2</b> Introduction</a></li>
<li class="chapter" data-level="5.3" data-path="bootstrapping.html"><a href="bootstrapping.html#normal-distribution-sd-se"><i class="fa fa-check"></i><b>5.3</b> Normal distribution, SD, SE</a></li>
<li class="chapter" data-level="5.4" data-path="bootstrapping.html"><a href="bootstrapping.html#sample-function"><i class="fa fa-check"></i><b>5.4</b> Sample function</a></li>
<li class="chapter" data-level="5.5" data-path="bootstrapping.html"><a href="bootstrapping.html#proportion"><i class="fa fa-check"></i><b>5.5</b> Proportion</a></li>
<li class="chapter" data-level="5.6" data-path="bootstrapping.html"><a href="bootstrapping.html#boot-package"><i class="fa fa-check"></i><b>5.6</b> boot package</a></li>
<li class="chapter" data-level="5.7" data-path="bootstrapping.html"><a href="bootstrapping.html#concept-of-percentile"><i class="fa fa-check"></i><b>5.7</b> Concept of Percentile</a></li>
<li class="chapter" data-level="5.8" data-path="bootstrapping.html"><a href="bootstrapping.html#bootstrapping-for-correlation-interval"><i class="fa fa-check"></i><b>5.8</b> Bootstrapping for correlation interval</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="poisson-regression.html"><a href="poisson-regression.html"><i class="fa fa-check"></i><b>6</b> Poisson Regression</a><ul>
<li class="chapter" data-level="6.1" data-path="poisson-regression.html"><a href="poisson-regression.html#basic-idea"><i class="fa fa-check"></i><b>6.1</b> Basic idea</a></li>
<li class="chapter" data-level="6.2" data-path="poisson-regression.html"><a href="poisson-regression.html#trying-to-understand"><i class="fa fa-check"></i><b>6.2</b> Trying to understand</a></li>
<li class="chapter" data-level="6.3" data-path="poisson-regression.html"><a href="poisson-regression.html#deviance"><i class="fa fa-check"></i><b>6.3</b> Deviance</a></li>
<li class="chapter" data-level="6.4" data-path="poisson-regression.html"><a href="poisson-regression.html#overdispersion-using-another-example"><i class="fa fa-check"></i><b>6.4</b> Overdispersion (using another example)</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="use-r-for-mediation.html"><a href="use-r-for-mediation.html"><i class="fa fa-check"></i><b>7</b> Use R for mediation</a><ul>
<li class="chapter" data-level="7.1" data-path="use-r-for-mediation.html"><a href="use-r-for-mediation.html#normal-distribution-case"><i class="fa fa-check"></i><b>7.1</b> Normal Distribution Case</a></li>
<li class="chapter" data-level="7.2" data-path="use-r-for-mediation.html"><a href="use-r-for-mediation.html#poisson-distribution-case"><i class="fa fa-check"></i><b>7.2</b> Poisson Distribution Case</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://williamdingpullman.github.io/" target="blank">Bill's State Notes</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">SEM and R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="poisson-regression" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Poisson Regression</h1>
<div id="basic-idea" class="section level2">
<h2><span class="header-section-number">6.1</span> Basic idea</h2>
<p>The following is based on the lecture note of <a href="https://bookdown.org/roback/bookdown-BeyondMLR/ch-poissonreg.html" class="uri">https://bookdown.org/roback/bookdown-BeyondMLR/ch-poissonreg.html</a></p>
<p>There is also some R code related to this.</p>
<p><a href="https://rdrr.io/github/sta303-bolton/sta303w8/f/inst/rmarkdown/templates/philippines/skeleton/skeleton.Rmd" class="uri">https://rdrr.io/github/sta303-bolton/sta303w8/f/inst/rmarkdown/templates/philippines/skeleton/skeleton.Rmd</a></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1">data_HH &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/proback/BeyondMLR/master/data/fHH1.csv&quot;</span>)</a>
<a class="sourceLine" id="cb76-2" title="2"></a>
<a class="sourceLine" id="cb76-3" title="3"><span class="kw">head</span>(data_HH)</a></code></pre></div>
<pre><code>##   X     location age total numLT5                          roof
## 1 1 CentralLuzon  65     0      0 Predominantly Strong Material
## 2 2  MetroManila  75     3      0 Predominantly Strong Material
## 3 3  DavaoRegion  54     4      0 Predominantly Strong Material
## 4 4      Visayas  49     3      0 Predominantly Strong Material
## 5 5  MetroManila  74     3      0 Predominantly Strong Material
## 6 6      Visayas  59     6      0 Predominantly Strong Material</code></pre>
<p><span class="math display">\[log (\lambda_X) =\beta_0+\beta_1 X\]</span>
<span class="math display">\[log (\lambda_{X+1}) =\beta_0+\beta_1 (X+1)\]</span></p>
<p>Thus,</p>
<p><span class="math display">\[log (\lambda_{X+1})-log (\lambda_X) =(\beta_0+\beta_1 (X+1))-(\beta_0+\beta_1 X)\]</span></p>
<p>Thus,</p>
<p><span class="math display">\[log (\frac{\lambda_{X+1}}{\lambda_X}) =\beta_1\]</span></p>
<p>Thus,</p>
<p><span class="math display">\[\frac{\lambda_{X+1}}{\lambda_X} =e^{\beta_1}\]</span></p>
<p>Note that, <span class="math inline">\(\lambda\)</span> here is the mean. It is poisson regression, and the parameter is the mean. Thus, <span class="math inline">\(\frac{\lambda_{X+1}}{\lambda_X} =e^{\beta_1}\)</span> suggests the ratio change in the DV as the IV change in one unit.</p>
<p><span class="math display">\[log (\hat{\lambda}) =b_0+b_1 Age\]</span></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1">result_<span class="dv">1</span> =<span class="st"> </span><span class="kw">glm</span>(total <span class="op">~</span><span class="st"> </span>age, <span class="dt">family =</span> poisson, <span class="dt">data =</span> data_HH)</a>
<a class="sourceLine" id="cb78-2" title="2"><span class="kw">summary</span>(result_<span class="dv">1</span>)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = total ~ age, family = poisson, data = data_HH)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.9079  -0.9637  -0.2155   0.6092   4.9561  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  1.5499422  0.0502754  30.829  &lt; 2e-16 ***
## age         -0.0047059  0.0009363  -5.026 5.01e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 2362.5  on 1499  degrees of freedom
## Residual deviance: 2337.1  on 1498  degrees of freedom
## AIC: 6714
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p><span class="math display">\[\frac{\lambda_{Age+1}}{\lambda_{Age}} =e^{\beta_1}=e^{-0.0047}=0.995\]</span></p>
<p>But, what does it mean? It is a bit tricky. But, we can make some modification to help us understand.</p>
<p><span class="math display">\[\lambda_{Age+1} =0.995 \lambda_{Age}\]</span>
<span class="math display">\[\lambda_{Age+1} - \lambda_{Age}=0.995 \lambda_{Age}- \lambda_{Age}=-0.005 \lambda_{Age}\]</span>
Thus, we can understand that, the difference in the household size mean by changing 1 unit of age (i.e., <span class="math inline">\(\lambda_{Age+1} - \lambda_{Age}\)</span>) is <span class="math inline">\(-0.005 \lambda_{Age}\)</span>.</p>
<p>That is, the difference in the household size mean by changing 1 unit of age (i.e., <span class="math inline">\(\lambda_{Age+1} - \lambda_{Age}\)</span>) is a decrease of 5% of <span class="math inline">\(\lambda_{Age}\)</span>.</p>
<p>We can then calculate the confidence interval.</p>
<p><span class="math display">\[(\hat{\beta_1}-Z*SE(\hat{\beta_1}), \hat{\beta_1}+Z*SE(\hat{\beta_1}))\]</span></p>
<p><span class="math display">\[(-0.0047-1.96*0.00094,-0.0047+1.96*0.00094)=(−0.0065,−0.0029)\]</span></p>
<p>We can then plug them back to the exponential.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="kw">exp</span>(−<span class="fl">0.0065</span>)</a></code></pre></div>
<pre><code>## [1] 0.9935211</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="kw">exp</span>(−<span class="fl">0.0029</span>)</a></code></pre></div>
<pre><code>## [1] 0.9971042</code></pre>
<p><span class="math display">\[(e^{−0.0065},e^{−0.0029})=(0.9935,0.9971)\]</span></p>
<p>You can also get the confidence interval directly use R code</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="kw">confint</span>(result_<span class="dv">1</span>)</a></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<pre><code>##                    2.5 %       97.5 %
## (Intercept)  1.451170100  1.648249185
## age         -0.006543163 -0.002872717</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="kw">exp</span>(<span class="kw">confint</span>(result_<span class="dv">1</span>))</a></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<pre><code>##                 2.5 %    97.5 %
## (Intercept) 4.2681057 5.1978713
## age         0.9934782 0.9971314</code></pre>
<p>Note that, we use original beta to construct a confidence interval and then exponentiate the endpoints is due to the fact that the oringal one is more close to normal distribution.</p>
</div>
<div id="trying-to-understand" class="section level2">
<h2><span class="header-section-number">6.2</span> Trying to understand</h2>
<p>With <span class="math inline">\(\hat{\beta_0} = 1.55\)</span> and <span class="math inline">\(\hat{\beta_1}=-0.005\)</span>, we can write down the following. I also simulated the data and showed the relationship between X and Y. As we can see the figure, the relationship is pretty linear. Thus, something to keep in mind, the poisson distribution we typically see is the histogram of Y, rather than the relationship between X and Y.</p>
<p><span class="math display">\[log(\hat{\lambda})=1.55-0.005 Age\]</span>
<span class="math display">\[\hat{\lambda}=e^{1.55-0.005 Age}\]</span></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1">data_age&lt;-<span class="kw">seq</span>(<span class="dv">10</span>,<span class="dv">100</span>,<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb90-2" title="2">f_age&lt;-<span class="cf">function</span>(x){<span class="kw">exp</span>(<span class="fl">1.55</span><span class="op">-</span>(<span class="fl">0.005</span><span class="op">*</span>x))}</a>
<a class="sourceLine" id="cb90-3" title="3"><span class="kw">cbind</span>(data_age,<span class="kw">f_age</span>(data_age))</a></code></pre></div>
<pre><code>##        data_age         
##   [1,]     10.0 4.481689
##   [2,]     10.5 4.470499
##   [3,]     11.0 4.459337
##   [4,]     11.5 4.448202
##   [5,]     12.0 4.437096
##   [6,]     12.5 4.426017
##   [7,]     13.0 4.414965
##   [8,]     13.5 4.403942
##   [9,]     14.0 4.392946
##  [10,]     14.5 4.381977
##  [11,]     15.0 4.371036
##  [12,]     15.5 4.360122
##  [13,]     16.0 4.349235
##  [14,]     16.5 4.338376
##  [15,]     17.0 4.327543
##  [16,]     17.5 4.316738
##  [17,]     18.0 4.305960
##  [18,]     18.5 4.295208
##  [19,]     19.0 4.284483
##  [20,]     19.5 4.273786
##  [21,]     20.0 4.263115
##  [22,]     20.5 4.252470
##  [23,]     21.0 4.241852
##  [24,]     21.5 4.231261
##  [25,]     22.0 4.220696
##  [26,]     22.5 4.210157
##  [27,]     23.0 4.199645
##  [28,]     23.5 4.189159
##  [29,]     24.0 4.178699
##  [30,]     24.5 4.168265
##  [31,]     25.0 4.157858
##  [32,]     25.5 4.147476
##  [33,]     26.0 4.137120
##  [34,]     26.5 4.126791
##  [35,]     27.0 4.116486
##  [36,]     27.5 4.106208
##  [37,]     28.0 4.095955
##  [38,]     28.5 4.085728
##  [39,]     29.0 4.075527
##  [40,]     29.5 4.065351
##  [41,]     30.0 4.055200
##  [42,]     30.5 4.045075
##  [43,]     31.0 4.034975
##  [44,]     31.5 4.024900
##  [45,]     32.0 4.014850
##  [46,]     32.5 4.004825
##  [47,]     33.0 3.994826
##  [48,]     33.5 3.984851
##  [49,]     34.0 3.974902
##  [50,]     34.5 3.964977
##  [51,]     35.0 3.955077
##  [52,]     35.5 3.945201
##  [53,]     36.0 3.935351
##  [54,]     36.5 3.925525
##  [55,]     37.0 3.915723
##  [56,]     37.5 3.905946
##  [57,]     38.0 3.896193
##  [58,]     38.5 3.886465
##  [59,]     39.0 3.876761
##  [60,]     39.5 3.867081
##  [61,]     40.0 3.857426
##  [62,]     40.5 3.847794
##  [63,]     41.0 3.838187
##  [64,]     41.5 3.828603
##  [65,]     42.0 3.819044
##  [66,]     42.5 3.809508
##  [67,]     43.0 3.799996
##  [68,]     43.5 3.790508
##  [69,]     44.0 3.781043
##  [70,]     44.5 3.771603
##  [71,]     45.0 3.762185
##  [72,]     45.5 3.752792
##  [73,]     46.0 3.743421
##  [74,]     46.5 3.734075
##  [75,]     47.0 3.724751
##  [76,]     47.5 3.715451
##  [77,]     48.0 3.706174
##  [78,]     48.5 3.696920
##  [79,]     49.0 3.687689
##  [80,]     49.5 3.678481
##  [81,]     50.0 3.669297
##  [82,]     50.5 3.660135
##  [83,]     51.0 3.650996
##  [84,]     51.5 3.641880
##  [85,]     52.0 3.632787
##  [86,]     52.5 3.623716
##  [87,]     53.0 3.614668
##  [88,]     53.5 3.605643
##  [89,]     54.0 3.596640
##  [90,]     54.5 3.587659
##  [91,]     55.0 3.578701
##  [92,]     55.5 3.569766
##  [93,]     56.0 3.560853
##  [94,]     56.5 3.551962
##  [95,]     57.0 3.543093
##  [96,]     57.5 3.534246
##  [97,]     58.0 3.525421
##  [98,]     58.5 3.516619
##  [99,]     59.0 3.507838
## [100,]     59.5 3.499080
## [101,]     60.0 3.490343
## [102,]     60.5 3.481628
## [103,]     61.0 3.472935
## [104,]     61.5 3.464263
## [105,]     62.0 3.455613
## [106,]     62.5 3.446985
## [107,]     63.0 3.438379
## [108,]     63.5 3.429793
## [109,]     64.0 3.421230
## [110,]     64.5 3.412687
## [111,]     65.0 3.404166
## [112,]     65.5 3.395666
## [113,]     66.0 3.387188
## [114,]     66.5 3.378730
## [115,]     67.0 3.370294
## [116,]     67.5 3.361879
## [117,]     68.0 3.353485
## [118,]     68.5 3.345111
## [119,]     69.0 3.336759
## [120,]     69.5 3.328428
## [121,]     70.0 3.320117
## [122,]     70.5 3.311827
## [123,]     71.0 3.303558
## [124,]     71.5 3.295309
## [125,]     72.0 3.287081
## [126,]     72.5 3.278874
## [127,]     73.0 3.270687
## [128,]     73.5 3.262520
## [129,]     74.0 3.254374
## [130,]     74.5 3.246248
## [131,]     75.0 3.238143
## [132,]     75.5 3.230058
## [133,]     76.0 3.221993
## [134,]     76.5 3.213948
## [135,]     77.0 3.205923
## [136,]     77.5 3.197918
## [137,]     78.0 3.189933
## [138,]     78.5 3.181968
## [139,]     79.0 3.174023
## [140,]     79.5 3.166098
## [141,]     80.0 3.158193
## [142,]     80.5 3.150307
## [143,]     81.0 3.142441
## [144,]     81.5 3.134595
## [145,]     82.0 3.126768
## [146,]     82.5 3.118961
## [147,]     83.0 3.111174
## [148,]     83.5 3.103405
## [149,]     84.0 3.095657
## [150,]     84.5 3.087927
## [151,]     85.0 3.080217
## [152,]     85.5 3.072526
## [153,]     86.0 3.064854
## [154,]     86.5 3.057202
## [155,]     87.0 3.049568
## [156,]     87.5 3.041954
## [157,]     88.0 3.034358
## [158,]     88.5 3.026782
## [159,]     89.0 3.019224
## [160,]     89.5 3.011686
## [161,]     90.0 3.004166
## [162,]     90.5 2.996665
## [163,]     91.0 2.989183
## [164,]     91.5 2.981719
## [165,]     92.0 2.974274
## [166,]     92.5 2.966848
## [167,]     93.0 2.959440
## [168,]     93.5 2.952050
## [169,]     94.0 2.944680
## [170,]     94.5 2.937327
## [171,]     95.0 2.929993
## [172,]     95.5 2.922677
## [173,]     96.0 2.915379
## [174,]     96.5 2.908100
## [175,]     97.0 2.900839
## [176,]     97.5 2.893596
## [177,]     98.0 2.886371
## [178,]     98.5 2.879164
## [179,]     99.0 2.871975
## [180,]     99.5 2.864804
## [181,]    100.0 2.857651</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="kw">plot</span>(data_age,<span class="kw">f_age</span>(data_age))</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1"><span class="kw">hist</span>(<span class="kw">f_age</span>(data_age))</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-26-2.png" width="672" /></p>
</div>
<div id="deviance" class="section level2">
<h2><span class="header-section-number">6.3</span> Deviance</h2>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1">basic_model &lt;-<span class="st"> </span><span class="kw">glm</span>(total <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">family =</span> poisson, <span class="dt">data =</span> data_HH)</a>
<a class="sourceLine" id="cb94-2" title="2">deviance_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">anova</span>(basic_model, result_<span class="dv">1</span>, <span class="dt">test =</span> <span class="st">&quot;Chisq&quot;</span>)</a>
<a class="sourceLine" id="cb94-3" title="3">deviance_<span class="dv">1</span></a></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: total ~ 1
## Model 2: total ~ age
##   Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
## 1      1499     2362.5                          
## 2      1498     2337.1  1   25.399 4.661e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="overdispersion-using-another-example" class="section level2">
<h2><span class="header-section-number">6.4</span> Overdispersion (using another example)</h2>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1">data_edu&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/proback/BeyondMLR/master/data/c_data.csv&quot;</span>)</a>
<a class="sourceLine" id="cb96-2" title="2"><span class="kw">head</span>(data_edu)</a></code></pre></div>
<pre><code>##   Enrollment type nv     nvrate enroll1000 region
## 1       5590    U 30 5.36672630      5.590     SE
## 2        540    C  0 0.00000000      0.540     SE
## 3      35747    U 23 0.64341064     35.747      W
## 4      28176    C  1 0.03549120     28.176      W
## 5      10568    U  1 0.09462528     10.568     SW
## 6       3127    U  0 0.00000000      3.127     SW</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1"><span class="kw">hist</span>(data_edu<span class="op">$</span>nv)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1">results_<span class="dv">3</span>&lt;-<span class="st"> </span><span class="kw">glm</span>(nv <span class="op">~</span><span class="st"> </span>type <span class="op">+</span><span class="st"> </span>region, <span class="dt">family =</span> poisson,</a>
<a class="sourceLine" id="cb99-2" title="2">               <span class="dt">offset =</span> <span class="kw">log</span>(enroll1000), <span class="dt">data =</span> data_edu)</a>
<a class="sourceLine" id="cb99-3" title="3"><span class="kw">summary</span>(results_<span class="dv">3</span>)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = nv ~ type + region, family = poisson, data = data_edu, 
##     offset = log(enroll1000))
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -4.5697  -1.9079  -0.7233   0.8738   8.4564  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.60161    0.17120  -9.355  &lt; 2e-16 ***
## typeU        0.34011    0.13234   2.570  0.01017 *  
## regionMW     0.09942    0.17752   0.560  0.57547    
## regionNE     0.78109    0.15305   5.103 3.33e-07 ***
## regionSE     0.87668    0.15314   5.725 1.04e-08 ***
## regionSW     0.50251    0.18508   2.715  0.00663 ** 
## regionW      0.27324    0.18741   1.458  0.14484    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 491.00  on 80  degrees of freedom
## Residual deviance: 426.01  on 74  degrees of freedom
## AIC: 657.89
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1">results_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw">glm</span>(nv <span class="op">~</span><span class="st"> </span>type <span class="op">+</span><span class="st"> </span>region, <span class="dt">family =</span> quasipoisson,</a>
<a class="sourceLine" id="cb101-2" title="2">               <span class="dt">offset =</span> <span class="kw">log</span>(enroll1000), <span class="dt">data =</span> data_edu)</a>
<a class="sourceLine" id="cb101-3" title="3"><span class="kw">summary</span>(results_<span class="dv">4</span>)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = nv ~ type + region, family = quasipoisson, data = data_edu, 
##     offset = log(enroll1000))
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -4.5697  -1.9079  -0.7233   0.8738   8.4564  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept) -1.60161    0.48312  -3.315  0.00142 **
## typeU        0.34011    0.37347   0.911  0.36542   
## regionMW     0.09942    0.50097   0.198  0.84324   
## regionNE     0.78109    0.43191   1.808  0.07460 . 
## regionSE     0.87668    0.43216   2.029  0.04609 * 
## regionSW     0.50251    0.52230   0.962  0.33913   
## regionW      0.27324    0.52887   0.517  0.60694   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for quasipoisson family taken to be 7.963687)
## 
##     Null deviance: 491.00  on 80  degrees of freedom
## Residual deviance: 426.01  on 74  degrees of freedom
## AIC: NA
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1">difference_dev &lt;-<span class="st"> </span><span class="kw">anova</span>(results_<span class="dv">4</span>, results_<span class="dv">3</span>, <span class="dt">test =</span> <span class="st">&quot;F&quot;</span>)</a>
<a class="sourceLine" id="cb103-2" title="2">difference_dev</a></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: nv ~ type + region
## Model 2: nv ~ type + region
##   Resid. Df Resid. Dev Df Deviance F Pr(&gt;F)
## 1        74     426.01                     
## 2        74     426.01  0        0</code></pre>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bootstrapping.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="use-r-for-mediation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
