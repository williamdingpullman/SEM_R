\documentclass[]{book}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdftitle={SEM and R},
            pdfauthor={Bill},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{natbib}
\bibliographystyle{apalike}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\providecommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}

  \title{SEM and R}
    \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
    \author{Bill}
    \preauthor{\centering\large\emph}
  \postauthor{\par}
      \predate{\centering\large\emph}
  \postdate{\par}
    \date{2021-04-21}

\usepackage{booktabs}
\usepackage{amsthm}
\makeatletter
\def\thm@space@setup{%
  \thm@preskip=8pt plus 2pt minus 4pt
  \thm@postskip=\thm@preskip
}
\makeatother

\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\hypertarget{sem-and-r}{%
\chapter{SEM and R}\label{sem-and-r}}

This is the starting point.

\hypertarget{intro}{%
\chapter{Introduction}\label{intro}}

The following R codes and texts are from UCLA website ``\url{https://stats.idre.ucla.edu/r/seminars/rsem/}'' and I do not own the copyright of the R codes or texts. I wrote this R Markdown file for my own study purpose.

\textbf{Given this consideration, please do NOT distribute this page in any way.}

\hypertarget{definitions-basic-concepts}{%
\section{Definitions (Basic Concepts)}\label{definitions-basic-concepts}}

\hypertarget{observed-variable}{%
\subsection{Observed variable}\label{observed-variable}}

Observed variable: A variable that exists in the data (a.k.a item or manifest variable)

\hypertarget{latent-variable}{%
\subsection{Latent variable}\label{latent-variable}}

Latent variable: A variable that is constructed and does not exist in the data.

\hypertarget{exogenous-variable}{%
\subsection{Exogenous variable}\label{exogenous-variable}}

Exogenous variable: An independent variable either observed (X) or latent (\(\xi\)) that explains an engogenous variable.

\hypertarget{endogenous-variable}{%
\subsection{Endogenous variable}\label{endogenous-variable}}

Endogenous variable: A dependent variable, either observed (Y) or latent (\(\eta\)) that has a causal path leading to it.

\hypertarget{measurement-model}{%
\subsection{Measurement model}\label{measurement-model}}

Measurement model: A model that links obseved variables with latent variables.

\hypertarget{indicator-in-a-measurement-model}{%
\subsection{Indicator (in a measurement model)}\label{indicator-in-a-measurement-model}}

Indicator: An observed variable in a measurement model (can be exogenous or endogenous).

\hypertarget{factor}{%
\subsection{Factor}\label{factor}}

Factor: A latent variable defined by its indicators (can be exogenous or endogeous).

\hypertarget{loading}{%
\subsection{Loading}\label{loading}}

Loading: A path between an indicator and a factor.

\hypertarget{structural-model}{%
\subsection{Structural model}\label{structural-model}}

Structural model: A model that specifies casual relationships among exogeous variables to endogeous variables (can be observed or latent).

\hypertarget{regerssion-path}{%
\subsection{Regerssion path}\label{regerssion-path}}

Regression path: A path between exogeous and endogeous variables (can be observed or latent).

\hypertarget{the-path-diagram}{%
\section{The path diagram}\label{the-path-diagram}}

Circles represent latent variables. Squares represent observed indicators. Triangles represent intercepts or means. One way arrows represent paths. Two-way arrows represent either variances or covariances.

\hypertarget{lavaan-syntax}{%
\section{Lavaan syntax}\label{lavaan-syntax}}

\(\sim\) \textbf{predict}: used for regression of observed outcome to observed predictors (e.g., \(y \sim x\)).

\(= \sim\) \textbf{indicator}: used for latent variable to observed indicator in factor analysis measurement models (e.g., \(f= \sim q+r+s\)).

\(\sim \sim\) \textbf{covariance}: (e.g., \(x \sim \sim x\)).

\(\sim 1\) \textbf{intercept or mean}: (e.g., \(x \sim 1\) estimates the mean of variable \(x\)).

\(1*\) \textbf{fixes parameter or loading to one}: (e.g., \(f =\sim 1*q\)).

\(NA *\) \textbf{free parameter or loading}: used to override default marker method (e.g., \(f=\sim NA * q\)).

\(a*\) \textbf{lables the parameter `a'}: used for model constraints (e.g., \(f=\sim a*q\)).

\hypertarget{regression-and-path-analysis}{%
\section{Regression and path analysis}\label{regression-and-path-analysis}}

\[y_{1}=b_{0}+b_{1}x_{1}+\epsilon_{1}\]
\[y_{1}=\alpha+\gamma_{1} x_{1}+\zeta_{1}\]

\(x_{1}\) single exogenous variable

\(y_{1}\) single endogenous variable

\(b_{0}\), \(\alpha_{1}\) intercept of \(y_{1}\) (alpha)

\(b_{1}\), \(\gamma_{1}\) regression coefficient (gamma)

\(\epsilon_{1}\), \(\zeta_{1}\) residual of \(y_{1}\) (epsilon, zeta)

\(\phi\) variance or covariance of the exogenous variable (phi)

\(\psi\) residual variance or covariance of the endogenous variable (psi)

\hypertarget{real-data-example-simple-linear-regression}{%
\chapter{Real data example (Simple linear regression)}\label{real-data-example-simple-linear-regression}}

\hypertarget{read-the-data-into-the-r-studio-environment.}{%
\section{Read the data into the R Studio environment.}\label{read-the-data-into-the-r-studio-environment.}}

It also calcuates the covariance matrix among all the variables in the data.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dat <-}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\StringTok{"https://stats.idre.ucla.edu/wp-content/uploads/2021/02/worland5.csv"}\NormalTok{)}
\KeywordTok{cov}\NormalTok{(dat)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        motiv harm stabi ppsych ses verbal read arith spell
## motiv    100   77    59    -25  25     32   53    60    59
## harm      77  100    58    -25  26     25   42    44    45
## stabi     59   58   100    -16  18     27   36    38    38
## ppsych   -25  -25   -16    100 -42    -40  -39   -24   -31
## ses       25   26    18    -42 100     40   43    37    33
## verbal    32   25    27    -40  40    100   56    49    48
## read      53   42    36    -39  43     56  100    73    87
## arith     60   44    38    -24  37     49   73   100    72
## spell     59   45    38    -31  33     48   87    72   100
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{(dat}\OperatorTok{$}\NormalTok{motiv)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 100
\end{verbatim}

In the following, we conduct a simple linear regression.
\[sample \ variance-covariance \ matrix \hat{\sum} = \mathbf{S} \]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{m1a <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(read }\OperatorTok{~}\StringTok{ }\NormalTok{motiv, }\DataTypeTok{data=}\NormalTok{dat)}
\NormalTok{(fit1a <-}\KeywordTok{summary}\NormalTok{(m1a))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = read ~ motiv, data = dat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -26.0995  -6.1109   0.2342   5.2237  24.0183 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(>|t|)    
## (Intercept) -1.232e-07  3.796e-01    0.00        1    
## motiv        5.300e-01  3.800e-02   13.95   <2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 8.488 on 498 degrees of freedom
## Multiple R-squared:  0.2809, Adjusted R-squared:  0.2795 
## F-statistic: 194.5 on 1 and 498 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(lavaan)}
\CommentTok{#simple regression using lavaan }
\NormalTok{m1b <-}\StringTok{   '}
\StringTok{  # regressions}
\StringTok{    read ~ 1+ motiv}
\StringTok{  # variance (optional)}
\StringTok{    motiv ~~ motiv}
\StringTok{'}

\NormalTok{fit1b <-}\StringTok{ }\KeywordTok{sem}\NormalTok{(m1b, }\DataTypeTok{data=}\NormalTok{dat)}
\KeywordTok{summary}\NormalTok{(fit1b)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## lavaan 0.6-8 ended normally after 14 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                         5
##                                                       
##   Number of observations                           500
##                                                       
## Model Test User Model:
##                                                       
##   Test statistic                                 0.000
##   Degrees of freedom                                 0
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(>|z|)
##   read ~                                              
##     motiv             0.530    0.038   13.975    0.000
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(>|z|)
##    .read             -0.000    0.379   -0.000    1.000
##     motiv             0.000    0.447    0.000    1.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(>|z|)
##     motiv            99.800    6.312   15.811    0.000
##    .read             71.766    4.539   15.811    0.000
\end{verbatim}

\hypertarget{real-data-example-multiple-linear-regression}{%
\chapter{Real data example (Multiple linear regression)}\label{real-data-example-multiple-linear-regression}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{m2 <-}\StringTok{ '}
\StringTok{  # regressions}
\StringTok{    read ~ 1 + ppsych + motiv}
\StringTok{ # covariance}
\StringTok{    ppsych ~~ motiv}
\StringTok{'}
\NormalTok{fit2 <-}\StringTok{ }\KeywordTok{sem}\NormalTok{(m2, }\DataTypeTok{data=}\NormalTok{dat)}
\KeywordTok{summary}\NormalTok{(fit2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## lavaan 0.6-8 ended normally after 34 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                         9
##                                                       
##   Number of observations                           500
##                                                       
## Model Test User Model:
##                                                       
##   Test statistic                                 0.000
##   Degrees of freedom                                 0
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(>|z|)
##   read ~                                              
##     ppsych           -0.275    0.037   -7.385    0.000
##     motiv             0.461    0.037   12.404    0.000
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(>|z|)
##   ppsych ~~                                           
##     motiv           -24.950    4.601   -5.423    0.000
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(>|z|)
##    .read              0.000    0.360    0.000    1.000
##     ppsych           -0.000    0.447   -0.000    1.000
##     motiv             0.000    0.447    0.000    1.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(>|z|)
##    .read             64.708    4.092   15.811    0.000
##     ppsych           99.800    6.312   15.811    0.000
##     motiv            99.800    6.312   15.811    0.000
\end{verbatim}

\hypertarget{bootstrapping}{%
\chapter{Bootstrapping}\label{bootstrapping}}

The following note is made when I was studying Bret Larget's note posted online.
\url{http://pages.stat.wisc.edu/~larget/stat302/chap3.pdf}

He used the data from LOck5data as an example.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(Lock5Data)}
\KeywordTok{data}\NormalTok{(CommuteAtlanta)}
\KeywordTok{str}\NormalTok{(CommuteAtlanta)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 'data.frame':    500 obs. of  5 variables:
##  $ City    : Factor w/ 1 level "Atlanta": 1 1 1 1 1 1 1 1 1 1 ...
##  $ Age     : int  19 55 48 45 48 43 48 41 47 39 ...
##  $ Distance: int  10 45 12 4 15 33 15 4 25 1 ...
##  $ Time    : int  15 60 45 10 30 60 45 10 25 15 ...
##  $ Sex     : Factor w/ 2 levels "F","M": 2 2 2 1 1 2 2 1 2 1 ...
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{time.mean =}\StringTok{ }\KeywordTok{with}\NormalTok{(CommuteAtlanta, }\KeywordTok{mean}\NormalTok{(Time))}

\NormalTok{time.mean}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 29.11
\end{verbatim}

Now, he sampled a (b times n) table. Note that, the Atlanta data has 500 row, as it has 500 observations (or, people). But, in the following new matrix, it is a (1000 times 500) table. Also, it should be noted that the logic of sample function in R. This webpage provides some insight into this function. Basically, the following R code randomly sample a bigger sample of (1000 times 500) from those 500 data points. After that, the matrix function put such (1000 times 500) data points into a matrix of (1000 times 500).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{B =}\StringTok{ }\DecValTok{1000}
\NormalTok{n =}\StringTok{ }\KeywordTok{nrow}\NormalTok{(CommuteAtlanta)}
\NormalTok{boot.samples =}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\KeywordTok{sample}\NormalTok{(CommuteAtlanta}\OperatorTok{$}\NormalTok{Time, }\DataTypeTok{size =}\NormalTok{ B }\OperatorTok{*}\StringTok{ }\NormalTok{n, }\DataTypeTok{replace =} \OtherTok{TRUE}\NormalTok{),}
\NormalTok{                      B, n)}
\end{Highlighting}
\end{Shaded}

Next, we need to calculate the mean for each row. Remember, we have 1000 rows. Note that, 1 in the apply function indicates that we calculate means on each row, whereas 2 indicates to each column.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{boot.statistics =}\StringTok{ }\KeywordTok{apply}\NormalTok{(boot.samples, }\DecValTok{1}\NormalTok{, mean)}
\end{Highlighting}
\end{Shaded}

We can then plot all the means.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{require}\NormalTok{(ggplot2)}
\KeywordTok{ggplot}\NormalTok{(}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{meanTime =}\NormalTok{ boot.statistics),}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{meanTime)) }\OperatorTok{+}
\KeywordTok{geom_histogram}\NormalTok{(}\DataTypeTok{binwidth=}\FloatTok{0.25}\NormalTok{,}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y=}\NormalTok{..density..)) }\OperatorTok{+}
\KeywordTok{geom_density}\NormalTok{(}\DataTypeTok{color=}\StringTok{"red"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{bookdown-demo_files/figure-latex/unnamed-chunk-8-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{time.se =}\StringTok{ }\KeywordTok{sd}\NormalTok{(boot.statistics)}
\NormalTok{time.se}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.9057424
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{me =}\StringTok{ }\KeywordTok{ceiling}\NormalTok{(}\DecValTok{10} \OperatorTok{*}\StringTok{ }\DecValTok{2} \OperatorTok{*}\StringTok{ }\NormalTok{time.se)}\OperatorTok{/}\DecValTok{10}
\NormalTok{me}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1.9
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{round}\NormalTok{(time.mean, }\DecValTok{1}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{) }\OperatorTok{*}\StringTok{ }\NormalTok{me}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 27.2 31.0
\end{verbatim}

Note, if we do not use bootstraping, we can use the standard CI formula (\url{https://www.mathsisfun.com/data/confidence-interval.html}). This formula assumes normal distribution. As we can see, this is close to the result based on the bootstrapping method.

\[\overline{X} \pm Z \frac{S}{\sqrt{n}}=29.11 \pm 1.96 \frac{20.72}{\sqrt{500}}=27.29, 30.93\]

Note that, in the following, the author used 2 times SE to calculate the CI. The relationship between SD and SE:

``Now the sample mean will vary from sample to sample; the way this variation occurs is described by the ``sampling distribution'' of the mean. We can estimate how much sample means will vary from the standard deviation of this sampling distribution, which we call the standard error (SE) of the estimate of the mean. As the standard error is a type of standard deviation, confusion is understandable. Another way of considering the standard error is as a measure of the precision of the sample mean." (\url{https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1255808/})

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{boot.mean =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(x,B,}\DataTypeTok{binwidth=}\OtherTok{NULL}\NormalTok{)}
\NormalTok{\{}
\NormalTok{n =}\StringTok{ }\KeywordTok{length}\NormalTok{(x)}
\NormalTok{boot.samples =}\StringTok{ }\KeywordTok{matrix}\NormalTok{( }\KeywordTok{sample}\NormalTok{(x,}\DataTypeTok{size=}\NormalTok{n}\OperatorTok{*}\NormalTok{B,}\DataTypeTok{replace=}\OtherTok{TRUE}\NormalTok{), B, n)}
\NormalTok{boot.statistics =}\StringTok{ }\KeywordTok{apply}\NormalTok{(boot.samples,}\DecValTok{1}\NormalTok{,mean)}
\NormalTok{se =}\StringTok{ }\KeywordTok{sd}\NormalTok{(boot.statistics)}
\KeywordTok{require}\NormalTok{(ggplot2)}
\ControlFlowTok{if}\NormalTok{ ( }\KeywordTok{is.null}\NormalTok{(binwidth) )}
\NormalTok{binwidth =}\StringTok{ }\KeywordTok{diff}\NormalTok{(}\KeywordTok{range}\NormalTok{(boot.statistics))}\OperatorTok{/}\DecValTok{30}
\NormalTok{p =}\StringTok{ }\KeywordTok{ggplot}\NormalTok{(}\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{x=}\NormalTok{boot.statistics),}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{x)) }\OperatorTok{+}
\KeywordTok{geom_histogram}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y=}\NormalTok{..density..),}\DataTypeTok{binwidth=}\NormalTok{binwidth) }\OperatorTok{+}\StringTok{ }\KeywordTok{geom_density}\NormalTok{(}\DataTypeTok{color=}\StringTok{"red"}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(p)}
\NormalTok{interval =}\StringTok{ }\KeywordTok{mean}\NormalTok{(x) }\OperatorTok{+}\StringTok{ }\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{)}\OperatorTok{*}\DecValTok{2}\OperatorTok{*}\NormalTok{se}
\KeywordTok{print}\NormalTok{( interval )}
\KeywordTok{return}\NormalTok{( }\KeywordTok{list}\NormalTok{(}\DataTypeTok{boot.statistics =}\NormalTok{ boot.statistics, }\DataTypeTok{interval=}\NormalTok{interval, }\DataTypeTok{se=}\NormalTok{se, }\DataTypeTok{plot=}\NormalTok{p) )}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{out =}\StringTok{ }\KeywordTok{with}\NormalTok{(CommuteAtlanta, }\KeywordTok{boot.mean}\NormalTok{(Distance, }\DataTypeTok{B =} \DecValTok{1000}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{bookdown-demo_files/figure-latex/unnamed-chunk-11-1.pdf}

\begin{verbatim}
## [1] 16.876 19.436
\end{verbatim}

To understand the function of sample in R.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{sample}\NormalTok{(}\DecValTok{20}\NormalTok{,}\DataTypeTok{replace =} \OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] 20 16  3  9  2  4 16 11  8 17 19  7  3 15  2 13 17  9  3 17
\end{verbatim}

The following uses loop to do the resampling. It uses sample function to index the numbers that they want to sample from the original sample. That is, {[}{]} suggests the indexing.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n =}\StringTok{ }\KeywordTok{length}\NormalTok{(CommuteAtlanta}\OperatorTok{$}\NormalTok{Distance)}
\NormalTok{B =}\StringTok{ }\DecValTok{1000}
\NormalTok{result =}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\OtherTok{NA}\NormalTok{, B)}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\NormalTok{B)}
\NormalTok{\{}
\NormalTok{boot.sample =}\StringTok{ }\KeywordTok{sample}\NormalTok{(n, }\DataTypeTok{replace =} \OtherTok{TRUE}\NormalTok{)}
\NormalTok{result[i] =}\StringTok{ }\KeywordTok{mean}\NormalTok{(CommuteAtlanta}\OperatorTok{$}\NormalTok{Distance[boot.sample])}
\NormalTok{\}}

\KeywordTok{with}\NormalTok{(CommuteAtlanta, }\KeywordTok{mean}\NormalTok{(Distance) }\OperatorTok{+}\StringTok{ }\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{) }\OperatorTok{*}\StringTok{ }\DecValTok{2} \OperatorTok{*}\StringTok{ }\KeywordTok{sd}\NormalTok{(result))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 16.93819 19.37381
\end{verbatim}

\bibliography{book.bib,packages.bib}


\end{document}
