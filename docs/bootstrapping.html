<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Bootstrapping | SEM and R</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Bootstrapping | SEM and R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Bootstrapping | SEM and R" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Bill" />


<meta name="date" content="2021-04-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="real-data-example-multiple-linear-regression.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SEM and R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> SEM and R</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#definitions-basic-concepts"><i class="fa fa-check"></i><b>2.1</b> Definitions (Basic Concepts)</a><ul>
<li class="chapter" data-level="2.1.1" data-path="intro.html"><a href="intro.html#observed-variable"><i class="fa fa-check"></i><b>2.1.1</b> Observed variable</a></li>
<li class="chapter" data-level="2.1.2" data-path="intro.html"><a href="intro.html#latent-variable"><i class="fa fa-check"></i><b>2.1.2</b> Latent variable</a></li>
<li class="chapter" data-level="2.1.3" data-path="intro.html"><a href="intro.html#exogenous-variable"><i class="fa fa-check"></i><b>2.1.3</b> Exogenous variable</a></li>
<li class="chapter" data-level="2.1.4" data-path="intro.html"><a href="intro.html#endogenous-variable"><i class="fa fa-check"></i><b>2.1.4</b> Endogenous variable</a></li>
<li class="chapter" data-level="2.1.5" data-path="intro.html"><a href="intro.html#measurement-model"><i class="fa fa-check"></i><b>2.1.5</b> Measurement model</a></li>
<li class="chapter" data-level="2.1.6" data-path="intro.html"><a href="intro.html#indicator-in-a-measurement-model"><i class="fa fa-check"></i><b>2.1.6</b> Indicator (in a measurement model)</a></li>
<li class="chapter" data-level="2.1.7" data-path="intro.html"><a href="intro.html#factor"><i class="fa fa-check"></i><b>2.1.7</b> Factor</a></li>
<li class="chapter" data-level="2.1.8" data-path="intro.html"><a href="intro.html#loading"><i class="fa fa-check"></i><b>2.1.8</b> Loading</a></li>
<li class="chapter" data-level="2.1.9" data-path="intro.html"><a href="intro.html#structural-model"><i class="fa fa-check"></i><b>2.1.9</b> Structural model</a></li>
<li class="chapter" data-level="2.1.10" data-path="intro.html"><a href="intro.html#regerssion-path"><i class="fa fa-check"></i><b>2.1.10</b> Regerssion path</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#the-path-diagram"><i class="fa fa-check"></i><b>2.2</b> The path diagram</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#lavaan-syntax"><i class="fa fa-check"></i><b>2.3</b> Lavaan syntax</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#regression-and-path-analysis"><i class="fa fa-check"></i><b>2.4</b> Regression and path analysis</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="real-data-example-simple-linear-regression.html"><a href="real-data-example-simple-linear-regression.html"><i class="fa fa-check"></i><b>3</b> Real data example (Simple linear regression)</a><ul>
<li class="chapter" data-level="3.1" data-path="real-data-example-simple-linear-regression.html"><a href="real-data-example-simple-linear-regression.html#read-the-data-into-the-r-studio-environment."><i class="fa fa-check"></i><b>3.1</b> Read the data into the R Studio environment.</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="real-data-example-multiple-linear-regression.html"><a href="real-data-example-multiple-linear-regression.html"><i class="fa fa-check"></i><b>4</b> Real data example (Multiple linear regression)</a></li>
<li class="chapter" data-level="5" data-path="bootstrapping.html"><a href="bootstrapping.html"><i class="fa fa-check"></i><b>5</b> Bootstrapping</a><ul>
<li class="chapter" data-level="5.1" data-path="bootstrapping.html"><a href="bootstrapping.html#warning"><i class="fa fa-check"></i><b>5.1</b> Warning</a></li>
<li class="chapter" data-level="5.2" data-path="bootstrapping.html"><a href="bootstrapping.html#introduction"><i class="fa fa-check"></i><b>5.2</b> Introduction</a></li>
<li class="chapter" data-level="5.3" data-path="bootstrapping.html"><a href="bootstrapping.html#normal-distribution-sd-se"><i class="fa fa-check"></i><b>5.3</b> Normal distribution, SD, SE</a></li>
<li class="chapter" data-level="5.4" data-path="bootstrapping.html"><a href="bootstrapping.html#sample-function"><i class="fa fa-check"></i><b>5.4</b> Sample function</a></li>
<li class="chapter" data-level="5.5" data-path="bootstrapping.html"><a href="bootstrapping.html#proportion"><i class="fa fa-check"></i><b>5.5</b> Proportion</a></li>
<li class="chapter" data-level="5.6" data-path="bootstrapping.html"><a href="bootstrapping.html#boot-package"><i class="fa fa-check"></i><b>5.6</b> boot package</a></li>
<li class="chapter" data-level="5.7" data-path="bootstrapping.html"><a href="bootstrapping.html#concept-of-percentile"><i class="fa fa-check"></i><b>5.7</b> Concept of Percentile</a></li>
<li class="chapter" data-level="5.8" data-path="bootstrapping.html"><a href="bootstrapping.html#bootstrapping-for-correlation-interval"><i class="fa fa-check"></i><b>5.8</b> Bootstrapping for correlation interval</a></li>
<li class="chapter" data-level="5.9" data-path="bootstrapping.html"><a href="bootstrapping.html#use-r-for-mediation"><i class="fa fa-check"></i><b>5.9</b> Use R for mediation</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://williamdingpullman.github.io/" target="blank">Bill's State Notes</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">SEM and R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bootstrapping" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Bootstrapping</h1>
<div id="warning" class="section level2">
<h2><span class="header-section-number">5.1</span> Warning</h2>
<p><strong>Warning:</strong></p>
<p><strong>This page is for my own personal study purpose. Distribution is prohibited.</strong></p>
<hr />
</div>
<div id="introduction" class="section level2">
<h2><span class="header-section-number">5.2</span> Introduction</h2>
<p>The following note is made when I was studying Bret Larget’s note posted online.
<a href="http://pages.stat.wisc.edu/~larget/stat302/chap3.pdf" class="uri">http://pages.stat.wisc.edu/~larget/stat302/chap3.pdf</a></p>
<p>He used the data from LOck5data as an example.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">library</span>(Lock5Data)</a>
<a class="sourceLine" id="cb14-2" title="2"><span class="kw">data</span>(CommuteAtlanta)</a>
<a class="sourceLine" id="cb14-3" title="3"><span class="kw">str</span>(CommuteAtlanta)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    500 obs. of  5 variables:
##  $ City    : Factor w/ 1 level &quot;Atlanta&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Age     : int  19 55 48 45 48 43 48 41 47 39 ...
##  $ Distance: int  10 45 12 4 15 33 15 4 25 1 ...
##  $ Time    : int  15 60 45 10 30 60 45 10 25 15 ...
##  $ Sex     : Factor w/ 2 levels &quot;F&quot;,&quot;M&quot;: 2 2 2 1 1 2 2 1 2 1 ...</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">time.mean =<span class="st"> </span><span class="kw">with</span>(CommuteAtlanta, <span class="kw">mean</span>(Time))</a>
<a class="sourceLine" id="cb16-2" title="2"></a>
<a class="sourceLine" id="cb16-3" title="3">time.mean</a></code></pre></div>
<pre><code>## [1] 29.11</code></pre>
<p>Now, he sampled a (b X n) table. Note that, the Atlanta data has 500 row, as it has 500 observations (or, people). But, in the following new matrix, it is a (1000 times 500) table. Also, it should be noted that the logic of sample function in R. This webpage provides some insight into this function. Basically, the following R code randomly sample a bigger sample of (1000 times 500) from those 500 data points. After that, the matrix function put such (1000 times 500) data points into a matrix of (1000 times 500).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">B =<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb18-2" title="2">n =<span class="st"> </span><span class="kw">nrow</span>(CommuteAtlanta)</a>
<a class="sourceLine" id="cb18-3" title="3">boot.samples =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">sample</span>(CommuteAtlanta<span class="op">$</span>Time, <span class="dt">size =</span> B <span class="op">*</span><span class="st"> </span>n, <span class="dt">replace =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb18-4" title="4">                      B, n)</a></code></pre></div>
<p>Next, we need to calculate the mean for each row. Remember, we have 1000 rows. Note that, 1 in the apply function indicates that we calculate means on each row, whereas 2 indicates to each column.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">boot.statistics =<span class="st"> </span><span class="kw">apply</span>(boot.samples, <span class="dv">1</span>, mean)</a></code></pre></div>
<p>We can then plot all the means.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">require</span>(ggplot2)</a></code></pre></div>
<pre><code>## Loading required package: ggplot2</code></pre>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 3.6.3</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">ggplot</span>(<span class="kw">data.frame</span>(<span class="dt">meanTime =</span> boot.statistics),<span class="kw">aes</span>(<span class="dt">x=</span>meanTime)) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="kw">geom_histogram</span>(<span class="dt">binwidth=</span><span class="fl">0.25</span>,<span class="kw">aes</span>(<span class="dt">y=</span>..density..)) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-3" title="3"><span class="kw">geom_density</span>(<span class="dt">color=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">time.se =<span class="st"> </span><span class="kw">sd</span>(boot.statistics)</a>
<a class="sourceLine" id="cb24-2" title="2">time.se</a></code></pre></div>
<pre><code>## [1] 0.9809293</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">me =<span class="st"> </span><span class="kw">ceiling</span>(<span class="dv">10</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>time.se)<span class="op">/</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb26-2" title="2">me</a></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw">round</span>(time.mean, <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>me</a></code></pre></div>
<pre><code>## [1] 27.1 31.1</code></pre>
</div>
<div id="normal-distribution-sd-se" class="section level2">
<h2><span class="header-section-number">5.3</span> Normal distribution, SD, SE</h2>
<p>Note, if we do not use bootstraping, we can use the standard CI formula (<a href="https://www.mathsisfun.com/data/confidence-interval.html" class="uri">https://www.mathsisfun.com/data/confidence-interval.html</a>). This formula assumes normal distribution. As we can see, this is close to the result based on the bootstrapping method.</p>
<p><span class="math display">\[\overline{X} \pm Z \frac{S}{\sqrt{n}}=29.11 \pm 1.96 \frac{20.72}{\sqrt{500}}=27.29, 30.93\]</span></p>
<p>Note that, in the following, the author used 2 times SE to calculate the CI. The relationship between SD and SE:</p>
<p>“Now the sample mean will vary from sample to sample; the way this variation occurs is described by the “sampling distribution” of the mean. We can estimate how much sample means will vary from the standard deviation of this sampling distribution, which we call the standard error (SE) of the estimate of the mean. As the standard error is a type of standard deviation, confusion is understandable. Another way of considering the standard error is as a measure of the precision of the sample mean." (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1255808/" class="uri">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1255808/</a>)</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">boot.mean =<span class="st"> </span><span class="cf">function</span>(x,B,<span class="dt">binwidth=</span><span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb30-2" title="2">{</a>
<a class="sourceLine" id="cb30-3" title="3">n =<span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb30-4" title="4">boot.samples =<span class="st"> </span><span class="kw">matrix</span>( <span class="kw">sample</span>(x,<span class="dt">size=</span>n<span class="op">*</span>B,<span class="dt">replace=</span><span class="ot">TRUE</span>), B, n)</a>
<a class="sourceLine" id="cb30-5" title="5">boot.statistics =<span class="st"> </span><span class="kw">apply</span>(boot.samples,<span class="dv">1</span>,mean)</a>
<a class="sourceLine" id="cb30-6" title="6">se =<span class="st"> </span><span class="kw">sd</span>(boot.statistics)</a>
<a class="sourceLine" id="cb30-7" title="7"><span class="kw">require</span>(ggplot2)</a>
<a class="sourceLine" id="cb30-8" title="8"><span class="cf">if</span> ( <span class="kw">is.null</span>(binwidth) )</a>
<a class="sourceLine" id="cb30-9" title="9">binwidth =<span class="st"> </span><span class="kw">diff</span>(<span class="kw">range</span>(boot.statistics))<span class="op">/</span><span class="dv">30</span></a>
<a class="sourceLine" id="cb30-10" title="10">p =<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">data.frame</span>(<span class="dt">x=</span>boot.statistics),<span class="kw">aes</span>(<span class="dt">x=</span>x)) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-11" title="11"><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y=</span>..density..),<span class="dt">binwidth=</span>binwidth) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">color=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb30-12" title="12"><span class="kw">plot</span>(p)</a>
<a class="sourceLine" id="cb30-13" title="13">interval =<span class="st"> </span><span class="kw">mean</span>(x) <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span><span class="op">*</span>se</a>
<a class="sourceLine" id="cb30-14" title="14"><span class="kw">print</span>( interval )</a>
<a class="sourceLine" id="cb30-15" title="15"><span class="kw">return</span>( <span class="kw">list</span>(<span class="dt">boot.statistics =</span> boot.statistics, <span class="dt">interval=</span>interval, <span class="dt">se=</span>se, <span class="dt">plot=</span>p) )</a>
<a class="sourceLine" id="cb30-16" title="16">}</a></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">out =<span class="st"> </span><span class="kw">with</span>(CommuteAtlanta, <span class="kw">boot.mean</span>(Distance, <span class="dt">B =</span> <span class="dv">1000</span>))</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre><code>## [1] 16.97163 19.34037</code></pre>
</div>
<div id="sample-function" class="section level2">
<h2><span class="header-section-number">5.4</span> Sample function</h2>
<p>To understand the function of sample in R.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">sample</span>(<span class="dv">20</span>,<span class="dt">replace =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>##  [1]  9  5  6  1 13 19 13 15 13  4  6  4  9  2  2 14 17  7 13  1</code></pre>
<p>The following uses loop to do the resampling. It uses sample function to index the numbers that they want to sample from the original sample. That is, [] suggests the indexing.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1">n =<span class="st"> </span><span class="kw">length</span>(CommuteAtlanta<span class="op">$</span>Distance)</a>
<a class="sourceLine" id="cb35-2" title="2">B =<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb35-3" title="3">result =<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, B)</a>
<a class="sourceLine" id="cb35-4" title="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B)</a>
<a class="sourceLine" id="cb35-5" title="5">{</a>
<a class="sourceLine" id="cb35-6" title="6">boot.sample =<span class="st"> </span><span class="kw">sample</span>(n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb35-7" title="7">result[i] =<span class="st"> </span><span class="kw">mean</span>(CommuteAtlanta<span class="op">$</span>Distance[boot.sample])</a>
<a class="sourceLine" id="cb35-8" title="8">}</a>
<a class="sourceLine" id="cb35-9" title="9"></a>
<a class="sourceLine" id="cb35-10" title="10"><span class="kw">with</span>(CommuteAtlanta, <span class="kw">mean</span>(Distance) <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(result))</a></code></pre></div>
<pre><code>## [1] 16.89894 19.41306</code></pre>
</div>
<div id="proportion" class="section level2">
<h2><span class="header-section-number">5.5</span> Proportion</h2>
<p>So far, we have dealed with means. How about porpotions?Remember that, when calculating means, it starts with a single column of data to calculate the mean. Similarly, when calculating porpotions, you can just use a single column of data.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1">reeses =<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">11</span>), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">19</span>))</a>
<a class="sourceLine" id="cb37-2" title="2">reeses.boot =<span class="st"> </span><span class="kw">boot.mean</span>(reeses, <span class="dv">1000</span>, <span class="dt">binwidth =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">30</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<pre><code>## [1] 0.1932690 0.5400644</code></pre>
<p>However, if we have 48 students (i.e., 48 observations) and thus we have a bigger sample. However, how can we do re-sampling? Based on the note, it is kind of simple. They group them together and then resample from it. Note that, when they re-sampling, the programming do not distinguish the difference between 48 observations. But just combined them as a single column (741+699=1440), and then generate a very long column (1440 times 1000) and then reshape it into a matrix (1440 time 1000). This is the basic logic of the boot.mean function.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">reeses =<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">741</span>), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">699</span>))</a>
<a class="sourceLine" id="cb39-2" title="2">reeses.boot =<span class="st"> </span><span class="kw">boot.mean</span>(reeses, <span class="dv">1000</span>, <span class="dt">binwidth =</span> <span class="fl">0.005</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre><code>## [1] 0.4876605 0.5415062</code></pre>
</div>
<div id="boot-package" class="section level2">
<h2><span class="header-section-number">5.6</span> boot package</h2>
<p>After having a basic idea of boostrapping, we can then use the package of boot.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="kw">library</span>(boot)</a></code></pre></div>
<pre><code>## Warning: package &#39;boot&#39; was built under R version 3.6.3</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="kw">data</span>(CommuteAtlanta)</a>
<a class="sourceLine" id="cb43-2" title="2"></a>
<a class="sourceLine" id="cb43-3" title="3">my.mean =<span class="st"> </span><span class="cf">function</span>(x, indices)</a>
<a class="sourceLine" id="cb43-4" title="4">{</a>
<a class="sourceLine" id="cb43-5" title="5"><span class="kw">return</span>( <span class="kw">mean</span>( x[indices] ) )</a>
<a class="sourceLine" id="cb43-6" title="6">}</a>
<a class="sourceLine" id="cb43-7" title="7"></a>
<a class="sourceLine" id="cb43-8" title="8">time.boot =<span class="st"> </span><span class="kw">boot</span>(CommuteAtlanta<span class="op">$</span>Time, my.mean, <span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb43-9" title="9"></a>
<a class="sourceLine" id="cb43-10" title="10"><span class="kw">boot.ci</span>(time.boot)</a></code></pre></div>
<pre><code>## Warning in boot.ci(time.boot): bootstrap variances needed for studentized
## intervals</code></pre>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 10000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = time.boot)
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   (27.30, 30.90 )   (27.27, 30.88 )  
## 
## Level     Percentile            BCa          
## 95%   (27.34, 30.95 )   (27.41, 31.02 )  
## Calculations and Intervals on Original Scale</code></pre>
</div>
<div id="concept-of-percentile" class="section level2">
<h2><span class="header-section-number">5.7</span> Concept of Percentile</h2>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="kw">require</span>(Lock5Data)</a>
<a class="sourceLine" id="cb46-2" title="2"><span class="kw">data</span>(ImmuneTea)</a>
<a class="sourceLine" id="cb46-3" title="3">tea =<span class="st"> </span><span class="kw">with</span>(ImmuneTea, InterferonGamma[Drink<span class="op">==</span><span class="st">&quot;Tea&quot;</span>])</a>
<a class="sourceLine" id="cb46-4" title="4">coffee =<span class="st"> </span><span class="kw">with</span>(ImmuneTea, InterferonGamma[Drink<span class="op">==</span><span class="st">&quot;Coffee&quot;</span>])</a>
<a class="sourceLine" id="cb46-5" title="5">tea.mean =<span class="st"> </span><span class="kw">mean</span>(tea)</a>
<a class="sourceLine" id="cb46-6" title="6">coffee.mean =<span class="st"> </span><span class="kw">mean</span>(coffee)</a>
<a class="sourceLine" id="cb46-7" title="7">tea.n =<span class="st"> </span><span class="kw">length</span>(tea)</a>
<a class="sourceLine" id="cb46-8" title="8">coffee.n =<span class="st"> </span><span class="kw">length</span>(coffee)</a>
<a class="sourceLine" id="cb46-9" title="9"></a>
<a class="sourceLine" id="cb46-10" title="10"></a>
<a class="sourceLine" id="cb46-11" title="11"></a>
<a class="sourceLine" id="cb46-12" title="12">B =<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb46-13" title="13"><span class="co"># create empty arrays for the means of each sample</span></a>
<a class="sourceLine" id="cb46-14" title="14">tea.boot =<span class="st"> </span><span class="kw">numeric</span>(B)</a>
<a class="sourceLine" id="cb46-15" title="15">coffee.boot =<span class="st"> </span><span class="kw">numeric</span>(B)</a>
<a class="sourceLine" id="cb46-16" title="16"><span class="co"># Use a for loop to take the samples</span></a>
<a class="sourceLine" id="cb46-17" title="17"><span class="cf">for</span> ( i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B )</a>
<a class="sourceLine" id="cb46-18" title="18">  {</a>
<a class="sourceLine" id="cb46-19" title="19">tea.boot[i] =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sample</span>(tea,<span class="dt">size=</span>tea.n,<span class="dt">replace=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb46-20" title="20">coffee.boot[i] =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sample</span>(coffee,<span class="dt">size=</span>coffee.n,<span class="dt">replace=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb46-21" title="21">}</a>
<a class="sourceLine" id="cb46-22" title="22"></a>
<a class="sourceLine" id="cb46-23" title="23">boot.stat =<span class="st"> </span>tea.boot <span class="op">-</span><span class="st"> </span>coffee.boot</a>
<a class="sourceLine" id="cb46-24" title="24">boot.stat</a></code></pre></div>
<pre><code>##   [1] 17.8272727 14.6545455 24.4545455 25.0454545 10.1272727  2.6727273
##   [7] 31.8090909 27.1363636 12.1818182 20.4636364 13.1000000 18.4000000
##  [13] 18.3727273 10.9909091 14.3272727  4.7454545 11.9181818 16.8909091
##  [19] 34.7272727 20.8363636 14.6636364 13.5090909 22.2636364 19.2545455
##  [25] 22.5090909  5.7454545  9.3909091  8.0181818 22.5727273  1.0545455
##  [31] 19.7090909 25.4272727 28.5727273 17.2636364 23.0636364 29.3818182
##  [37]  2.9000000 23.9363636 25.7818182 28.2818182 23.4090909 11.6727273
##  [43] 21.4909091 14.0090909 23.7363636 17.0818182 30.4545455 20.0818182
##  [49] 21.3636364 15.3000000 16.5272727 32.3636364 26.9363636 13.9636364
##  [55] 12.7090909 18.5181818  6.0181818  8.6454545  9.0454545 10.5000000
##  [61] 32.7363636 21.4727273 25.5818182 17.9727273 -0.4090909 -1.3363636
##  [67]  4.0454545 19.3000000 26.0363636 12.2545455 19.9454545 12.6272727
##  [73] 21.0909091 -0.5272727  4.2727273 20.7727273 16.0545455 27.0454545
##  [79]  6.4363636 14.3727273  4.9000000 22.0000000  5.5909091 22.4272727
##  [85] 42.7000000 24.3090909 24.6000000 18.0727273 27.7000000 10.8545455
##  [91] 14.5818182 32.5727273  9.7909091 22.0727273 13.7181818 14.1636364
##  [97] 24.7000000 19.9363636 10.7909091 16.2818182 17.2909091 21.3727273
## [103] 15.5545455 30.3636364 14.7454545  2.0272727 17.6818182 28.9818182
## [109] 22.1818182 27.3727273 20.1454545 19.9000000  8.0000000 20.2909091
## [115] 28.3636364 12.7454545 34.5090909 19.2272727 22.0090909 23.2090909
## [121] 25.9272727 31.6090909 21.2545455 28.4272727  8.2272727 24.1636364
## [127]  6.0272727 25.4090909 22.8545455  3.7818182 12.7545455 22.2090909
## [133] 12.7636364  2.0181818 14.3090909 13.2454545 24.1000000 15.8636364
## [139]  2.7454545 26.7000000 31.2545455  6.0454545 28.1272727 13.4363636
## [145] 13.5181818 26.8818182 10.8090909  8.7454545  3.9090909 18.7727273
## [151] -3.9727273 12.7454545 29.0181818  4.8636364 19.9454545 16.7363636
## [157]  1.8727273  1.5181818 25.5818182 11.7000000 19.8454545 20.5090909
## [163]  7.7181818 23.6636364  3.7181818 21.2727273  7.1636364 16.0545455
## [169]  1.3909091 24.0363636 12.8909091 18.9181818 -1.7363636 14.4727273
## [175]  9.9818182 18.9272727 26.2272727 11.6545455 15.5909091 17.6818182
## [181] 18.6000000 25.8272727 22.7454545 20.9181818 28.4727273 21.3090909
## [187]  9.1090909 22.5545455 27.4090909 -1.1454545  3.8636364 10.4727273
## [193]  9.0090909 28.6363636 19.3363636 13.1000000 35.6000000 15.9363636
## [199]  3.3363636 12.7454545 23.7454545 13.7272727 14.4363636 16.6363636
## [205] 28.3454545 17.1727273 10.4181818  3.8000000 24.9363636 14.0272727
## [211] 17.1090909 30.0181818 14.3818182 14.3909091 14.4454545 20.2818182
## [217] 25.7545455 14.8363636 19.7181818 18.5818182 12.7818182 19.0181818
## [223] 22.9818182 13.4363636  3.4181818 10.0727273 13.8545455 27.4272727
## [229] 22.4727273 23.0090909 17.5181818 16.8545455 24.4454545 18.5272727
## [235] -1.5818182 16.9000000 22.0636364 18.7181818 26.1363636  4.1727273
## [241] 10.1545455 12.2818182 16.2636364 15.6000000 17.9363636 10.1727273
## [247] 20.6363636 31.8363636 11.6545455 12.6363636 24.4818182 15.4454545
## [253]  5.0181818 26.2090909  4.7181818 19.2000000 24.5818182 23.0454545
## [259] 10.4090909 12.0636364 21.2818182 30.5272727 29.5727273 31.8090909
## [265] 22.5181818  9.6909091  9.5090909 21.3454545 13.8909091 24.1090909
## [271] 29.7272727 21.4636364  8.4636364 25.5636364 11.2818182  7.4181818
## [277] 22.5636364 21.2818182 13.5181818 11.3272727 14.0636364 20.7545455
## [283]  6.4000000  7.4272727 16.5909091 20.5000000 22.6818182 14.2000000
## [289] 21.8636364 17.2818182 18.4909091 36.5181818 25.6454545 24.0090909
## [295] 23.0000000 31.9909091 22.0454545 28.8727273 24.6818182 23.3727273
## [301] 23.5545455 18.2727273 20.1272727 23.5727273 28.8454545 17.6636364
## [307] 21.1363636 20.9272727 18.1363636 11.6272727 11.2636364 15.8727273
## [313] 16.6818182 17.4727273  0.7818182 17.3000000 20.3545455 21.0909091
## [319] 25.9909091 10.4272727 21.9545455 14.8545455 22.4545455  7.0545455
## [325] 20.3363636 14.6272727 15.5727273 20.4727273 20.5363636 12.5636364
## [331]  5.4909091 24.1363636 24.8363636 28.1545455 25.5363636 33.2727273
## [337] 19.4363636 23.4545455  7.4909091 15.2000000  7.2272727 34.0090909
## [343] 17.4545455 20.1909091 12.2181818 33.1272727 27.3454545 15.2363636
## [349]  8.2272727 12.0545455 10.7000000 11.9181818  3.8000000  4.6272727
## [355] 26.0181818 23.7545455 12.5000000 22.8181818 11.0363636 21.4727273
## [361] 19.2909091 24.5727273 24.1000000 17.5272727  7.9090909 12.4000000
## [367] 25.2272727 16.4727273 13.3000000 11.7545455 17.1727273 16.7090909
## [373] 24.3363636 24.5727273  7.7090909 13.4909091 19.7363636  1.3181818
## [379] 14.3090909 23.2000000 21.1909091 18.8000000 21.3636364  2.3909091
## [385] 12.6090909 17.1272727  6.0636364 27.3272727 19.0000000 16.7090909
## [391] 24.0454545 16.2090909 26.1818182 14.3000000 10.9818182 26.6545455
## [397] 29.2818182 18.5818182 13.6818182 12.0818182 13.1545455 17.4000000
## [403] 18.3909091 13.3545455 14.9272727  9.4545455 13.2818182  6.2545455
## [409] 18.2545455 14.5909091 28.5181818  9.8727273 23.1727273  9.6636364
## [415] 21.0454545 20.7454545 14.4000000  4.0181818 26.9181818  3.7454545
## [421] 16.9545455 20.3000000 18.0090909 36.1181818  7.9090909 30.1000000
## [427] 21.3545455 33.3090909 17.8454545 13.1181818 21.0818182 14.3363636
## [433] 22.1000000 23.1909091  0.9000000 26.3545455 31.2454545 15.1545455
## [439] 18.1272727 18.6363636 16.6727273 25.7272727 12.2090909 13.9181818
## [445] 20.0545455 24.3545455 22.1363636 14.9000000 13.9000000 19.2181818
## [451] 25.2727273  1.5545455 25.7363636 22.9181818 11.9636364 23.1090909
## [457] 15.1636364 20.7272727 21.5727273 10.3000000 19.8000000 15.2545455
## [463] 34.2818182  5.4181818 18.0363636  5.7909091 25.9181818 22.6000000
## [469]  7.2636364 15.0727273 20.3545455 20.7454545 13.6363636 13.9272727
## [475] 15.0363636 21.3272727 25.4181818 12.6909091  0.5909091 20.3818182
## [481] 30.0818182 14.1454545 20.3727273 16.6363636  6.0727273 14.7727273
## [487] 16.2454545  0.9272727 25.9909091 11.6454545 24.6454545 19.8363636
## [493] 24.7636364 18.1090909 20.8909091 31.8636364 15.1181818  6.0636364
## [499] 17.2090909 26.3545455</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="co"># Find endpoints for 90%, 95%, and 99% bootstrap confidence intervals using percentiles.</span></a>
<a class="sourceLine" id="cb48-2" title="2"></a>
<a class="sourceLine" id="cb48-3" title="3"><span class="co"># 90%:  5% 95%</span></a>
<a class="sourceLine" id="cb48-4" title="4"><span class="kw">quantile</span>(boot.stat,<span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.95</span>))</a></code></pre></div>
<pre><code>##        5%       95% 
##  3.703182 30.113182</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="co"># 95%: 2.5% 97.5%</span></a>
<a class="sourceLine" id="cb50-2" title="2"><span class="kw">quantile</span>(boot.stat,<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</a></code></pre></div>
<pre><code>##      2.5%     97.5% 
##  1.352727 32.473409</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="co"># 99%:  0.5% 99.5%</span></a>
<a class="sourceLine" id="cb52-2" title="2"><span class="kw">quantile</span>(boot.stat,<span class="kw">c</span>(<span class="fl">0.005</span>,<span class="fl">0.995</span>))</a></code></pre></div>
<pre><code>##      0.5%     99.5% 
## -1.460318 35.861682</code></pre>
</div>
<div id="bootstrapping-for-correlation-interval" class="section level2">
<h2><span class="header-section-number">5.8</span> Bootstrapping for correlation interval</h2>
<p>Some data and code are from: <a href="https://blog.methodsconsultants.com/posts/understanding-bootstrap-confidence-interval-output-from-the-r-boot-package/" class="uri">https://blog.methodsconsultants.com/posts/understanding-bootstrap-confidence-interval-output-from-the-r-boot-package/</a></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1">data_correlation&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;data_correlation.csv&quot;</span>,<span class="dt">fileEncoding=</span><span class="st">&quot;UTF-8-BOM&quot;</span>)</a>
<a class="sourceLine" id="cb54-2" title="2"></a>
<a class="sourceLine" id="cb54-3" title="3">data_correlation</a></code></pre></div>
<pre><code>##    Student LSAT  GPA
## 1        1  576 3.39
## 2        2  635 3.30
## 3        3  558 2.81
## 4        4  578 3.03
## 5        5  666 3.44
## 6        6  580 3.07
## 7        7  555 3.00
## 8        8  661 3.43
## 9        9  651 3.36
## 10      10  605 3.13
## 11      11  653 3.12
## 12      12  575 2.74
## 13      13  545 2.76
## 14      14  572 2.88
## 15      15  594 2.96</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="kw">cor.test</span>(data_correlation<span class="op">$</span>LSAT,data_correlation<span class="op">$</span>GPA)</a></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  data_correlation$LSAT and data_correlation$GPA
## t = 4.4413, df = 13, p-value = 0.0006651
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.4385108 0.9219648
## sample estimates:
##       cor 
## 0.7763745</code></pre>
<p>In the following, I will write my own code to execute the bootstrapping. I set the bootstrapping number only 500, for illustrative purposes. As we can see, the distribution is not symmetrical.</p>
<p>As we can see, the quantile result and c(-1, 1) X 2 are not the same, as the latter assumes symmetrical distribution. However, based on the histogram, we know it is not the case. Thus, quantile would be more appropriate. You can compare the result with that from the boot function.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1">n_row =<span class="st"> </span><span class="kw">nrow</span>(data_correlation)</a>
<a class="sourceLine" id="cb58-2" title="2">n_row</a></code></pre></div>
<pre><code>## [1] 15</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb60-2" title="2"></a>
<a class="sourceLine" id="cb60-3" title="3">B =<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb60-4" title="4">result =<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, B)</a>
<a class="sourceLine" id="cb60-5" title="5"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B)</a>
<a class="sourceLine" id="cb60-6" title="6">{</a>
<a class="sourceLine" id="cb60-7" title="7">boot.sample =<span class="st"> </span><span class="kw">sample</span>(n_row, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb60-8" title="8">result_temp =<span class="st"> </span><span class="kw">cor.test</span>(data_correlation[boot.sample,]<span class="op">$</span>LSAT,data_correlation[boot.sample,]<span class="op">$</span>GPA)</a>
<a class="sourceLine" id="cb60-9" title="9">result[i]=result_temp<span class="op">$</span>estimate</a>
<a class="sourceLine" id="cb60-10" title="10">}</a>
<a class="sourceLine" id="cb60-11" title="11"><span class="kw">hist</span>(result)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="co"># 95%: 2.5% 97.5%</span></a>
<a class="sourceLine" id="cb61-2" title="2"><span class="kw">quantile</span>(result,<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</a></code></pre></div>
<pre><code>##      2.5%     97.5% 
## 0.4369293 0.9556859</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="kw">sd</span>(result)</a></code></pre></div>
<pre><code>## [1] 0.1342631</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="kw">mean</span>(result) <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(result)</a></code></pre></div>
<pre><code>## [1] 0.5107704 1.0370816</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="kw">cor</span>(data_correlation<span class="op">$</span>LSAT,data_correlation<span class="op">$</span>GPA)</a></code></pre></div>
<pre><code>## [1] 0.7763745</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="kw">cor</span>(data_correlation<span class="op">$</span>LSAT,data_correlation<span class="op">$</span>GPA)<span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(result)</a></code></pre></div>
<pre><code>## [1] 0.5132189 1.0395301</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="co"># why add 0.005? Not sure. The following is from the webpage. Later note: please refer to the webpage, as it provides the logic of basic interval.</span></a>
<a class="sourceLine" id="cb71-2" title="2"></a>
<a class="sourceLine" id="cb71-3" title="3"><span class="fl">0.776+0.005</span><span class="op">+</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="fl">0.131</span></a></code></pre></div>
<pre><code>## [1] 0.52424 1.03776</code></pre>
<p>In the blog mentioned above, the author used the boot function in R. For the logic of basic interval, please refer to:
<a href="https://blog.methodsconsultants.com/posts/understanding-bootstrap-confidence-interval-output-from-the-r-boot-package/" class="uri">https://blog.methodsconsultants.com/posts/understanding-bootstrap-confidence-interval-output-from-the-r-boot-package/</a></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb73-2" title="2"></a>
<a class="sourceLine" id="cb73-3" title="3">get_r &lt;-<span class="st"> </span><span class="cf">function</span>(data, indices, x, y) {</a>
<a class="sourceLine" id="cb73-4" title="4">  d &lt;-<span class="st"> </span>data[indices, ]</a>
<a class="sourceLine" id="cb73-5" title="5">  r &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">as.numeric</span>(<span class="kw">cor</span>(d[x], d[y])), <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb73-6" title="6">  r}</a>
<a class="sourceLine" id="cb73-7" title="7"></a>
<a class="sourceLine" id="cb73-8" title="8"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb73-9" title="9"></a>
<a class="sourceLine" id="cb73-10" title="10">boot_out &lt;-<span class="st"> </span><span class="kw">boot</span>(</a>
<a class="sourceLine" id="cb73-11" title="11">  data_correlation,</a>
<a class="sourceLine" id="cb73-12" title="12">  <span class="dt">x =</span> <span class="st">&quot;LSAT&quot;</span>, </a>
<a class="sourceLine" id="cb73-13" title="13">  <span class="dt">y =</span> <span class="st">&quot;GPA&quot;</span>, </a>
<a class="sourceLine" id="cb73-14" title="14">  <span class="dt">R =</span> <span class="dv">500</span>,</a>
<a class="sourceLine" id="cb73-15" title="15">  <span class="dt">statistic =</span> get_r</a>
<a class="sourceLine" id="cb73-16" title="16">)</a>
<a class="sourceLine" id="cb73-17" title="17"></a>
<a class="sourceLine" id="cb73-18" title="18"><span class="kw">boot.ci</span>(boot_out)</a></code></pre></div>
<pre><code>## Warning in boot.ci(boot_out): bootstrap variances needed for studentized
## intervals</code></pre>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 500 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot_out)
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 0.5247,  1.0368 )   ( 0.5900,  1.0911 )  
## 
## Level     Percentile            BCa          
## 95%   ( 0.4609,  0.9620 )   ( 0.3948,  0.9443 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
</div>
<div id="use-r-for-mediation" class="section level2">
<h2><span class="header-section-number">5.9</span> Use R for mediation</h2>
<p><a href="https://advstats.psychstat.org/book/mediation/index.php" class="uri">https://advstats.psychstat.org/book/mediation/index.php</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="real-data-example-multiple-linear-regression.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
