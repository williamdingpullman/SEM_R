<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Bootstrapping | SEM and R</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Bootstrapping | SEM and R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Bootstrapping | SEM and R" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Bill" />


<meta name="date" content="2021-05-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="real-data-example-multiple-linear-regression.html"/>
<link rel="next" href="poisson-regression.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SEM and R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> SEM and R</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#definitions-basic-concepts"><i class="fa fa-check"></i><b>2.1</b> Definitions (Basic Concepts)</a><ul>
<li class="chapter" data-level="2.1.1" data-path="intro.html"><a href="intro.html#observed-variable"><i class="fa fa-check"></i><b>2.1.1</b> Observed variable</a></li>
<li class="chapter" data-level="2.1.2" data-path="intro.html"><a href="intro.html#latent-variable"><i class="fa fa-check"></i><b>2.1.2</b> Latent variable</a></li>
<li class="chapter" data-level="2.1.3" data-path="intro.html"><a href="intro.html#exogenous-variable"><i class="fa fa-check"></i><b>2.1.3</b> Exogenous variable</a></li>
<li class="chapter" data-level="2.1.4" data-path="intro.html"><a href="intro.html#endogenous-variable"><i class="fa fa-check"></i><b>2.1.4</b> Endogenous variable</a></li>
<li class="chapter" data-level="2.1.5" data-path="intro.html"><a href="intro.html#measurement-model"><i class="fa fa-check"></i><b>2.1.5</b> Measurement model</a></li>
<li class="chapter" data-level="2.1.6" data-path="intro.html"><a href="intro.html#indicator-in-a-measurement-model"><i class="fa fa-check"></i><b>2.1.6</b> Indicator (in a measurement model)</a></li>
<li class="chapter" data-level="2.1.7" data-path="intro.html"><a href="intro.html#factor"><i class="fa fa-check"></i><b>2.1.7</b> Factor</a></li>
<li class="chapter" data-level="2.1.8" data-path="intro.html"><a href="intro.html#loading"><i class="fa fa-check"></i><b>2.1.8</b> Loading</a></li>
<li class="chapter" data-level="2.1.9" data-path="intro.html"><a href="intro.html#structural-model"><i class="fa fa-check"></i><b>2.1.9</b> Structural model</a></li>
<li class="chapter" data-level="2.1.10" data-path="intro.html"><a href="intro.html#regerssion-path"><i class="fa fa-check"></i><b>2.1.10</b> Regerssion path</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#the-path-diagram"><i class="fa fa-check"></i><b>2.2</b> The path diagram</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#lavaan-syntax"><i class="fa fa-check"></i><b>2.3</b> Lavaan syntax</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#regression-and-path-analysis"><i class="fa fa-check"></i><b>2.4</b> Regression and path analysis</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="real-data-example-simple-linear-regression.html"><a href="real-data-example-simple-linear-regression.html"><i class="fa fa-check"></i><b>3</b> Real data example (Simple linear regression)</a><ul>
<li class="chapter" data-level="3.1" data-path="real-data-example-simple-linear-regression.html"><a href="real-data-example-simple-linear-regression.html#read-the-data-into-the-r-studio-environment."><i class="fa fa-check"></i><b>3.1</b> Read the data into the R Studio environment.</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="real-data-example-multiple-linear-regression.html"><a href="real-data-example-multiple-linear-regression.html"><i class="fa fa-check"></i><b>4</b> Real data example (Multiple linear regression)</a></li>
<li class="chapter" data-level="5" data-path="bootstrapping.html"><a href="bootstrapping.html"><i class="fa fa-check"></i><b>5</b> Bootstrapping</a><ul>
<li class="chapter" data-level="5.1" data-path="bootstrapping.html"><a href="bootstrapping.html#warning"><i class="fa fa-check"></i><b>5.1</b> Warning</a></li>
<li class="chapter" data-level="5.2" data-path="bootstrapping.html"><a href="bootstrapping.html#introduction"><i class="fa fa-check"></i><b>5.2</b> Introduction</a></li>
<li class="chapter" data-level="5.3" data-path="bootstrapping.html"><a href="bootstrapping.html#normal-distribution-sd-se"><i class="fa fa-check"></i><b>5.3</b> Normal distribution, SD, SE</a></li>
<li class="chapter" data-level="5.4" data-path="bootstrapping.html"><a href="bootstrapping.html#sample-function"><i class="fa fa-check"></i><b>5.4</b> Sample function</a></li>
<li class="chapter" data-level="5.5" data-path="bootstrapping.html"><a href="bootstrapping.html#proportion"><i class="fa fa-check"></i><b>5.5</b> Proportion</a></li>
<li class="chapter" data-level="5.6" data-path="bootstrapping.html"><a href="bootstrapping.html#boot-package"><i class="fa fa-check"></i><b>5.6</b> boot package</a></li>
<li class="chapter" data-level="5.7" data-path="bootstrapping.html"><a href="bootstrapping.html#concept-of-percentile"><i class="fa fa-check"></i><b>5.7</b> Concept of Percentile</a></li>
<li class="chapter" data-level="5.8" data-path="bootstrapping.html"><a href="bootstrapping.html#bootstrapping-for-correlation-interval"><i class="fa fa-check"></i><b>5.8</b> Bootstrapping for correlation interval</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="poisson-regression.html"><a href="poisson-regression.html"><i class="fa fa-check"></i><b>6</b> Poisson Regression</a><ul>
<li class="chapter" data-level="6.1" data-path="poisson-regression.html"><a href="poisson-regression.html#basic-idea"><i class="fa fa-check"></i><b>6.1</b> Basic idea</a></li>
<li class="chapter" data-level="6.2" data-path="poisson-regression.html"><a href="poisson-regression.html#trying-to-understand"><i class="fa fa-check"></i><b>6.2</b> Trying to understand</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="use-r-for-mediation.html"><a href="use-r-for-mediation.html"><i class="fa fa-check"></i><b>7</b> Use R for mediation</a></li>
<li class="divider"></li>
<li><a href="https://williamdingpullman.github.io/" target="blank">Bill's State Notes</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">SEM and R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bootstrapping" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Bootstrapping</h1>
<div id="warning" class="section level2">
<h2><span class="header-section-number">5.1</span> Warning</h2>
<p><strong>Warning:</strong></p>
<p><strong>This page is for my own personal study purpose. Distribution is prohibited.</strong></p>
<hr />
</div>
<div id="introduction" class="section level2">
<h2><span class="header-section-number">5.2</span> Introduction</h2>
<p>The following note is made when I was studying Bret Larget’s note posted online.
<a href="http://pages.stat.wisc.edu/~larget/stat302/chap3.pdf" class="uri">http://pages.stat.wisc.edu/~larget/stat302/chap3.pdf</a></p>
<p>He used the data from LOck5data as an example.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">library</span>(Lock5Data)</a>
<a class="sourceLine" id="cb14-2" title="2"><span class="kw">data</span>(CommuteAtlanta)</a>
<a class="sourceLine" id="cb14-3" title="3"><span class="kw">str</span>(CommuteAtlanta)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    500 obs. of  5 variables:
##  $ City    : Factor w/ 1 level &quot;Atlanta&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Age     : int  19 55 48 45 48 43 48 41 47 39 ...
##  $ Distance: int  10 45 12 4 15 33 15 4 25 1 ...
##  $ Time    : int  15 60 45 10 30 60 45 10 25 15 ...
##  $ Sex     : Factor w/ 2 levels &quot;F&quot;,&quot;M&quot;: 2 2 2 1 1 2 2 1 2 1 ...</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">time.mean =<span class="st"> </span><span class="kw">with</span>(CommuteAtlanta, <span class="kw">mean</span>(Time))</a>
<a class="sourceLine" id="cb16-2" title="2"></a>
<a class="sourceLine" id="cb16-3" title="3">time.mean</a></code></pre></div>
<pre><code>## [1] 29.11</code></pre>
<p>Now, he sampled a (b X n) table. Note that, the Atlanta data has 500 row, as it has 500 observations (or, people). But, in the following new matrix, it is a (1000 times 500) table. Also, it should be noted that the logic of sample function in R. This webpage provides some insight into this function. Basically, the following R code randomly sample a bigger sample of (1000 times 500) from those 500 data points. After that, the matrix function put such (1000 times 500) data points into a matrix of (1000 times 500).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">B =<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb18-2" title="2">n =<span class="st"> </span><span class="kw">nrow</span>(CommuteAtlanta)</a>
<a class="sourceLine" id="cb18-3" title="3">boot.samples =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">sample</span>(CommuteAtlanta<span class="op">$</span>Time, <span class="dt">size =</span> B <span class="op">*</span><span class="st"> </span>n, <span class="dt">replace =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb18-4" title="4">                      B, n)</a></code></pre></div>
<p>Next, we need to calculate the mean for each row. Remember, we have 1000 rows. Note that, 1 in the apply function indicates that we calculate means on each row, whereas 2 indicates to each column.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">boot.statistics =<span class="st"> </span><span class="kw">apply</span>(boot.samples, <span class="dv">1</span>, mean)</a></code></pre></div>
<p>We can then plot all the means.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">require</span>(ggplot2)</a></code></pre></div>
<pre><code>## Loading required package: ggplot2</code></pre>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 3.6.3</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">ggplot</span>(<span class="kw">data.frame</span>(<span class="dt">meanTime =</span> boot.statistics),<span class="kw">aes</span>(<span class="dt">x=</span>meanTime)) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="kw">geom_histogram</span>(<span class="dt">binwidth=</span><span class="fl">0.25</span>,<span class="kw">aes</span>(<span class="dt">y=</span>..density..)) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-3" title="3"><span class="kw">geom_density</span>(<span class="dt">color=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">time.se =<span class="st"> </span><span class="kw">sd</span>(boot.statistics)</a>
<a class="sourceLine" id="cb24-2" title="2">time.se</a></code></pre></div>
<pre><code>## [1] 0.897676</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">me =<span class="st"> </span><span class="kw">ceiling</span>(<span class="dv">10</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>time.se)<span class="op">/</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb26-2" title="2">me</a></code></pre></div>
<pre><code>## [1] 1.8</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw">round</span>(time.mean, <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>me</a></code></pre></div>
<pre><code>## [1] 27.3 30.9</code></pre>
</div>
<div id="normal-distribution-sd-se" class="section level2">
<h2><span class="header-section-number">5.3</span> Normal distribution, SD, SE</h2>
<p>Note, if we do not use bootstraping, we can use the standard CI formula (<a href="https://www.mathsisfun.com/data/confidence-interval.html" class="uri">https://www.mathsisfun.com/data/confidence-interval.html</a>). This formula assumes normal distribution. As we can see, this is close to the result based on the bootstrapping method.</p>
<p><span class="math display">\[\overline{X} \pm Z \frac{S}{\sqrt{n}}=29.11 \pm 1.96 \frac{20.72}{\sqrt{500}}=27.29, 30.93\]</span></p>
<p>Note that, in the following, the author used 2 times SE to calculate the CI. The relationship between SD and SE:</p>
<p>“Now the sample mean will vary from sample to sample; the way this variation occurs is described by the “sampling distribution” of the mean. We can estimate how much sample means will vary from the standard deviation of this sampling distribution, which we call the standard error (SE) of the estimate of the mean. As the standard error is a type of standard deviation, confusion is understandable. Another way of considering the standard error is as a measure of the precision of the sample mean." (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1255808/" class="uri">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1255808/</a>)</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">boot.mean =<span class="st"> </span><span class="cf">function</span>(x,B,<span class="dt">binwidth=</span><span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb30-2" title="2">{</a>
<a class="sourceLine" id="cb30-3" title="3">n =<span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb30-4" title="4">boot.samples =<span class="st"> </span><span class="kw">matrix</span>( <span class="kw">sample</span>(x,<span class="dt">size=</span>n<span class="op">*</span>B,<span class="dt">replace=</span><span class="ot">TRUE</span>), B, n)</a>
<a class="sourceLine" id="cb30-5" title="5">boot.statistics =<span class="st"> </span><span class="kw">apply</span>(boot.samples,<span class="dv">1</span>,mean)</a>
<a class="sourceLine" id="cb30-6" title="6">se =<span class="st"> </span><span class="kw">sd</span>(boot.statistics)</a>
<a class="sourceLine" id="cb30-7" title="7"><span class="kw">require</span>(ggplot2)</a>
<a class="sourceLine" id="cb30-8" title="8"><span class="cf">if</span> ( <span class="kw">is.null</span>(binwidth) )</a>
<a class="sourceLine" id="cb30-9" title="9">binwidth =<span class="st"> </span><span class="kw">diff</span>(<span class="kw">range</span>(boot.statistics))<span class="op">/</span><span class="dv">30</span></a>
<a class="sourceLine" id="cb30-10" title="10">p =<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">data.frame</span>(<span class="dt">x=</span>boot.statistics),<span class="kw">aes</span>(<span class="dt">x=</span>x)) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-11" title="11"><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y=</span>..density..),<span class="dt">binwidth=</span>binwidth) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">color=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb30-12" title="12"><span class="kw">plot</span>(p)</a>
<a class="sourceLine" id="cb30-13" title="13">interval =<span class="st"> </span><span class="kw">mean</span>(x) <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span><span class="op">*</span>se</a>
<a class="sourceLine" id="cb30-14" title="14"><span class="kw">print</span>( interval )</a>
<a class="sourceLine" id="cb30-15" title="15"><span class="kw">return</span>( <span class="kw">list</span>(<span class="dt">boot.statistics =</span> boot.statistics, <span class="dt">interval=</span>interval, <span class="dt">se=</span>se, <span class="dt">plot=</span>p) )</a>
<a class="sourceLine" id="cb30-16" title="16">}</a></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">out =<span class="st"> </span><span class="kw">with</span>(CommuteAtlanta, <span class="kw">boot.mean</span>(Distance, <span class="dt">B =</span> <span class="dv">1000</span>))</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre><code>## [1] 16.95696 19.35504</code></pre>
</div>
<div id="sample-function" class="section level2">
<h2><span class="header-section-number">5.4</span> Sample function</h2>
<p>To understand the function of sample in R.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">sample</span>(<span class="dv">20</span>,<span class="dt">replace =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>##  [1] 13 20 15 17 15 15 10 20 11  6  7  4 13  9  2 15  6 19  1 17</code></pre>
<p>The following uses loop to do the resampling. It uses sample function to index the numbers that they want to sample from the original sample. That is, [] suggests the indexing.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1">n =<span class="st"> </span><span class="kw">length</span>(CommuteAtlanta<span class="op">$</span>Distance)</a>
<a class="sourceLine" id="cb35-2" title="2">B =<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb35-3" title="3">result =<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, B)</a>
<a class="sourceLine" id="cb35-4" title="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B)</a>
<a class="sourceLine" id="cb35-5" title="5">{</a>
<a class="sourceLine" id="cb35-6" title="6">boot.sample =<span class="st"> </span><span class="kw">sample</span>(n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb35-7" title="7">result[i] =<span class="st"> </span><span class="kw">mean</span>(CommuteAtlanta<span class="op">$</span>Distance[boot.sample])</a>
<a class="sourceLine" id="cb35-8" title="8">}</a>
<a class="sourceLine" id="cb35-9" title="9"></a>
<a class="sourceLine" id="cb35-10" title="10"><span class="kw">with</span>(CommuteAtlanta, <span class="kw">mean</span>(Distance) <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(result))</a></code></pre></div>
<pre><code>## [1] 16.89079 19.42121</code></pre>
</div>
<div id="proportion" class="section level2">
<h2><span class="header-section-number">5.5</span> Proportion</h2>
<p>So far, we have dealed with means. How about porpotions?Remember that, when calculating means, it starts with a single column of data to calculate the mean. Similarly, when calculating porpotions, you can just use a single column of data.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1">reeses =<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">11</span>), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">19</span>))</a>
<a class="sourceLine" id="cb37-2" title="2">reeses.boot =<span class="st"> </span><span class="kw">boot.mean</span>(reeses, <span class="dv">1000</span>, <span class="dt">binwidth =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">30</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<pre><code>## [1] 0.1847932 0.5485402</code></pre>
<p>However, if we have 48 students (i.e., 48 observations) and thus we have a bigger sample. However, how can we do re-sampling? Based on the note, it is kind of simple. They group them together and then resample from it. Note that, when they re-sampling, the programming do not distinguish the difference between 48 observations. But just combined them as a single column (741+699=1440), and then generate a very long column (1440 times 1000) and then reshape it into a matrix (1440 time 1000). This is the basic logic of the boot.mean function.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">reeses =<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">741</span>), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">699</span>))</a>
<a class="sourceLine" id="cb39-2" title="2">reeses.boot =<span class="st"> </span><span class="kw">boot.mean</span>(reeses, <span class="dv">1000</span>, <span class="dt">binwidth =</span> <span class="fl">0.005</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre><code>## [1] 0.4877194 0.5414472</code></pre>
</div>
<div id="boot-package" class="section level2">
<h2><span class="header-section-number">5.6</span> boot package</h2>
<p>After having a basic idea of boostrapping, we can then use the package of boot.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="kw">library</span>(boot)</a></code></pre></div>
<pre><code>## Warning: package &#39;boot&#39; was built under R version 3.6.3</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="kw">data</span>(CommuteAtlanta)</a>
<a class="sourceLine" id="cb43-2" title="2"></a>
<a class="sourceLine" id="cb43-3" title="3">my.mean =<span class="st"> </span><span class="cf">function</span>(x, indices)</a>
<a class="sourceLine" id="cb43-4" title="4">{</a>
<a class="sourceLine" id="cb43-5" title="5"><span class="kw">return</span>( <span class="kw">mean</span>( x[indices] ) )</a>
<a class="sourceLine" id="cb43-6" title="6">}</a>
<a class="sourceLine" id="cb43-7" title="7"></a>
<a class="sourceLine" id="cb43-8" title="8">time.boot =<span class="st"> </span><span class="kw">boot</span>(CommuteAtlanta<span class="op">$</span>Time, my.mean, <span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb43-9" title="9"></a>
<a class="sourceLine" id="cb43-10" title="10"><span class="kw">boot.ci</span>(time.boot)</a></code></pre></div>
<pre><code>## Warning in boot.ci(time.boot): bootstrap variances needed for studentized
## intervals</code></pre>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 10000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = time.boot)
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   (27.29, 30.95 )   (27.23, 30.89 )  
## 
## Level     Percentile            BCa          
## 95%   (27.33, 30.99 )   (27.43, 31.14 )  
## Calculations and Intervals on Original Scale</code></pre>
</div>
<div id="concept-of-percentile" class="section level2">
<h2><span class="header-section-number">5.7</span> Concept of Percentile</h2>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="kw">require</span>(Lock5Data)</a>
<a class="sourceLine" id="cb46-2" title="2"><span class="kw">data</span>(ImmuneTea)</a>
<a class="sourceLine" id="cb46-3" title="3">tea =<span class="st"> </span><span class="kw">with</span>(ImmuneTea, InterferonGamma[Drink<span class="op">==</span><span class="st">&quot;Tea&quot;</span>])</a>
<a class="sourceLine" id="cb46-4" title="4">coffee =<span class="st"> </span><span class="kw">with</span>(ImmuneTea, InterferonGamma[Drink<span class="op">==</span><span class="st">&quot;Coffee&quot;</span>])</a>
<a class="sourceLine" id="cb46-5" title="5">tea.mean =<span class="st"> </span><span class="kw">mean</span>(tea)</a>
<a class="sourceLine" id="cb46-6" title="6">coffee.mean =<span class="st"> </span><span class="kw">mean</span>(coffee)</a>
<a class="sourceLine" id="cb46-7" title="7">tea.n =<span class="st"> </span><span class="kw">length</span>(tea)</a>
<a class="sourceLine" id="cb46-8" title="8">coffee.n =<span class="st"> </span><span class="kw">length</span>(coffee)</a>
<a class="sourceLine" id="cb46-9" title="9"></a>
<a class="sourceLine" id="cb46-10" title="10"></a>
<a class="sourceLine" id="cb46-11" title="11"></a>
<a class="sourceLine" id="cb46-12" title="12">B =<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb46-13" title="13"><span class="co"># create empty arrays for the means of each sample</span></a>
<a class="sourceLine" id="cb46-14" title="14">tea.boot =<span class="st"> </span><span class="kw">numeric</span>(B)</a>
<a class="sourceLine" id="cb46-15" title="15">coffee.boot =<span class="st"> </span><span class="kw">numeric</span>(B)</a>
<a class="sourceLine" id="cb46-16" title="16"><span class="co"># Use a for loop to take the samples</span></a>
<a class="sourceLine" id="cb46-17" title="17"><span class="cf">for</span> ( i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B )</a>
<a class="sourceLine" id="cb46-18" title="18">  {</a>
<a class="sourceLine" id="cb46-19" title="19">tea.boot[i] =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sample</span>(tea,<span class="dt">size=</span>tea.n,<span class="dt">replace=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb46-20" title="20">coffee.boot[i] =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sample</span>(coffee,<span class="dt">size=</span>coffee.n,<span class="dt">replace=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb46-21" title="21">}</a>
<a class="sourceLine" id="cb46-22" title="22"></a>
<a class="sourceLine" id="cb46-23" title="23">boot.stat =<span class="st"> </span>tea.boot <span class="op">-</span><span class="st"> </span>coffee.boot</a>
<a class="sourceLine" id="cb46-24" title="24">boot.stat</a></code></pre></div>
<pre><code>##   [1]  12.2000000  12.3090909  22.0727273   7.7545455  12.3636364
##   [6]  20.8000000   6.8454545   4.3181818  33.1818182  21.5545455
##  [11]  12.4909091  15.4909091 -10.4272727  18.2909091  13.6454545
##  [16]  14.5181818  22.4090909   5.0272727  13.3363636  12.7454545
##  [21]  20.2818182   1.9090909  21.3272727  18.2636364  11.4363636
##  [26]  15.7727273   1.2818182  23.7454545   6.1272727  18.4090909
##  [31]  18.9727273  18.9090909  23.8909091   2.5363636  17.2454545
##  [36]  20.2454545  15.2090909  25.4545455  20.4272727  17.8909091
##  [41]  25.1454545   2.4909091  21.0000000  14.3363636  11.5909091
##  [46]  13.3909091  23.2636364  24.8363636   5.9454545  23.9818182
##  [51]  12.4181818  14.4272727  23.0545455  30.8727273   8.0636364
##  [56]  10.2000000  14.9727273   3.2000000  12.0909091  32.6000000
##  [61]  17.2727273  26.9727273   5.1000000  13.0909091  29.4727273
##  [66]  10.9636364  26.3272727  18.4727273  13.8545455  18.8545455
##  [71]  20.9000000  32.7090909  26.6181818  31.9181818  18.0727273
##  [76]  13.8181818  33.1272727  20.5272727  19.0454545  11.3272727
##  [81]  15.6818182  15.8363636  12.7454545   7.7454545   9.7909091
##  [86]   4.3454545  17.1545455  16.7727273  -2.9181818  20.7545455
##  [91]  13.0363636  21.4545455  16.5090909  16.1909091  15.6000000
##  [96]   9.9818182  25.2000000   5.7090909  23.8000000  34.3272727
## [101]  12.9363636  15.2181818  10.5272727   9.7909091  26.5545455
## [106]  17.0363636  11.2636364  36.3090909  15.3545455  11.4000000
## [111]   9.8727273  14.5727273   9.2727273  17.8818182  34.2818182
## [116]  23.3090909  25.5909091  14.2818182  19.6090909  22.2454545
## [121]  15.6727273  33.5545455  15.8636364  32.6636364  15.9272727
## [126]  10.1090909  23.3818182  16.1727273  25.1363636   5.5000000
## [131]  11.8545455  14.9000000  21.5454545  14.8454545  12.0090909
## [136]  20.1090909  20.1090909  19.0727273  21.9818182  12.9090909
## [141]  18.8000000  20.1363636  10.6090909  23.4000000  11.4272727
## [146]  22.4454545  11.2727273  26.4363636  15.2727273  27.9818182
## [151]  12.6454545  22.8545455  26.5545455   9.7181818  15.2181818
## [156]  10.4818182  16.6181818   4.8090909  25.5909091  11.8636364
## [161]   8.2636364   7.9090909   3.6272727  24.7727273  30.8000000
## [166]  17.4000000  17.8818182  20.0636364  14.2363636  24.3090909
## [171]   2.1454545  14.0545455  11.5909091  16.1727273  25.9181818
## [176]  30.2818182  26.9454545  26.6181818  16.2909091  15.9727273
## [181]  20.8090909   6.7818182  30.7454545  16.4818182  13.2000000
## [186]  21.8454545   4.4000000  13.5636364  25.3909091  21.1363636
## [191]  22.4181818  20.2181818  14.4727273  25.8909091  16.2727273
## [196]  19.0000000  17.3545455  20.7818182   6.8000000  15.7545455
## [201]  18.1000000  20.5272727  12.8181818  16.6454545  15.8818182
## [206]  26.4363636  13.3000000  39.6363636  20.1181818  14.4363636
## [211]  14.8363636  23.1363636   6.5636364   4.1818182  12.8727273
## [216]  24.8363636  14.7545455  15.6727273  16.7090909  20.9636364
## [221]  12.0636364  18.3000000  19.1727273  16.6272727  23.3636364
## [226]   4.1909091  22.7000000   9.2090909  10.9454545  16.4727273
## [231]  14.3000000  28.3909091  14.4272727  21.9272727   5.8636364
## [236]  20.6272727  18.2181818  14.3181818  11.1272727  29.3818182
## [241]  18.4909091  16.6818182  25.6090909  25.7636364   6.9000000
## [246]  31.3181818  20.3181818  14.8636364  18.1090909  22.2909091
## [251]  20.3000000   8.1000000   8.6545455  22.1636364  10.8909091
## [256]  19.4090909  17.7000000   8.6909091  10.0000000  17.2000000
## [261]   9.5727273  34.0181818  14.5545455  23.6727273   3.8909091
## [266]  27.0363636  21.2909091  17.1000000  19.9545455  18.6181818
## [271]  14.9181818  18.2363636  -1.8818182  21.5181818  18.0909091
## [276]  10.2272727  14.7363636  16.0272727   3.7727273  12.2454545
## [281]   5.7090909   3.3636364  13.1727273  35.9363636  21.5545455
## [286]  16.1090909   9.8818182  17.0272727  20.8818182  21.1545455
## [291]  13.8000000  12.3454545  25.4818182  10.8363636  21.0818182
## [296]  22.8727273  14.2090909   8.0909091  20.3636364   3.6090909
## [301]  14.6818182  19.0181818  30.0363636  11.1727273   6.4181818
## [306]  14.2000000   7.6000000  21.5818182  16.9181818  10.9181818
## [311]  16.7363636  15.7090909  13.3727273  23.6818182  17.4272727
## [316]  11.7545455   9.9727273  33.0909091  29.7909091  28.8545455
## [321]  23.8636364  21.0545455  23.6454545  22.8545455  17.8909091
## [326]  27.2636364   7.1545455  15.6727273  20.0454545  20.7090909
## [331]  12.8454545  15.0000000  16.5636364  16.9454545  12.2181818
## [336]   8.3090909  30.4727273  23.4272727  16.8272727  18.6727273
## [341]  22.6545455   5.1818182   4.1454545  25.3090909  16.4909091
## [346]  10.4818182  18.9272727  19.6454545  18.3454545  29.3818182
## [351]  24.1909091  18.1909091   1.7454545  16.5454545  17.1545455
## [356]  16.3181818   9.9909091  15.5818182   7.3000000  16.2818182
## [361]   7.6000000   6.9454545  14.1818182  26.9727273  25.1727273
## [366]   9.5727273  20.1545455  31.6272727  29.7545455  25.9363636
## [371]  16.9181818  11.6818182  22.9181818  29.9454545  15.0636364
## [376]  25.2090909  11.3363636  21.3272727   8.1636364  19.9090909
## [381]   2.5363636  26.5545455   7.7727273  24.0181818   0.7272727
## [386]  13.2909091  16.0363636  15.3727273  17.8818182  23.7909091
## [391]  24.5454545  15.8181818  10.9363636  27.8454545  11.7636364
## [396]  11.2090909  22.9000000  31.2636364  22.4272727  25.3727273
## [401]  22.1545455  22.0000000  25.6727273  19.1636364   9.9727273
## [406]  20.8181818  25.1545455  28.8090909   9.3090909  21.5000000
## [411]  30.6636364  36.9272727  10.2454545  15.1909091  23.4181818
## [416]  18.6454545  15.7909091  22.6545455   8.8636364  18.0363636
## [421]   7.8363636   6.1000000  10.0727273  14.0272727   9.4727273
## [426]  18.9818182   1.6636364  22.7818182  16.4909091  16.7181818
## [431]  10.8000000  15.6545455  13.8545455  16.8272727  12.5818182
## [436]  26.6181818  10.6181818  13.1545455  14.4272727  23.3181818
## [441]  25.2363636  13.2000000  24.7181818   2.2727273   6.6090909
## [446]  21.3363636  14.7363636  11.2181818  31.2272727  32.1545455
## [451]  14.5000000  24.5000000  18.8727273  20.4545455  21.4909091
## [456]  14.7545455  30.2818182  23.3090909  20.7000000  20.0636364
## [461]  19.4454545  30.9727273  11.0727273  17.6363636  17.9636364
## [466]   8.6181818  23.9636364  19.8000000  20.7545455  11.7818182
## [471]  21.3727273  14.2818182  17.1818182  26.4181818   1.2818182
## [476]  14.3000000  16.6818182  21.4090909  10.6272727  14.9727273
## [481]  17.7727273  20.4000000  21.4181818   9.4000000  21.3272727
## [486]  18.0363636  18.0636364  10.7727273  19.9363636  20.4818182
## [491]  21.0636364   6.0454545   3.0181818  18.4090909  20.6000000
## [496]   6.1454545  26.3636364  -2.0818182   4.8545455   5.4181818</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="co"># Find endpoints for 90%, 95%, and 99% bootstrap confidence intervals using percentiles.</span></a>
<a class="sourceLine" id="cb48-2" title="2"></a>
<a class="sourceLine" id="cb48-3" title="3"><span class="co"># 90%:  5% 95%</span></a>
<a class="sourceLine" id="cb48-4" title="4"><span class="kw">quantile</span>(boot.stat,<span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.95</span>))</a></code></pre></div>
<pre><code>##        5%       95% 
##  4.311818 30.482273</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="co"># 95%: 2.5% 97.5%</span></a>
<a class="sourceLine" id="cb50-2" title="2"><span class="kw">quantile</span>(boot.stat,<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</a></code></pre></div>
<pre><code>##     2.5%    97.5% 
##  2.51250 32.63341</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="co"># 99%:  0.5% 99.5%</span></a>
<a class="sourceLine" id="cb52-2" title="2"><span class="kw">quantile</span>(boot.stat,<span class="kw">c</span>(<span class="fl">0.005</span>,<span class="fl">0.995</span>))</a></code></pre></div>
<pre><code>##      0.5%     99.5% 
## -1.982818 36.124591</code></pre>
</div>
<div id="bootstrapping-for-correlation-interval" class="section level2">
<h2><span class="header-section-number">5.8</span> Bootstrapping for correlation interval</h2>
<p>Some data and code are from: <a href="https://blog.methodsconsultants.com/posts/understanding-bootstrap-confidence-interval-output-from-the-r-boot-package/" class="uri">https://blog.methodsconsultants.com/posts/understanding-bootstrap-confidence-interval-output-from-the-r-boot-package/</a></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1">data_correlation&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;data_correlation.csv&quot;</span>,<span class="dt">fileEncoding=</span><span class="st">&quot;UTF-8-BOM&quot;</span>)</a>
<a class="sourceLine" id="cb54-2" title="2"></a>
<a class="sourceLine" id="cb54-3" title="3">data_correlation</a></code></pre></div>
<pre><code>##    Student LSAT  GPA
## 1        1  576 3.39
## 2        2  635 3.30
## 3        3  558 2.81
## 4        4  578 3.03
## 5        5  666 3.44
## 6        6  580 3.07
## 7        7  555 3.00
## 8        8  661 3.43
## 9        9  651 3.36
## 10      10  605 3.13
## 11      11  653 3.12
## 12      12  575 2.74
## 13      13  545 2.76
## 14      14  572 2.88
## 15      15  594 2.96</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="kw">cor.test</span>(data_correlation<span class="op">$</span>LSAT,data_correlation<span class="op">$</span>GPA)</a></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  data_correlation$LSAT and data_correlation$GPA
## t = 4.4413, df = 13, p-value = 0.0006651
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.4385108 0.9219648
## sample estimates:
##       cor 
## 0.7763745</code></pre>
<p>In the following, I will write my own code to execute the bootstrapping. I set the bootstrapping number only 500, for illustrative purposes. As we can see, the distribution is not symmetrical.</p>
<p>As we can see, the quantile result and c(-1, 1) X 2 are not the same, as the latter assumes symmetrical distribution. However, based on the histogram, we know it is not the case. Thus, quantile would be more appropriate. You can compare the result with that from the boot function.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1">n_row =<span class="st"> </span><span class="kw">nrow</span>(data_correlation)</a>
<a class="sourceLine" id="cb58-2" title="2">n_row</a></code></pre></div>
<pre><code>## [1] 15</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb60-2" title="2"></a>
<a class="sourceLine" id="cb60-3" title="3">B =<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb60-4" title="4">result =<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, B)</a>
<a class="sourceLine" id="cb60-5" title="5"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B)</a>
<a class="sourceLine" id="cb60-6" title="6">{</a>
<a class="sourceLine" id="cb60-7" title="7">boot.sample =<span class="st"> </span><span class="kw">sample</span>(n_row, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb60-8" title="8">result_temp =<span class="st"> </span><span class="kw">cor.test</span>(data_correlation[boot.sample,]<span class="op">$</span>LSAT,data_correlation[boot.sample,]<span class="op">$</span>GPA)</a>
<a class="sourceLine" id="cb60-9" title="9">result[i]=result_temp<span class="op">$</span>estimate</a>
<a class="sourceLine" id="cb60-10" title="10">}</a>
<a class="sourceLine" id="cb60-11" title="11"><span class="kw">hist</span>(result)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="co"># 95%: 2.5% 97.5%</span></a>
<a class="sourceLine" id="cb61-2" title="2"><span class="kw">quantile</span>(result,<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</a></code></pre></div>
<pre><code>##      2.5%     97.5% 
## 0.4369293 0.9556859</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="kw">sd</span>(result)</a></code></pre></div>
<pre><code>## [1] 0.1342631</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="kw">mean</span>(result) <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(result)</a></code></pre></div>
<pre><code>## [1] 0.5107704 1.0370816</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="kw">cor</span>(data_correlation<span class="op">$</span>LSAT,data_correlation<span class="op">$</span>GPA)</a></code></pre></div>
<pre><code>## [1] 0.7763745</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="kw">cor</span>(data_correlation<span class="op">$</span>LSAT,data_correlation<span class="op">$</span>GPA)<span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(result)</a></code></pre></div>
<pre><code>## [1] 0.5132189 1.0395301</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="co"># why add 0.005? Not sure. The following is from the webpage. Later note: please refer to the webpage, as it provides the logic of basic interval.</span></a>
<a class="sourceLine" id="cb71-2" title="2"></a>
<a class="sourceLine" id="cb71-3" title="3"><span class="fl">0.776+0.005</span><span class="op">+</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="fl">0.131</span></a></code></pre></div>
<pre><code>## [1] 0.52424 1.03776</code></pre>
<p>In the blog mentioned above, the author used the boot function in R. For the logic of basic interval, please refer to:
<a href="https://blog.methodsconsultants.com/posts/understanding-bootstrap-confidence-interval-output-from-the-r-boot-package/" class="uri">https://blog.methodsconsultants.com/posts/understanding-bootstrap-confidence-interval-output-from-the-r-boot-package/</a></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb73-2" title="2"></a>
<a class="sourceLine" id="cb73-3" title="3">get_r &lt;-<span class="st"> </span><span class="cf">function</span>(data, indices, x, y) {</a>
<a class="sourceLine" id="cb73-4" title="4">  d &lt;-<span class="st"> </span>data[indices, ]</a>
<a class="sourceLine" id="cb73-5" title="5">  r &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">as.numeric</span>(<span class="kw">cor</span>(d[x], d[y])), <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb73-6" title="6">  r}</a>
<a class="sourceLine" id="cb73-7" title="7"></a>
<a class="sourceLine" id="cb73-8" title="8"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb73-9" title="9"></a>
<a class="sourceLine" id="cb73-10" title="10">boot_out &lt;-<span class="st"> </span><span class="kw">boot</span>(</a>
<a class="sourceLine" id="cb73-11" title="11">  data_correlation,</a>
<a class="sourceLine" id="cb73-12" title="12">  <span class="dt">x =</span> <span class="st">&quot;LSAT&quot;</span>, </a>
<a class="sourceLine" id="cb73-13" title="13">  <span class="dt">y =</span> <span class="st">&quot;GPA&quot;</span>, </a>
<a class="sourceLine" id="cb73-14" title="14">  <span class="dt">R =</span> <span class="dv">500</span>,</a>
<a class="sourceLine" id="cb73-15" title="15">  <span class="dt">statistic =</span> get_r</a>
<a class="sourceLine" id="cb73-16" title="16">)</a>
<a class="sourceLine" id="cb73-17" title="17"></a>
<a class="sourceLine" id="cb73-18" title="18"><span class="kw">boot.ci</span>(boot_out)</a></code></pre></div>
<pre><code>## Warning in boot.ci(boot_out): bootstrap variances needed for studentized
## intervals</code></pre>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 500 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot_out)
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 0.5247,  1.0368 )   ( 0.5900,  1.0911 )  
## 
## Level     Percentile            BCa          
## 95%   ( 0.4609,  0.9620 )   ( 0.3948,  0.9443 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="real-data-example-multiple-linear-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="poisson-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
