<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Bootstrapping | SEM and R</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Bootstrapping | SEM and R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Bootstrapping | SEM and R" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Bill" />


<meta name="date" content="2021-04-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="real-data-example-multiple-linear-regression.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SEM and R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> SEM and R</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#definitions-basic-concepts"><i class="fa fa-check"></i><b>2.1</b> Definitions (Basic Concepts)</a><ul>
<li class="chapter" data-level="2.1.1" data-path="intro.html"><a href="intro.html#observed-variable"><i class="fa fa-check"></i><b>2.1.1</b> Observed variable</a></li>
<li class="chapter" data-level="2.1.2" data-path="intro.html"><a href="intro.html#latent-variable"><i class="fa fa-check"></i><b>2.1.2</b> Latent variable</a></li>
<li class="chapter" data-level="2.1.3" data-path="intro.html"><a href="intro.html#exogenous-variable"><i class="fa fa-check"></i><b>2.1.3</b> Exogenous variable</a></li>
<li class="chapter" data-level="2.1.4" data-path="intro.html"><a href="intro.html#endogenous-variable"><i class="fa fa-check"></i><b>2.1.4</b> Endogenous variable</a></li>
<li class="chapter" data-level="2.1.5" data-path="intro.html"><a href="intro.html#measurement-model"><i class="fa fa-check"></i><b>2.1.5</b> Measurement model</a></li>
<li class="chapter" data-level="2.1.6" data-path="intro.html"><a href="intro.html#indicator-in-a-measurement-model"><i class="fa fa-check"></i><b>2.1.6</b> Indicator (in a measurement model)</a></li>
<li class="chapter" data-level="2.1.7" data-path="intro.html"><a href="intro.html#factor"><i class="fa fa-check"></i><b>2.1.7</b> Factor</a></li>
<li class="chapter" data-level="2.1.8" data-path="intro.html"><a href="intro.html#loading"><i class="fa fa-check"></i><b>2.1.8</b> Loading</a></li>
<li class="chapter" data-level="2.1.9" data-path="intro.html"><a href="intro.html#structural-model"><i class="fa fa-check"></i><b>2.1.9</b> Structural model</a></li>
<li class="chapter" data-level="2.1.10" data-path="intro.html"><a href="intro.html#regerssion-path"><i class="fa fa-check"></i><b>2.1.10</b> Regerssion path</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#the-path-diagram"><i class="fa fa-check"></i><b>2.2</b> The path diagram</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#lavaan-syntax"><i class="fa fa-check"></i><b>2.3</b> Lavaan syntax</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#regression-and-path-analysis"><i class="fa fa-check"></i><b>2.4</b> Regression and path analysis</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="real-data-example-simple-linear-regression.html"><a href="real-data-example-simple-linear-regression.html"><i class="fa fa-check"></i><b>3</b> Real data example (Simple linear regression)</a><ul>
<li class="chapter" data-level="3.1" data-path="real-data-example-simple-linear-regression.html"><a href="real-data-example-simple-linear-regression.html#read-the-data-into-the-r-studio-environment."><i class="fa fa-check"></i><b>3.1</b> Read the data into the R Studio environment.</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="real-data-example-multiple-linear-regression.html"><a href="real-data-example-multiple-linear-regression.html"><i class="fa fa-check"></i><b>4</b> Real data example (Multiple linear regression)</a></li>
<li class="chapter" data-level="5" data-path="bootstrapping.html"><a href="bootstrapping.html"><i class="fa fa-check"></i><b>5</b> Bootstrapping</a><ul>
<li class="chapter" data-level="5.1" data-path="bootstrapping.html"><a href="bootstrapping.html#introduction"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="bootstrapping.html"><a href="bootstrapping.html#normal-distribution-sd-se"><i class="fa fa-check"></i><b>5.2</b> Normal distribution, SD, SE</a></li>
<li class="chapter" data-level="5.3" data-path="bootstrapping.html"><a href="bootstrapping.html#sample-function"><i class="fa fa-check"></i><b>5.3</b> Sample function</a></li>
<li class="chapter" data-level="5.4" data-path="bootstrapping.html"><a href="bootstrapping.html#proportion"><i class="fa fa-check"></i><b>5.4</b> Proportion</a></li>
<li class="chapter" data-level="5.5" data-path="bootstrapping.html"><a href="bootstrapping.html#boot-package"><i class="fa fa-check"></i><b>5.5</b> boot package</a></li>
<li class="chapter" data-level="5.6" data-path="bootstrapping.html"><a href="bootstrapping.html#concept-of-percentile"><i class="fa fa-check"></i><b>5.6</b> Concept of Percentile</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://williamdingpullman.github.io/" target="blank">Bill's State Notes</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">SEM and R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bootstrapping" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Bootstrapping</h1>
<div id="introduction" class="section level2">
<h2><span class="header-section-number">5.1</span> Introduction</h2>
<p>The following note is made when I was studying Bret Larget’s note posted online.
<a href="http://pages.stat.wisc.edu/~larget/stat302/chap3.pdf" class="uri">http://pages.stat.wisc.edu/~larget/stat302/chap3.pdf</a></p>
<p>He used the data from LOck5data as an example.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">library</span>(Lock5Data)</a>
<a class="sourceLine" id="cb14-2" title="2"><span class="kw">data</span>(CommuteAtlanta)</a>
<a class="sourceLine" id="cb14-3" title="3"><span class="kw">str</span>(CommuteAtlanta)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    500 obs. of  5 variables:
##  $ City    : Factor w/ 1 level &quot;Atlanta&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Age     : int  19 55 48 45 48 43 48 41 47 39 ...
##  $ Distance: int  10 45 12 4 15 33 15 4 25 1 ...
##  $ Time    : int  15 60 45 10 30 60 45 10 25 15 ...
##  $ Sex     : Factor w/ 2 levels &quot;F&quot;,&quot;M&quot;: 2 2 2 1 1 2 2 1 2 1 ...</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">time.mean =<span class="st"> </span><span class="kw">with</span>(CommuteAtlanta, <span class="kw">mean</span>(Time))</a>
<a class="sourceLine" id="cb16-2" title="2"></a>
<a class="sourceLine" id="cb16-3" title="3">time.mean</a></code></pre></div>
<pre><code>## [1] 29.11</code></pre>
<p>Now, he sampled a (b X n) table. Note that, the Atlanta data has 500 row, as it has 500 observations (or, people). But, in the following new matrix, it is a (1000 times 500) table. Also, it should be noted that the logic of sample function in R. This webpage provides some insight into this function. Basically, the following R code randomly sample a bigger sample of (1000 times 500) from those 500 data points. After that, the matrix function put such (1000 times 500) data points into a matrix of (1000 times 500).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">B =<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb18-2" title="2">n =<span class="st"> </span><span class="kw">nrow</span>(CommuteAtlanta)</a>
<a class="sourceLine" id="cb18-3" title="3">boot.samples =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">sample</span>(CommuteAtlanta<span class="op">$</span>Time, <span class="dt">size =</span> B <span class="op">*</span><span class="st"> </span>n, <span class="dt">replace =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb18-4" title="4">                      B, n)</a></code></pre></div>
<p>Next, we need to calculate the mean for each row. Remember, we have 1000 rows. Note that, 1 in the apply function indicates that we calculate means on each row, whereas 2 indicates to each column.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">boot.statistics =<span class="st"> </span><span class="kw">apply</span>(boot.samples, <span class="dv">1</span>, mean)</a></code></pre></div>
<p>We can then plot all the means.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">require</span>(ggplot2)</a></code></pre></div>
<pre><code>## Loading required package: ggplot2</code></pre>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 3.6.3</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">ggplot</span>(<span class="kw">data.frame</span>(<span class="dt">meanTime =</span> boot.statistics),<span class="kw">aes</span>(<span class="dt">x=</span>meanTime)) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="kw">geom_histogram</span>(<span class="dt">binwidth=</span><span class="fl">0.25</span>,<span class="kw">aes</span>(<span class="dt">y=</span>..density..)) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-3" title="3"><span class="kw">geom_density</span>(<span class="dt">color=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">time.se =<span class="st"> </span><span class="kw">sd</span>(boot.statistics)</a>
<a class="sourceLine" id="cb24-2" title="2">time.se</a></code></pre></div>
<pre><code>## [1] 0.9177571</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">me =<span class="st"> </span><span class="kw">ceiling</span>(<span class="dv">10</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>time.se)<span class="op">/</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb26-2" title="2">me</a></code></pre></div>
<pre><code>## [1] 1.9</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw">round</span>(time.mean, <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>me</a></code></pre></div>
<pre><code>## [1] 27.2 31.0</code></pre>
</div>
<div id="normal-distribution-sd-se" class="section level2">
<h2><span class="header-section-number">5.2</span> Normal distribution, SD, SE</h2>
<p>Note, if we do not use bootstraping, we can use the standard CI formula (<a href="https://www.mathsisfun.com/data/confidence-interval.html" class="uri">https://www.mathsisfun.com/data/confidence-interval.html</a>). This formula assumes normal distribution. As we can see, this is close to the result based on the bootstrapping method.</p>
<p><span class="math display">\[\overline{X} \pm Z \frac{S}{\sqrt{n}}=29.11 \pm 1.96 \frac{20.72}{\sqrt{500}}=27.29, 30.93\]</span></p>
<p>Note that, in the following, the author used 2 times SE to calculate the CI. The relationship between SD and SE:</p>
<p>“Now the sample mean will vary from sample to sample; the way this variation occurs is described by the “sampling distribution” of the mean. We can estimate how much sample means will vary from the standard deviation of this sampling distribution, which we call the standard error (SE) of the estimate of the mean. As the standard error is a type of standard deviation, confusion is understandable. Another way of considering the standard error is as a measure of the precision of the sample mean." (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1255808/" class="uri">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1255808/</a>)</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">boot.mean =<span class="st"> </span><span class="cf">function</span>(x,B,<span class="dt">binwidth=</span><span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb30-2" title="2">{</a>
<a class="sourceLine" id="cb30-3" title="3">n =<span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb30-4" title="4">boot.samples =<span class="st"> </span><span class="kw">matrix</span>( <span class="kw">sample</span>(x,<span class="dt">size=</span>n<span class="op">*</span>B,<span class="dt">replace=</span><span class="ot">TRUE</span>), B, n)</a>
<a class="sourceLine" id="cb30-5" title="5">boot.statistics =<span class="st"> </span><span class="kw">apply</span>(boot.samples,<span class="dv">1</span>,mean)</a>
<a class="sourceLine" id="cb30-6" title="6">se =<span class="st"> </span><span class="kw">sd</span>(boot.statistics)</a>
<a class="sourceLine" id="cb30-7" title="7"><span class="kw">require</span>(ggplot2)</a>
<a class="sourceLine" id="cb30-8" title="8"><span class="cf">if</span> ( <span class="kw">is.null</span>(binwidth) )</a>
<a class="sourceLine" id="cb30-9" title="9">binwidth =<span class="st"> </span><span class="kw">diff</span>(<span class="kw">range</span>(boot.statistics))<span class="op">/</span><span class="dv">30</span></a>
<a class="sourceLine" id="cb30-10" title="10">p =<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">data.frame</span>(<span class="dt">x=</span>boot.statistics),<span class="kw">aes</span>(<span class="dt">x=</span>x)) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-11" title="11"><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y=</span>..density..),<span class="dt">binwidth=</span>binwidth) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">color=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb30-12" title="12"><span class="kw">plot</span>(p)</a>
<a class="sourceLine" id="cb30-13" title="13">interval =<span class="st"> </span><span class="kw">mean</span>(x) <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span><span class="op">*</span>se</a>
<a class="sourceLine" id="cb30-14" title="14"><span class="kw">print</span>( interval )</a>
<a class="sourceLine" id="cb30-15" title="15"><span class="kw">return</span>( <span class="kw">list</span>(<span class="dt">boot.statistics =</span> boot.statistics, <span class="dt">interval=</span>interval, <span class="dt">se=</span>se, <span class="dt">plot=</span>p) )</a>
<a class="sourceLine" id="cb30-16" title="16">}</a></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">out =<span class="st"> </span><span class="kw">with</span>(CommuteAtlanta, <span class="kw">boot.mean</span>(Distance, <span class="dt">B =</span> <span class="dv">1000</span>))</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre><code>## [1] 16.90747 19.40453</code></pre>
</div>
<div id="sample-function" class="section level2">
<h2><span class="header-section-number">5.3</span> Sample function</h2>
<p>To understand the function of sample in R.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">sample</span>(<span class="dv">20</span>,<span class="dt">replace =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>##  [1] 14 20 15 17 17  3  3  5 11  6 13  8 15 11 14 18  4  9  5 13</code></pre>
<p>The following uses loop to do the resampling. It uses sample function to index the numbers that they want to sample from the original sample. That is, [] suggests the indexing.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1">n =<span class="st"> </span><span class="kw">length</span>(CommuteAtlanta<span class="op">$</span>Distance)</a>
<a class="sourceLine" id="cb35-2" title="2">B =<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb35-3" title="3">result =<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, B)</a>
<a class="sourceLine" id="cb35-4" title="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B)</a>
<a class="sourceLine" id="cb35-5" title="5">{</a>
<a class="sourceLine" id="cb35-6" title="6">boot.sample =<span class="st"> </span><span class="kw">sample</span>(n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb35-7" title="7">result[i] =<span class="st"> </span><span class="kw">mean</span>(CommuteAtlanta<span class="op">$</span>Distance[boot.sample])</a>
<a class="sourceLine" id="cb35-8" title="8">}</a>
<a class="sourceLine" id="cb35-9" title="9"></a>
<a class="sourceLine" id="cb35-10" title="10"><span class="kw">with</span>(CommuteAtlanta, <span class="kw">mean</span>(Distance) <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(result))</a></code></pre></div>
<pre><code>## [1] 16.90019 19.41181</code></pre>
</div>
<div id="proportion" class="section level2">
<h2><span class="header-section-number">5.4</span> Proportion</h2>
<p>So far, we have dealed with means. How about porpotions?Remember that, when calculating means, it starts with a single column of data to calculate the mean. Similarly, when calculating porpotions, you can just use a single column of data.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1">reeses =<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">11</span>), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">19</span>))</a>
<a class="sourceLine" id="cb37-2" title="2">reeses.boot =<span class="st"> </span><span class="kw">boot.mean</span>(reeses, <span class="dv">1000</span>, <span class="dt">binwidth =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">30</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<pre><code>## [1] 0.1934925 0.5398408</code></pre>
<p>However, if we have 48 students (i.e., 48 observations) and thus we have a bigger sample. However, how can we do re-sampling? Based on the note, it is kind of simple. They group them together and then resample from it. Note that, when they re-sampling, the programming do not distinguish the difference between 48 observations. But just combined them as a single column (741+699=1440), and then generate a very long column (1440 times 1000) and then reshape it into a matrix (1440 time 1000). This is the basic logic of the boot.mean function.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">reeses =<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">741</span>), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">699</span>))</a>
<a class="sourceLine" id="cb39-2" title="2">reeses.boot =<span class="st"> </span><span class="kw">boot.mean</span>(reeses, <span class="dv">1000</span>, <span class="dt">binwidth =</span> <span class="fl">0.005</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre><code>## [1] 0.4884387 0.5407279</code></pre>
</div>
<div id="boot-package" class="section level2">
<h2><span class="header-section-number">5.5</span> boot package</h2>
<p>After having a basic idea of boostrapping, we can then use the package of boot.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="kw">library</span>(boot)</a></code></pre></div>
<pre><code>## Warning: package &#39;boot&#39; was built under R version 3.6.3</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="kw">data</span>(CommuteAtlanta)</a>
<a class="sourceLine" id="cb43-2" title="2"></a>
<a class="sourceLine" id="cb43-3" title="3">my.mean =<span class="st"> </span><span class="cf">function</span>(x, indices)</a>
<a class="sourceLine" id="cb43-4" title="4">{</a>
<a class="sourceLine" id="cb43-5" title="5"><span class="kw">return</span>( <span class="kw">mean</span>( x[indices] ) )</a>
<a class="sourceLine" id="cb43-6" title="6">}</a>
<a class="sourceLine" id="cb43-7" title="7"></a>
<a class="sourceLine" id="cb43-8" title="8">time.boot =<span class="st"> </span><span class="kw">boot</span>(CommuteAtlanta<span class="op">$</span>Time, my.mean, <span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb43-9" title="9"></a>
<a class="sourceLine" id="cb43-10" title="10"><span class="kw">boot.ci</span>(time.boot)</a></code></pre></div>
<pre><code>## Warning in boot.ci(time.boot): bootstrap variances needed for studentized
## intervals</code></pre>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 10000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = time.boot)
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   (27.27, 30.95 )   (27.22, 30.90 )  
## 
## Level     Percentile            BCa          
## 95%   (27.32, 31.00 )   (27.42, 31.17 )  
## Calculations and Intervals on Original Scale</code></pre>
</div>
<div id="concept-of-percentile" class="section level2">
<h2><span class="header-section-number">5.6</span> Concept of Percentile</h2>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="kw">require</span>(Lock5Data)</a>
<a class="sourceLine" id="cb46-2" title="2"><span class="kw">data</span>(ImmuneTea)</a>
<a class="sourceLine" id="cb46-3" title="3">tea =<span class="st"> </span><span class="kw">with</span>(ImmuneTea, InterferonGamma[Drink<span class="op">==</span><span class="st">&quot;Tea&quot;</span>])</a>
<a class="sourceLine" id="cb46-4" title="4">coffee =<span class="st"> </span><span class="kw">with</span>(ImmuneTea, InterferonGamma[Drink<span class="op">==</span><span class="st">&quot;Coffee&quot;</span>])</a>
<a class="sourceLine" id="cb46-5" title="5">tea.mean =<span class="st"> </span><span class="kw">mean</span>(tea)</a>
<a class="sourceLine" id="cb46-6" title="6">coffee.mean =<span class="st"> </span><span class="kw">mean</span>(coffee)</a>
<a class="sourceLine" id="cb46-7" title="7">tea.n =<span class="st"> </span><span class="kw">length</span>(tea)</a>
<a class="sourceLine" id="cb46-8" title="8">coffee.n =<span class="st"> </span><span class="kw">length</span>(coffee)</a>
<a class="sourceLine" id="cb46-9" title="9"></a>
<a class="sourceLine" id="cb46-10" title="10"></a>
<a class="sourceLine" id="cb46-11" title="11"></a>
<a class="sourceLine" id="cb46-12" title="12">B =<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb46-13" title="13"><span class="co"># create empty arrays for the means of each sample</span></a>
<a class="sourceLine" id="cb46-14" title="14">tea.boot =<span class="st"> </span><span class="kw">numeric</span>(B)</a>
<a class="sourceLine" id="cb46-15" title="15">coffee.boot =<span class="st"> </span><span class="kw">numeric</span>(B)</a>
<a class="sourceLine" id="cb46-16" title="16"><span class="co"># Use a for loop to take the samples</span></a>
<a class="sourceLine" id="cb46-17" title="17"><span class="cf">for</span> ( i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B )</a>
<a class="sourceLine" id="cb46-18" title="18">  {</a>
<a class="sourceLine" id="cb46-19" title="19">tea.boot[i] =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sample</span>(tea,<span class="dt">size=</span>tea.n,<span class="dt">replace=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb46-20" title="20">coffee.boot[i] =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sample</span>(coffee,<span class="dt">size=</span>coffee.n,<span class="dt">replace=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb46-21" title="21">}</a>
<a class="sourceLine" id="cb46-22" title="22"></a>
<a class="sourceLine" id="cb46-23" title="23">boot.stat =<span class="st"> </span>tea.boot <span class="op">-</span><span class="st"> </span>coffee.boot</a>
<a class="sourceLine" id="cb46-24" title="24">boot.stat</a></code></pre></div>
<pre><code>##   [1] 29.5909091 11.6909091 10.1363636 13.0272727 33.3000000 15.2454545
##   [7]  4.3090909 13.2090909 12.7545455 17.1636364 30.6272727 16.5636364
##  [13] 18.7909091 15.9454545 18.8909091 22.8818182 13.0181818 19.3454545
##  [19]  6.0090909 22.2181818 30.2636364  0.4090909 13.3272727 13.8727273
##  [25] 19.6363636 23.3909091 18.3181818 11.5636364 17.4272727 21.2636364
##  [31] 20.0363636 23.2818182  6.8272727 23.4909091 19.3636364 22.7818182
##  [37] 17.3000000  8.3545455 29.4181818  7.0363636 26.6454545  2.6272727
##  [43] 11.3636364 21.4363636 23.0818182 10.3272727 17.1727273 15.2090909
##  [49] 15.6272727 30.3727273 21.3090909  4.9909091 28.5545455 10.5454545
##  [55] 16.8818182  6.1363636 18.6545455 18.9090909  3.4818182 21.7818182
##  [61] 28.8454545 24.5272727 22.1363636 16.6909091  2.1727273 14.8272727
##  [67] 28.2000000 18.4545455 10.8272727  5.2181818 26.6545455 19.5727273
##  [73]  2.0090909 24.5454545 33.9363636 23.7000000 19.7090909 26.5454545
##  [79] 16.6636364 27.5909091 28.5363636 26.3090909 16.2454545 -0.5272727
##  [85] 19.4272727 29.3727273 13.8454545 37.1272727 16.3090909 18.2000000
##  [91] 22.3090909 29.2181818  7.2090909 12.2909091 12.4272727 26.9363636
##  [97] 14.0000000  5.8727273 18.4545455 25.0454545 14.2000000 10.5000000
## [103] 20.5818182  3.4000000 10.0272727 10.0000000 16.0181818 13.4181818
## [109] 10.6818182 23.2272727 10.3636364 12.0545455 19.5000000 21.1727273
## [115] 20.7181818 26.2272727 31.8363636 37.0454545 25.4909091  9.2272727
## [121] 20.7000000 23.8636364 26.2454545 11.9090909 33.8818182 17.6909091
## [127] 16.1000000 20.2909091  9.1272727 32.6909091 28.7090909 14.2545455
## [133] 13.1363636 26.8727273 25.9090909 17.0818182 18.5000000 27.2181818
## [139] 23.2181818 17.3272727 14.5090909 16.3727273 20.3272727  8.3909091
## [145] 28.7727273 27.4000000 12.0818182 23.7000000 14.5636364 22.0545455
## [151]  7.6363636 20.2000000 24.1545455 27.8272727 25.0181818 15.9636364
## [157] 17.9181818 21.0545455  1.0636364 21.6000000  3.6909091 16.8545455
## [163]  8.9363636  6.4454545  7.4909091 10.8272727 19.1272727  7.4272727
## [169] 11.5181818 21.7363636  4.4181818 10.2090909 22.6454545  7.7636364
## [175]  9.8272727 13.2090909 30.2090909 26.6363636 31.8363636 16.7909091
## [181] 12.8363636  7.7181818 -3.4454545  9.3454545 20.1090909 28.7363636
## [187] 17.1909091 17.5545455 21.1545455 14.3000000 23.2727273 13.7818182
## [193]  6.2363636 14.6636364 17.9909091 15.2363636 19.1090909 19.7818182
## [199] 27.6727273  9.1272727  9.7363636 14.0000000 25.9545455 20.9727273
## [205] 13.4727273 10.7818182 13.3909091  8.8909091 14.4545455 14.3636364
## [211] 15.9181818 17.1090909 13.4272727  7.8727273 -4.8636364 21.7181818
## [217]  5.2272727 14.1545455 17.5363636  5.2000000  1.4272727 15.3545455
## [223] 18.2090909 18.4181818 15.8000000 16.2727273 28.7000000 14.4363636
## [229] 31.7363636 18.0272727 11.9909091 14.4272727 11.9636364 36.4727273
## [235]  3.6272727 21.8909091 -3.5090909 27.5818182 23.7909091  2.1090909
## [241] 28.8818182 21.4636364 15.1454545 18.1818182 12.8454545  8.4454545
## [247]  9.8545455 25.0727273  8.7181818 15.2909091 20.1727273  2.9545455
## [253]  2.1727273 18.4000000 18.2909091 -6.1636364 19.5909091 22.6636364
## [259] 12.8636364 18.4818182 13.3363636 31.4181818 26.6454545 18.1363636
## [265] 18.6000000 10.0363636 14.2272727 19.4181818 21.5545455 14.4454545
## [271] 21.8909091 14.3727273  8.7272727  2.9272727 13.6545455 22.4818182
## [277]  9.2363636 41.7727273 29.5181818 11.8454545  9.9545455 19.6727273
## [283] 28.7000000 23.2636364 10.9272727 28.4727273 10.2181818 21.2727273
## [289] 25.7909091 17.7909091 16.9272727 28.1727273 30.8454545 21.0909091
## [295] 17.5818182 14.5909091 10.8545455 18.0181818 15.5272727  6.7272727
## [301]  9.2545455 11.7818182 20.8545455 29.1363636 20.2636364 16.5818182
## [307] 25.6272727  9.3818182 15.4454545 13.4454545 26.6454545 19.1727273
## [313] 25.7000000 21.9727273 13.4000000 19.2272727  3.0090909 20.9363636
## [319] 11.8818182 21.6272727 12.2363636 20.0090909 26.6454545 20.5454545
## [325]  7.7181818 23.8363636  7.4363636 18.2545455  9.4545455 -0.2545455
## [331]  9.7181818 20.6636364 18.6272727  4.7181818 18.8000000 14.1727273
## [337] 10.9454545  5.7181818 15.8545455 22.3909091 16.2181818 13.1818182
## [343] 10.8090909 -2.0272727 11.2727273 18.5909091 16.6363636 26.5545455
## [349] 12.6818182 29.7272727 23.0181818 32.6818182 12.7545455  8.1909091
## [355]  3.3636364 31.6545455 17.5000000  5.2636364  2.4000000 23.6909091
## [361] 12.9272727 11.1454545 18.9909091 21.3636364  7.5272727 12.5272727
## [367] 18.6909091 15.6909091 13.6272727 32.2090909  4.9181818 19.1090909
## [373]  4.0090909 14.6363636 18.9181818 19.2454545  7.7636364 19.1363636
## [379] 10.5545455 13.5727273 15.6000000 18.5636364 26.7090909 -0.2727273
## [385] 19.3363636  1.9090909 28.3272727 14.9181818 29.5181818 13.7636364
## [391]  6.6363636 24.0909091  8.1272727 16.8181818 33.0181818 18.6000000
## [397]  7.2727273  6.6545455 15.3727273 29.8818182 31.5181818 18.0909091
## [403] 17.7272727 24.3909091  9.6636364 18.2454545 19.2000000 12.7727273
## [409] 19.5000000 28.2454545 14.7363636 10.4636364 -0.1000000 17.0000000
## [415] 20.2272727 17.1454545 14.5181818  8.2909091 21.8454545 24.9363636
## [421] 30.2545455 27.6000000 16.8545455 16.4272727 20.6090909 -2.1636364
## [427] 13.1818182 21.0272727 14.4090909  6.6454545 22.4454545 33.9090909
## [433] 15.1000000 12.9000000 25.0545455 18.7818182 21.8909091 16.0909091
## [439] 27.9636364 13.2454545 20.6727273  3.2545455 23.2272727  7.7818182
## [445] 22.9909091 10.0727273 22.2818182 11.9181818 12.8545455 16.7545455
## [451] 18.3636364  3.1818182 11.4181818 18.7909091 22.2000000 20.0454545
## [457] 15.6727273  6.9545455 16.4727273 31.3545455 24.1000000 17.8000000
## [463] 21.4454545 12.0272727 15.4181818 23.4727273 27.0272727 16.8000000
## [469] 15.9636364 32.3727273 16.4454545  9.4272727 15.3454545  9.0545455
## [475] 15.8181818 23.9000000 10.5181818 21.1909091 23.1090909 24.7181818
## [481] 21.5454545  8.8727273 24.4000000 26.9545455 10.6727273 12.8636364
## [487] 31.2454545 10.1909091 19.0090909 25.2090909  5.1181818 23.3000000
## [493]  6.8181818 19.3909091 20.9090909 16.6454545 10.0454545 18.9363636
## [499] 20.8000000 19.5090909</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="co"># Find endpoints for 90%, 95%, and 99% bootstrap confidence intervals using percentiles.</span></a>
<a class="sourceLine" id="cb48-2" title="2"></a>
<a class="sourceLine" id="cb48-3" title="3"><span class="co"># 90%:  5% 95%</span></a>
<a class="sourceLine" id="cb48-4" title="4"><span class="kw">quantile</span>(boot.stat,<span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.95</span>))</a></code></pre></div>
<pre><code>##        5%       95% 
##  3.358182 30.255000</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="co"># 95%: 2.5% 97.5%</span></a>
<a class="sourceLine" id="cb50-2" title="2"><span class="kw">quantile</span>(boot.stat,<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</a></code></pre></div>
<pre><code>##      2.5%     97.5% 
##  1.656136 32.032045</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="co"># 99%:  0.5% 99.5%</span></a>
<a class="sourceLine" id="cb52-2" title="2"><span class="kw">quantile</span>(boot.stat,<span class="kw">c</span>(<span class="fl">0.005</span>,<span class="fl">0.995</span>))</a></code></pre></div>
<pre><code>##      0.5%     99.5% 
## -3.477591 36.761955</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="real-data-example-multiple-linear-regression.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
