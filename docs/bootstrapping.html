<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Bootstrapping | SEM and R</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Bootstrapping | SEM and R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Bootstrapping | SEM and R" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Bill" />


<meta name="date" content="2021-04-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="real-data-example-multiple-linear-regression.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SEM and R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> SEM and R</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#definitions-basic-concepts"><i class="fa fa-check"></i><b>2.1</b> Definitions (Basic Concepts)</a><ul>
<li class="chapter" data-level="2.1.1" data-path="intro.html"><a href="intro.html#observed-variable"><i class="fa fa-check"></i><b>2.1.1</b> Observed variable</a></li>
<li class="chapter" data-level="2.1.2" data-path="intro.html"><a href="intro.html#latent-variable"><i class="fa fa-check"></i><b>2.1.2</b> Latent variable</a></li>
<li class="chapter" data-level="2.1.3" data-path="intro.html"><a href="intro.html#exogenous-variable"><i class="fa fa-check"></i><b>2.1.3</b> Exogenous variable</a></li>
<li class="chapter" data-level="2.1.4" data-path="intro.html"><a href="intro.html#endogenous-variable"><i class="fa fa-check"></i><b>2.1.4</b> Endogenous variable</a></li>
<li class="chapter" data-level="2.1.5" data-path="intro.html"><a href="intro.html#measurement-model"><i class="fa fa-check"></i><b>2.1.5</b> Measurement model</a></li>
<li class="chapter" data-level="2.1.6" data-path="intro.html"><a href="intro.html#indicator-in-a-measurement-model"><i class="fa fa-check"></i><b>2.1.6</b> Indicator (in a measurement model)</a></li>
<li class="chapter" data-level="2.1.7" data-path="intro.html"><a href="intro.html#factor"><i class="fa fa-check"></i><b>2.1.7</b> Factor</a></li>
<li class="chapter" data-level="2.1.8" data-path="intro.html"><a href="intro.html#loading"><i class="fa fa-check"></i><b>2.1.8</b> Loading</a></li>
<li class="chapter" data-level="2.1.9" data-path="intro.html"><a href="intro.html#structural-model"><i class="fa fa-check"></i><b>2.1.9</b> Structural model</a></li>
<li class="chapter" data-level="2.1.10" data-path="intro.html"><a href="intro.html#regerssion-path"><i class="fa fa-check"></i><b>2.1.10</b> Regerssion path</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#the-path-diagram"><i class="fa fa-check"></i><b>2.2</b> The path diagram</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#lavaan-syntax"><i class="fa fa-check"></i><b>2.3</b> Lavaan syntax</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#regression-and-path-analysis"><i class="fa fa-check"></i><b>2.4</b> Regression and path analysis</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="real-data-example-simple-linear-regression.html"><a href="real-data-example-simple-linear-regression.html"><i class="fa fa-check"></i><b>3</b> Real data example (Simple linear regression)</a><ul>
<li class="chapter" data-level="3.1" data-path="real-data-example-simple-linear-regression.html"><a href="real-data-example-simple-linear-regression.html#read-the-data-into-the-r-studio-environment."><i class="fa fa-check"></i><b>3.1</b> Read the data into the R Studio environment.</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="real-data-example-multiple-linear-regression.html"><a href="real-data-example-multiple-linear-regression.html"><i class="fa fa-check"></i><b>4</b> Real data example (Multiple linear regression)</a></li>
<li class="chapter" data-level="5" data-path="bootstrapping.html"><a href="bootstrapping.html"><i class="fa fa-check"></i><b>5</b> Bootstrapping</a><ul>
<li class="chapter" data-level="5.1" data-path="bootstrapping.html"><a href="bootstrapping.html#introduction"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="bootstrapping.html"><a href="bootstrapping.html#normal-distribution-sd-se"><i class="fa fa-check"></i><b>5.2</b> Normal distribution, SD, SE</a></li>
<li class="chapter" data-level="5.3" data-path="bootstrapping.html"><a href="bootstrapping.html#sample-function"><i class="fa fa-check"></i><b>5.3</b> Sample function</a></li>
<li class="chapter" data-level="5.4" data-path="bootstrapping.html"><a href="bootstrapping.html#proportion"><i class="fa fa-check"></i><b>5.4</b> Proportion</a></li>
<li class="chapter" data-level="5.5" data-path="bootstrapping.html"><a href="bootstrapping.html#boot-package"><i class="fa fa-check"></i><b>5.5</b> boot package</a></li>
<li class="chapter" data-level="5.6" data-path="bootstrapping.html"><a href="bootstrapping.html#concept-of-percentile"><i class="fa fa-check"></i><b>5.6</b> Concept of Percentile</a></li>
<li class="chapter" data-level="5.7" data-path="bootstrapping.html"><a href="bootstrapping.html#use-boot-for-correlation"><i class="fa fa-check"></i><b>5.7</b> Use Boot for correlation</a></li>
<li class="chapter" data-level="5.8" data-path="bootstrapping.html"><a href="bootstrapping.html#use-r-for-mediation"><i class="fa fa-check"></i><b>5.8</b> Use R for mediation</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://williamdingpullman.github.io/" target="blank">Bill's State Notes</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">SEM and R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bootstrapping" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Bootstrapping</h1>
<div id="introduction" class="section level2">
<h2><span class="header-section-number">5.1</span> Introduction</h2>
<p><strong>Warning:</strong></p>
<p><strong>This page is for my own personal study purpose. Distribution is prohibited.</strong></p>
<p>The following note is made when I was studying Bret Larget’s note posted online.
<a href="http://pages.stat.wisc.edu/~larget/stat302/chap3.pdf" class="uri">http://pages.stat.wisc.edu/~larget/stat302/chap3.pdf</a></p>
<p>He used the data from LOck5data as an example.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">library</span>(Lock5Data)</a>
<a class="sourceLine" id="cb14-2" title="2"><span class="kw">data</span>(CommuteAtlanta)</a>
<a class="sourceLine" id="cb14-3" title="3"><span class="kw">str</span>(CommuteAtlanta)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    500 obs. of  5 variables:
##  $ City    : Factor w/ 1 level &quot;Atlanta&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Age     : int  19 55 48 45 48 43 48 41 47 39 ...
##  $ Distance: int  10 45 12 4 15 33 15 4 25 1 ...
##  $ Time    : int  15 60 45 10 30 60 45 10 25 15 ...
##  $ Sex     : Factor w/ 2 levels &quot;F&quot;,&quot;M&quot;: 2 2 2 1 1 2 2 1 2 1 ...</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">time.mean =<span class="st"> </span><span class="kw">with</span>(CommuteAtlanta, <span class="kw">mean</span>(Time))</a>
<a class="sourceLine" id="cb16-2" title="2"></a>
<a class="sourceLine" id="cb16-3" title="3">time.mean</a></code></pre></div>
<pre><code>## [1] 29.11</code></pre>
<p>Now, he sampled a (b X n) table. Note that, the Atlanta data has 500 row, as it has 500 observations (or, people). But, in the following new matrix, it is a (1000 times 500) table. Also, it should be noted that the logic of sample function in R. This webpage provides some insight into this function. Basically, the following R code randomly sample a bigger sample of (1000 times 500) from those 500 data points. After that, the matrix function put such (1000 times 500) data points into a matrix of (1000 times 500).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">B =<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb18-2" title="2">n =<span class="st"> </span><span class="kw">nrow</span>(CommuteAtlanta)</a>
<a class="sourceLine" id="cb18-3" title="3">boot.samples =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">sample</span>(CommuteAtlanta<span class="op">$</span>Time, <span class="dt">size =</span> B <span class="op">*</span><span class="st"> </span>n, <span class="dt">replace =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb18-4" title="4">                      B, n)</a></code></pre></div>
<p>Next, we need to calculate the mean for each row. Remember, we have 1000 rows. Note that, 1 in the apply function indicates that we calculate means on each row, whereas 2 indicates to each column.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">boot.statistics =<span class="st"> </span><span class="kw">apply</span>(boot.samples, <span class="dv">1</span>, mean)</a></code></pre></div>
<p>We can then plot all the means.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">require</span>(ggplot2)</a></code></pre></div>
<pre><code>## Loading required package: ggplot2</code></pre>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 3.6.3</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">ggplot</span>(<span class="kw">data.frame</span>(<span class="dt">meanTime =</span> boot.statistics),<span class="kw">aes</span>(<span class="dt">x=</span>meanTime)) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="kw">geom_histogram</span>(<span class="dt">binwidth=</span><span class="fl">0.25</span>,<span class="kw">aes</span>(<span class="dt">y=</span>..density..)) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-3" title="3"><span class="kw">geom_density</span>(<span class="dt">color=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">time.se =<span class="st"> </span><span class="kw">sd</span>(boot.statistics)</a>
<a class="sourceLine" id="cb24-2" title="2">time.se</a></code></pre></div>
<pre><code>## [1] 0.9340072</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">me =<span class="st"> </span><span class="kw">ceiling</span>(<span class="dv">10</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>time.se)<span class="op">/</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb26-2" title="2">me</a></code></pre></div>
<pre><code>## [1] 1.9</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw">round</span>(time.mean, <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>me</a></code></pre></div>
<pre><code>## [1] 27.2 31.0</code></pre>
</div>
<div id="normal-distribution-sd-se" class="section level2">
<h2><span class="header-section-number">5.2</span> Normal distribution, SD, SE</h2>
<p>Note, if we do not use bootstraping, we can use the standard CI formula (<a href="https://www.mathsisfun.com/data/confidence-interval.html" class="uri">https://www.mathsisfun.com/data/confidence-interval.html</a>). This formula assumes normal distribution. As we can see, this is close to the result based on the bootstrapping method.</p>
<p><span class="math display">\[\overline{X} \pm Z \frac{S}{\sqrt{n}}=29.11 \pm 1.96 \frac{20.72}{\sqrt{500}}=27.29, 30.93\]</span></p>
<p>Note that, in the following, the author used 2 times SE to calculate the CI. The relationship between SD and SE:</p>
<p>“Now the sample mean will vary from sample to sample; the way this variation occurs is described by the “sampling distribution” of the mean. We can estimate how much sample means will vary from the standard deviation of this sampling distribution, which we call the standard error (SE) of the estimate of the mean. As the standard error is a type of standard deviation, confusion is understandable. Another way of considering the standard error is as a measure of the precision of the sample mean." (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1255808/" class="uri">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1255808/</a>)</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">boot.mean =<span class="st"> </span><span class="cf">function</span>(x,B,<span class="dt">binwidth=</span><span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb30-2" title="2">{</a>
<a class="sourceLine" id="cb30-3" title="3">n =<span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb30-4" title="4">boot.samples =<span class="st"> </span><span class="kw">matrix</span>( <span class="kw">sample</span>(x,<span class="dt">size=</span>n<span class="op">*</span>B,<span class="dt">replace=</span><span class="ot">TRUE</span>), B, n)</a>
<a class="sourceLine" id="cb30-5" title="5">boot.statistics =<span class="st"> </span><span class="kw">apply</span>(boot.samples,<span class="dv">1</span>,mean)</a>
<a class="sourceLine" id="cb30-6" title="6">se =<span class="st"> </span><span class="kw">sd</span>(boot.statistics)</a>
<a class="sourceLine" id="cb30-7" title="7"><span class="kw">require</span>(ggplot2)</a>
<a class="sourceLine" id="cb30-8" title="8"><span class="cf">if</span> ( <span class="kw">is.null</span>(binwidth) )</a>
<a class="sourceLine" id="cb30-9" title="9">binwidth =<span class="st"> </span><span class="kw">diff</span>(<span class="kw">range</span>(boot.statistics))<span class="op">/</span><span class="dv">30</span></a>
<a class="sourceLine" id="cb30-10" title="10">p =<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">data.frame</span>(<span class="dt">x=</span>boot.statistics),<span class="kw">aes</span>(<span class="dt">x=</span>x)) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-11" title="11"><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y=</span>..density..),<span class="dt">binwidth=</span>binwidth) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">color=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb30-12" title="12"><span class="kw">plot</span>(p)</a>
<a class="sourceLine" id="cb30-13" title="13">interval =<span class="st"> </span><span class="kw">mean</span>(x) <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span><span class="op">*</span>se</a>
<a class="sourceLine" id="cb30-14" title="14"><span class="kw">print</span>( interval )</a>
<a class="sourceLine" id="cb30-15" title="15"><span class="kw">return</span>( <span class="kw">list</span>(<span class="dt">boot.statistics =</span> boot.statistics, <span class="dt">interval=</span>interval, <span class="dt">se=</span>se, <span class="dt">plot=</span>p) )</a>
<a class="sourceLine" id="cb30-16" title="16">}</a></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">out =<span class="st"> </span><span class="kw">with</span>(CommuteAtlanta, <span class="kw">boot.mean</span>(Distance, <span class="dt">B =</span> <span class="dv">1000</span>))</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre><code>## [1] 16.93958 19.37242</code></pre>
</div>
<div id="sample-function" class="section level2">
<h2><span class="header-section-number">5.3</span> Sample function</h2>
<p>To understand the function of sample in R.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">sample</span>(<span class="dv">20</span>,<span class="dt">replace =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>##  [1]  5 11 20 20 14 15  3 10 19 13  2  2 11  8  5  8 20 16 14 10</code></pre>
<p>The following uses loop to do the resampling. It uses sample function to index the numbers that they want to sample from the original sample. That is, [] suggests the indexing.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1">n =<span class="st"> </span><span class="kw">length</span>(CommuteAtlanta<span class="op">$</span>Distance)</a>
<a class="sourceLine" id="cb35-2" title="2">B =<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb35-3" title="3">result =<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, B)</a>
<a class="sourceLine" id="cb35-4" title="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B)</a>
<a class="sourceLine" id="cb35-5" title="5">{</a>
<a class="sourceLine" id="cb35-6" title="6">boot.sample =<span class="st"> </span><span class="kw">sample</span>(n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb35-7" title="7">result[i] =<span class="st"> </span><span class="kw">mean</span>(CommuteAtlanta<span class="op">$</span>Distance[boot.sample])</a>
<a class="sourceLine" id="cb35-8" title="8">}</a>
<a class="sourceLine" id="cb35-9" title="9"></a>
<a class="sourceLine" id="cb35-10" title="10"><span class="kw">with</span>(CommuteAtlanta, <span class="kw">mean</span>(Distance) <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(result))</a></code></pre></div>
<pre><code>## [1] 16.94883 19.36317</code></pre>
</div>
<div id="proportion" class="section level2">
<h2><span class="header-section-number">5.4</span> Proportion</h2>
<p>So far, we have dealed with means. How about porpotions?Remember that, when calculating means, it starts with a single column of data to calculate the mean. Similarly, when calculating porpotions, you can just use a single column of data.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1">reeses =<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">11</span>), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">19</span>))</a>
<a class="sourceLine" id="cb37-2" title="2">reeses.boot =<span class="st"> </span><span class="kw">boot.mean</span>(reeses, <span class="dv">1000</span>, <span class="dt">binwidth =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">30</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<pre><code>## [1] 0.1849012 0.5484321</code></pre>
<p>However, if we have 48 students (i.e., 48 observations) and thus we have a bigger sample. However, how can we do re-sampling? Based on the note, it is kind of simple. They group them together and then resample from it. Note that, when they re-sampling, the programming do not distinguish the difference between 48 observations. But just combined them as a single column (741+699=1440), and then generate a very long column (1440 times 1000) and then reshape it into a matrix (1440 time 1000). This is the basic logic of the boot.mean function.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">reeses =<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">741</span>), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">699</span>))</a>
<a class="sourceLine" id="cb39-2" title="2">reeses.boot =<span class="st"> </span><span class="kw">boot.mean</span>(reeses, <span class="dv">1000</span>, <span class="dt">binwidth =</span> <span class="fl">0.005</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre><code>## [1] 0.4888704 0.5402963</code></pre>
</div>
<div id="boot-package" class="section level2">
<h2><span class="header-section-number">5.5</span> boot package</h2>
<p>After having a basic idea of boostrapping, we can then use the package of boot.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="kw">library</span>(boot)</a></code></pre></div>
<pre><code>## Warning: package &#39;boot&#39; was built under R version 3.6.3</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="kw">data</span>(CommuteAtlanta)</a>
<a class="sourceLine" id="cb43-2" title="2"></a>
<a class="sourceLine" id="cb43-3" title="3">my.mean =<span class="st"> </span><span class="cf">function</span>(x, indices)</a>
<a class="sourceLine" id="cb43-4" title="4">{</a>
<a class="sourceLine" id="cb43-5" title="5"><span class="kw">return</span>( <span class="kw">mean</span>( x[indices] ) )</a>
<a class="sourceLine" id="cb43-6" title="6">}</a>
<a class="sourceLine" id="cb43-7" title="7"></a>
<a class="sourceLine" id="cb43-8" title="8">time.boot =<span class="st"> </span><span class="kw">boot</span>(CommuteAtlanta<span class="op">$</span>Time, my.mean, <span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb43-9" title="9"></a>
<a class="sourceLine" id="cb43-10" title="10"><span class="kw">boot.ci</span>(time.boot)</a></code></pre></div>
<pre><code>## Warning in boot.ci(time.boot): bootstrap variances needed for studentized
## intervals</code></pre>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 10000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = time.boot)
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   (27.29, 30.94 )   (27.25, 30.91 )  
## 
## Level     Percentile            BCa          
## 95%   (27.31, 30.97 )   (27.39, 31.07 )  
## Calculations and Intervals on Original Scale</code></pre>
</div>
<div id="concept-of-percentile" class="section level2">
<h2><span class="header-section-number">5.6</span> Concept of Percentile</h2>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="kw">require</span>(Lock5Data)</a>
<a class="sourceLine" id="cb46-2" title="2"><span class="kw">data</span>(ImmuneTea)</a>
<a class="sourceLine" id="cb46-3" title="3">tea =<span class="st"> </span><span class="kw">with</span>(ImmuneTea, InterferonGamma[Drink<span class="op">==</span><span class="st">&quot;Tea&quot;</span>])</a>
<a class="sourceLine" id="cb46-4" title="4">coffee =<span class="st"> </span><span class="kw">with</span>(ImmuneTea, InterferonGamma[Drink<span class="op">==</span><span class="st">&quot;Coffee&quot;</span>])</a>
<a class="sourceLine" id="cb46-5" title="5">tea.mean =<span class="st"> </span><span class="kw">mean</span>(tea)</a>
<a class="sourceLine" id="cb46-6" title="6">coffee.mean =<span class="st"> </span><span class="kw">mean</span>(coffee)</a>
<a class="sourceLine" id="cb46-7" title="7">tea.n =<span class="st"> </span><span class="kw">length</span>(tea)</a>
<a class="sourceLine" id="cb46-8" title="8">coffee.n =<span class="st"> </span><span class="kw">length</span>(coffee)</a>
<a class="sourceLine" id="cb46-9" title="9"></a>
<a class="sourceLine" id="cb46-10" title="10"></a>
<a class="sourceLine" id="cb46-11" title="11"></a>
<a class="sourceLine" id="cb46-12" title="12">B =<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb46-13" title="13"><span class="co"># create empty arrays for the means of each sample</span></a>
<a class="sourceLine" id="cb46-14" title="14">tea.boot =<span class="st"> </span><span class="kw">numeric</span>(B)</a>
<a class="sourceLine" id="cb46-15" title="15">coffee.boot =<span class="st"> </span><span class="kw">numeric</span>(B)</a>
<a class="sourceLine" id="cb46-16" title="16"><span class="co"># Use a for loop to take the samples</span></a>
<a class="sourceLine" id="cb46-17" title="17"><span class="cf">for</span> ( i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B )</a>
<a class="sourceLine" id="cb46-18" title="18">  {</a>
<a class="sourceLine" id="cb46-19" title="19">tea.boot[i] =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sample</span>(tea,<span class="dt">size=</span>tea.n,<span class="dt">replace=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb46-20" title="20">coffee.boot[i] =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sample</span>(coffee,<span class="dt">size=</span>coffee.n,<span class="dt">replace=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb46-21" title="21">}</a>
<a class="sourceLine" id="cb46-22" title="22"></a>
<a class="sourceLine" id="cb46-23" title="23">boot.stat =<span class="st"> </span>tea.boot <span class="op">-</span><span class="st"> </span>coffee.boot</a>
<a class="sourceLine" id="cb46-24" title="24">boot.stat</a></code></pre></div>
<pre><code>##   [1] 16.7909091 18.7818182 14.2363636 14.0090909  1.4000000 16.7909091
##   [7] 16.9272727 24.8545455 21.9454545 12.3545455 23.4181818 17.4272727
##  [13]  8.8545455 20.9727273 14.3454545 17.5909091 23.5909091  8.9909091
##  [19]  6.9727273 13.1272727  8.6272727 13.7181818  3.8545455 11.9818182
##  [25] 17.3090909 30.2545455 25.0272727 20.9545455 21.9818182 19.5636364
##  [31] -0.5090909 21.8090909 29.8090909 16.1000000  8.7181818 24.4545455
##  [37] 21.5727273 27.1181818 25.0272727 20.5000000 13.4090909 27.2545455
##  [43] 14.0181818 24.7181818 27.2272727 13.1363636 24.4090909 13.9454545
##  [49] 16.3909091 22.2636364  7.5000000 31.0000000 16.2727273  1.1818182
##  [55] 23.5363636 -5.2636364 34.9090909 18.8818182 14.2000000 24.5000000
##  [61] 13.7545455 31.1000000 18.0727273 10.3636364  8.4818182  9.4818182
##  [67] 14.8818182 18.6000000 17.2090909 22.8000000 20.8636364 19.4272727
##  [73] 14.3818182 19.3909091 16.4000000  6.0181818 13.2272727  7.2454545
##  [79] 25.2454545 22.6363636  5.4636364  1.6454545 23.6090909 16.2636364
##  [85] 15.0545455  7.0636364 12.1636364 20.8454545  3.5272727 23.2090909
##  [91]  6.6909091  3.8090909 10.9181818 19.9363636 18.2727273  7.3636364
##  [97] 27.8090909 17.5181818 23.6909091 24.1454545 30.5000000 19.9727273
## [103] 19.4090909 12.2636364 22.6181818 15.1727273 18.6636364 12.5636364
## [109] 23.8909091 20.6181818 12.5909091  4.8818182  5.6272727 25.2909091
## [115] 23.6272727 29.0727273 16.0636364 15.2909091 13.1363636 -0.3454545
## [121]  4.3636364 29.6090909  3.8818182  8.8909091 17.6727273 19.0272727
## [127]  3.9818182 16.3363636  6.8090909 22.2000000 24.4636364 23.8272727
## [133] 19.9454545  7.0545455 29.2272727 21.7818182 19.3272727 13.3727273
## [139] 14.4818182 18.6454545 23.4818182 20.2727273 -1.8454545 15.0818182
## [145] 26.6727273  9.4454545 22.6272727 14.8818182 23.9363636 19.4090909
## [151] 25.5000000 28.5000000 12.3636364 14.5545455 30.5363636 14.1000000
## [157] 11.4636364 19.3727273 12.6272727 19.6454545 15.8818182 16.6090909
## [163] 20.3000000 31.8727273 18.0909091 18.3636364 10.3363636  3.6363636
## [169] 20.4727273 15.2636364 32.6000000 13.7636364 25.7727273 10.9272727
## [175]  8.9909091 14.0181818 20.6818182 21.4818182 22.2363636 22.1272727
## [181]  9.3727273 29.1181818 20.0818182 38.0909091 15.1272727  3.6818182
## [187] 17.3181818 19.0090909 10.8181818 14.7909091  7.7272727 25.0909091
## [193] 14.7272727 13.1090909 20.4454545 14.4545455  9.6363636 21.2909091
## [199] 20.1454545 28.3363636 32.4363636 22.2545455 16.6818182  7.9090909
## [205] 14.7818182 22.1272727 22.4363636  6.3272727 13.7818182 10.9363636
## [211]  2.5272727 11.8363636 18.3545455  8.8727273 30.9181818 10.8727273
## [217] 13.8545455  9.4000000 35.6818182  2.0818182 -0.3272727  9.8363636
## [223] 18.1363636 23.1454545 26.9727273 17.6545455 12.7272727 15.6454545
## [229] 21.4909091 20.1181818 21.1727273 16.2636364 23.8818182  6.8545455
## [235] -2.6545455 10.8818182 21.5363636 26.3454545 25.5363636 15.9090909
## [241] 19.1272727 12.1545455 12.6818182 11.3454545 14.2636364 15.6272727
## [247] 14.0545455 25.2727273 12.5727273  4.0090909 14.0909091 22.1909091
## [253] 22.7545455 25.8000000  2.4545455 15.5909091 14.9727273 11.5727273
## [259] 23.9363636 26.0181818 17.5090909 26.7909091 26.5000000 25.1000000
## [265] 17.2090909 24.7545455  7.4363636  3.2181818 10.7636364 23.6181818
## [271] 17.6909091 18.7363636 24.2000000 14.4454545 20.4454545  7.8181818
## [277] 26.1090909 18.1000000 20.8636364  7.9181818 22.1272727 23.0090909
## [283] 18.3181818 21.6272727 29.3636364 12.4000000  8.6636364 24.3545455
## [289] 18.5727273 15.6727273 16.2090909 12.1000000  9.0090909 20.6545455
## [295] 21.2818182 17.4818182  8.1545455  1.5545455  9.2363636 26.8454545
## [301] 14.5363636  6.0363636 16.0545455 10.0545455 23.2818182 27.9272727
## [307] 11.8181818 17.1454545 16.9272727 25.4000000 26.8181818 26.3272727
## [313] 22.0545455 15.1454545 27.6272727 17.9454545 12.3181818  5.1636364
## [319] 23.3818182 -4.2181818 17.8000000 24.3636364 17.3454545 15.5000000
## [325] 22.9000000 18.2000000 -2.7545455 30.8727273 13.3272727  6.9727273
## [331] 13.2090909  9.2818182  9.0818182 12.3818182 23.8727273  6.0000000
## [337]  7.4181818 22.1000000 20.3727273 16.6454545  7.4727273 12.5454545
## [343] 11.9909091 13.0454545 18.5545455 30.4818182 17.8000000 12.4727273
## [349] 13.1272727  7.4000000 20.6090909 14.5181818 19.8181818 13.2636364
## [355]  9.7909091 14.6363636 17.2909091 22.8727273 24.6636364  6.6818182
## [361] 24.9818182 32.3636364 20.6545455 10.8727273 11.5000000 11.1818182
## [367] 17.3636364 23.1000000  9.4909091 10.4909091  6.9909091  3.4090909
## [373] 27.1909091 -0.2545455 17.1818182 24.5454545 13.3454545 17.3000000
## [379] 13.3545455 19.5909091 30.9545455 20.2000000 13.2272727 34.7090909
## [385]  0.5727273 18.2454545 15.9909091 15.6363636 11.7181818 15.7090909
## [391] 17.8545455 23.9727273 17.6818182 25.1090909 12.0454545  4.5818182
## [397] 16.8727273  6.5363636 11.0181818 23.5818182 16.0090909 26.5818182
## [403] 27.5545455 22.8000000  8.9090909 12.8909091 16.3727273 21.5000000
## [409] 28.8818182  9.6727273 23.3272727 17.2727273 20.4818182 -0.4818182
## [415] 10.8363636 22.3181818 12.8181818 21.7363636 16.6090909 38.0545455
## [421] 21.6909091  7.9090909  8.3272727 12.0727273 27.0363636 19.8181818
## [427] 21.4636364  0.3000000  0.8727273 24.8727273  1.1909091  8.2090909
## [433] 13.3909091  5.3909091 32.1545455 22.4727273 16.1272727 32.4636364
## [439] 22.6000000 22.4181818 11.6272727 26.4272727 10.3272727 38.7272727
## [445] 28.9727273 21.5545455  7.8454545 20.0363636 12.7000000 21.8636364
## [451]  3.6363636 12.6272727 10.6454545 29.7000000  3.2909091 21.8181818
## [457] 19.6818182  9.9454545 13.3181818 19.0272727 13.2636364 20.9181818
## [463] 19.0363636  3.6909091  6.8181818 19.0363636  4.9909091 23.7818182
## [469] 23.1636364 16.6818182 16.5909091 13.7727273 17.8181818 13.6181818
## [475] 10.3181818 20.5454545  2.8181818 18.0818182 11.7090909  0.3000000
## [481] 29.3090909 22.5909091 20.3454545 19.9272727 13.5363636 13.2363636
## [487] 24.6545455 14.7636364  3.8818182 21.2272727 19.4090909 18.0727273
## [493] 17.9363636 28.0363636 11.2727273 20.4545455 15.4181818 19.2454545
## [499] 13.6272727 32.1636364</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="co"># Find endpoints for 90%, 95%, and 99% bootstrap confidence intervals using percentiles.</span></a>
<a class="sourceLine" id="cb48-2" title="2"></a>
<a class="sourceLine" id="cb48-3" title="3"><span class="co"># 90%:  5% 95%</span></a>
<a class="sourceLine" id="cb48-4" title="4"><span class="kw">quantile</span>(boot.stat,<span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.95</span>))</a></code></pre></div>
<pre><code>##        5%       95% 
##  3.403182 29.375909</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="co"># 95%: 2.5% 97.5%</span></a>
<a class="sourceLine" id="cb50-2" title="2"><span class="kw">quantile</span>(boot.stat,<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</a></code></pre></div>
<pre><code>##       2.5%      97.5% 
##  0.7152273 31.5056818</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="co"># 99%:  0.5% 99.5%</span></a>
<a class="sourceLine" id="cb52-2" title="2"><span class="kw">quantile</span>(boot.stat,<span class="kw">c</span>(<span class="fl">0.005</span>,<span class="fl">0.995</span>))</a></code></pre></div>
<pre><code>##      0.5%     99.5% 
## -2.705045 36.880045</code></pre>
</div>
<div id="use-boot-for-correlation" class="section level2">
<h2><span class="header-section-number">5.7</span> Use Boot for correlation</h2>
<p>The following code is from: <a href="https://blog.methodsconsultants.com/posts/understanding-bootstrap-confidence-interval-output-from-the-r-boot-package/" class="uri">https://blog.methodsconsultants.com/posts/understanding-bootstrap-confidence-interval-output-from-the-r-boot-package/</a></p>
<p>This page is for my own personal study purpose. Distribution is prohibited.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1">data_correlation&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;data_correlation.csv&quot;</span>,<span class="dt">fileEncoding=</span><span class="st">&quot;UTF-8-BOM&quot;</span>)</a>
<a class="sourceLine" id="cb54-2" title="2"></a>
<a class="sourceLine" id="cb54-3" title="3">data_correlation</a></code></pre></div>
<pre><code>##    Student LSAT  GPA
## 1        1  576 3.39
## 2        2  635 3.30
## 3        3  558 2.81
## 4        4  578 3.03
## 5        5  666 3.44
## 6        6  580 3.07
## 7        7  555 3.00
## 8        8  661 3.43
## 9        9  651 3.36
## 10      10  605 3.13
## 11      11  653 3.12
## 12      12  575 2.74
## 13      13  545 2.76
## 14      14  572 2.88
## 15      15  594 2.96</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="kw">cor.test</span>(data_correlation<span class="op">$</span>LSAT,data_correlation<span class="op">$</span>GPA)</a></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  data_correlation$LSAT and data_correlation$GPA
## t = 4.4413, df = 13, p-value = 0.0006651
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.4385108 0.9219648
## sample estimates:
##       cor 
## 0.7763745</code></pre>
</div>
<div id="use-r-for-mediation" class="section level2">
<h2><span class="header-section-number">5.8</span> Use R for mediation</h2>
<p><a href="https://advstats.psychstat.org/book/mediation/index.php" class="uri">https://advstats.psychstat.org/book/mediation/index.php</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="real-data-example-multiple-linear-regression.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
