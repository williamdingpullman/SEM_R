<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Bootstrapping | SEM and R</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Bootstrapping | SEM and R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Bootstrapping | SEM and R" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Bill" />


<meta name="date" content="2021-04-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="real-data-example-multiple-linear-regression.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SEM and R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> SEM and R</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#definitions-basic-concepts"><i class="fa fa-check"></i><b>2.1</b> Definitions (Basic Concepts)</a><ul>
<li class="chapter" data-level="2.1.1" data-path="intro.html"><a href="intro.html#observed-variable"><i class="fa fa-check"></i><b>2.1.1</b> Observed variable</a></li>
<li class="chapter" data-level="2.1.2" data-path="intro.html"><a href="intro.html#latent-variable"><i class="fa fa-check"></i><b>2.1.2</b> Latent variable</a></li>
<li class="chapter" data-level="2.1.3" data-path="intro.html"><a href="intro.html#exogenous-variable"><i class="fa fa-check"></i><b>2.1.3</b> Exogenous variable</a></li>
<li class="chapter" data-level="2.1.4" data-path="intro.html"><a href="intro.html#endogenous-variable"><i class="fa fa-check"></i><b>2.1.4</b> Endogenous variable</a></li>
<li class="chapter" data-level="2.1.5" data-path="intro.html"><a href="intro.html#measurement-model"><i class="fa fa-check"></i><b>2.1.5</b> Measurement model</a></li>
<li class="chapter" data-level="2.1.6" data-path="intro.html"><a href="intro.html#indicator-in-a-measurement-model"><i class="fa fa-check"></i><b>2.1.6</b> Indicator (in a measurement model)</a></li>
<li class="chapter" data-level="2.1.7" data-path="intro.html"><a href="intro.html#factor"><i class="fa fa-check"></i><b>2.1.7</b> Factor</a></li>
<li class="chapter" data-level="2.1.8" data-path="intro.html"><a href="intro.html#loading"><i class="fa fa-check"></i><b>2.1.8</b> Loading</a></li>
<li class="chapter" data-level="2.1.9" data-path="intro.html"><a href="intro.html#structural-model"><i class="fa fa-check"></i><b>2.1.9</b> Structural model</a></li>
<li class="chapter" data-level="2.1.10" data-path="intro.html"><a href="intro.html#regerssion-path"><i class="fa fa-check"></i><b>2.1.10</b> Regerssion path</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#the-path-diagram"><i class="fa fa-check"></i><b>2.2</b> The path diagram</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#lavaan-syntax"><i class="fa fa-check"></i><b>2.3</b> Lavaan syntax</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#regression-and-path-analysis"><i class="fa fa-check"></i><b>2.4</b> Regression and path analysis</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="real-data-example-simple-linear-regression.html"><a href="real-data-example-simple-linear-regression.html"><i class="fa fa-check"></i><b>3</b> Real data example (Simple linear regression)</a><ul>
<li class="chapter" data-level="3.1" data-path="real-data-example-simple-linear-regression.html"><a href="real-data-example-simple-linear-regression.html#read-the-data-into-the-r-studio-environment."><i class="fa fa-check"></i><b>3.1</b> Read the data into the R Studio environment.</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="real-data-example-multiple-linear-regression.html"><a href="real-data-example-multiple-linear-regression.html"><i class="fa fa-check"></i><b>4</b> Real data example (Multiple linear regression)</a></li>
<li class="chapter" data-level="5" data-path="bootstrapping.html"><a href="bootstrapping.html"><i class="fa fa-check"></i><b>5</b> Bootstrapping</a><ul>
<li class="chapter" data-level="5.1" data-path="bootstrapping.html"><a href="bootstrapping.html#warning"><i class="fa fa-check"></i><b>5.1</b> Warning</a></li>
<li class="chapter" data-level="5.2" data-path="bootstrapping.html"><a href="bootstrapping.html#introduction"><i class="fa fa-check"></i><b>5.2</b> Introduction</a></li>
<li class="chapter" data-level="5.3" data-path="bootstrapping.html"><a href="bootstrapping.html#normal-distribution-sd-se"><i class="fa fa-check"></i><b>5.3</b> Normal distribution, SD, SE</a></li>
<li class="chapter" data-level="5.4" data-path="bootstrapping.html"><a href="bootstrapping.html#sample-function"><i class="fa fa-check"></i><b>5.4</b> Sample function</a></li>
<li class="chapter" data-level="5.5" data-path="bootstrapping.html"><a href="bootstrapping.html#proportion"><i class="fa fa-check"></i><b>5.5</b> Proportion</a></li>
<li class="chapter" data-level="5.6" data-path="bootstrapping.html"><a href="bootstrapping.html#boot-package"><i class="fa fa-check"></i><b>5.6</b> boot package</a></li>
<li class="chapter" data-level="5.7" data-path="bootstrapping.html"><a href="bootstrapping.html#concept-of-percentile"><i class="fa fa-check"></i><b>5.7</b> Concept of Percentile</a></li>
<li class="chapter" data-level="5.8" data-path="bootstrapping.html"><a href="bootstrapping.html#use-boot-for-correlation"><i class="fa fa-check"></i><b>5.8</b> Use Boot for correlation</a></li>
<li class="chapter" data-level="5.9" data-path="bootstrapping.html"><a href="bootstrapping.html#use-r-for-mediation"><i class="fa fa-check"></i><b>5.9</b> Use R for mediation</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://williamdingpullman.github.io/" target="blank">Bill's State Notes</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">SEM and R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bootstrapping" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Bootstrapping</h1>
<div id="warning" class="section level2">
<h2><span class="header-section-number">5.1</span> Warning</h2>
<p><strong>Warning:</strong></p>
<p><strong>This page is for my own personal study purpose. Distribution is prohibited.</strong></p>
<hr />
</div>
<div id="introduction" class="section level2">
<h2><span class="header-section-number">5.2</span> Introduction</h2>
<p>The following note is made when I was studying Bret Larget’s note posted online.
<a href="http://pages.stat.wisc.edu/~larget/stat302/chap3.pdf" class="uri">http://pages.stat.wisc.edu/~larget/stat302/chap3.pdf</a></p>
<p>He used the data from LOck5data as an example.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">library</span>(Lock5Data)</a>
<a class="sourceLine" id="cb14-2" title="2"><span class="kw">data</span>(CommuteAtlanta)</a>
<a class="sourceLine" id="cb14-3" title="3"><span class="kw">str</span>(CommuteAtlanta)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    500 obs. of  5 variables:
##  $ City    : Factor w/ 1 level &quot;Atlanta&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Age     : int  19 55 48 45 48 43 48 41 47 39 ...
##  $ Distance: int  10 45 12 4 15 33 15 4 25 1 ...
##  $ Time    : int  15 60 45 10 30 60 45 10 25 15 ...
##  $ Sex     : Factor w/ 2 levels &quot;F&quot;,&quot;M&quot;: 2 2 2 1 1 2 2 1 2 1 ...</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">time.mean =<span class="st"> </span><span class="kw">with</span>(CommuteAtlanta, <span class="kw">mean</span>(Time))</a>
<a class="sourceLine" id="cb16-2" title="2"></a>
<a class="sourceLine" id="cb16-3" title="3">time.mean</a></code></pre></div>
<pre><code>## [1] 29.11</code></pre>
<p>Now, he sampled a (b X n) table. Note that, the Atlanta data has 500 row, as it has 500 observations (or, people). But, in the following new matrix, it is a (1000 times 500) table. Also, it should be noted that the logic of sample function in R. This webpage provides some insight into this function. Basically, the following R code randomly sample a bigger sample of (1000 times 500) from those 500 data points. After that, the matrix function put such (1000 times 500) data points into a matrix of (1000 times 500).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">B =<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb18-2" title="2">n =<span class="st"> </span><span class="kw">nrow</span>(CommuteAtlanta)</a>
<a class="sourceLine" id="cb18-3" title="3">boot.samples =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">sample</span>(CommuteAtlanta<span class="op">$</span>Time, <span class="dt">size =</span> B <span class="op">*</span><span class="st"> </span>n, <span class="dt">replace =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb18-4" title="4">                      B, n)</a></code></pre></div>
<p>Next, we need to calculate the mean for each row. Remember, we have 1000 rows. Note that, 1 in the apply function indicates that we calculate means on each row, whereas 2 indicates to each column.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">boot.statistics =<span class="st"> </span><span class="kw">apply</span>(boot.samples, <span class="dv">1</span>, mean)</a></code></pre></div>
<p>We can then plot all the means.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">require</span>(ggplot2)</a></code></pre></div>
<pre><code>## Loading required package: ggplot2</code></pre>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 3.6.3</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">ggplot</span>(<span class="kw">data.frame</span>(<span class="dt">meanTime =</span> boot.statistics),<span class="kw">aes</span>(<span class="dt">x=</span>meanTime)) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="kw">geom_histogram</span>(<span class="dt">binwidth=</span><span class="fl">0.25</span>,<span class="kw">aes</span>(<span class="dt">y=</span>..density..)) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-3" title="3"><span class="kw">geom_density</span>(<span class="dt">color=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">time.se =<span class="st"> </span><span class="kw">sd</span>(boot.statistics)</a>
<a class="sourceLine" id="cb24-2" title="2">time.se</a></code></pre></div>
<pre><code>## [1] 0.8924831</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">me =<span class="st"> </span><span class="kw">ceiling</span>(<span class="dv">10</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>time.se)<span class="op">/</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb26-2" title="2">me</a></code></pre></div>
<pre><code>## [1] 1.8</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw">round</span>(time.mean, <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>me</a></code></pre></div>
<pre><code>## [1] 27.3 30.9</code></pre>
</div>
<div id="normal-distribution-sd-se" class="section level2">
<h2><span class="header-section-number">5.3</span> Normal distribution, SD, SE</h2>
<p>Note, if we do not use bootstraping, we can use the standard CI formula (<a href="https://www.mathsisfun.com/data/confidence-interval.html" class="uri">https://www.mathsisfun.com/data/confidence-interval.html</a>). This formula assumes normal distribution. As we can see, this is close to the result based on the bootstrapping method.</p>
<p><span class="math display">\[\overline{X} \pm Z \frac{S}{\sqrt{n}}=29.11 \pm 1.96 \frac{20.72}{\sqrt{500}}=27.29, 30.93\]</span></p>
<p>Note that, in the following, the author used 2 times SE to calculate the CI. The relationship between SD and SE:</p>
<p>“Now the sample mean will vary from sample to sample; the way this variation occurs is described by the “sampling distribution” of the mean. We can estimate how much sample means will vary from the standard deviation of this sampling distribution, which we call the standard error (SE) of the estimate of the mean. As the standard error is a type of standard deviation, confusion is understandable. Another way of considering the standard error is as a measure of the precision of the sample mean." (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1255808/" class="uri">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1255808/</a>)</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">boot.mean =<span class="st"> </span><span class="cf">function</span>(x,B,<span class="dt">binwidth=</span><span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb30-2" title="2">{</a>
<a class="sourceLine" id="cb30-3" title="3">n =<span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb30-4" title="4">boot.samples =<span class="st"> </span><span class="kw">matrix</span>( <span class="kw">sample</span>(x,<span class="dt">size=</span>n<span class="op">*</span>B,<span class="dt">replace=</span><span class="ot">TRUE</span>), B, n)</a>
<a class="sourceLine" id="cb30-5" title="5">boot.statistics =<span class="st"> </span><span class="kw">apply</span>(boot.samples,<span class="dv">1</span>,mean)</a>
<a class="sourceLine" id="cb30-6" title="6">se =<span class="st"> </span><span class="kw">sd</span>(boot.statistics)</a>
<a class="sourceLine" id="cb30-7" title="7"><span class="kw">require</span>(ggplot2)</a>
<a class="sourceLine" id="cb30-8" title="8"><span class="cf">if</span> ( <span class="kw">is.null</span>(binwidth) )</a>
<a class="sourceLine" id="cb30-9" title="9">binwidth =<span class="st"> </span><span class="kw">diff</span>(<span class="kw">range</span>(boot.statistics))<span class="op">/</span><span class="dv">30</span></a>
<a class="sourceLine" id="cb30-10" title="10">p =<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">data.frame</span>(<span class="dt">x=</span>boot.statistics),<span class="kw">aes</span>(<span class="dt">x=</span>x)) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-11" title="11"><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y=</span>..density..),<span class="dt">binwidth=</span>binwidth) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">color=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb30-12" title="12"><span class="kw">plot</span>(p)</a>
<a class="sourceLine" id="cb30-13" title="13">interval =<span class="st"> </span><span class="kw">mean</span>(x) <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span><span class="op">*</span>se</a>
<a class="sourceLine" id="cb30-14" title="14"><span class="kw">print</span>( interval )</a>
<a class="sourceLine" id="cb30-15" title="15"><span class="kw">return</span>( <span class="kw">list</span>(<span class="dt">boot.statistics =</span> boot.statistics, <span class="dt">interval=</span>interval, <span class="dt">se=</span>se, <span class="dt">plot=</span>p) )</a>
<a class="sourceLine" id="cb30-16" title="16">}</a></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">out =<span class="st"> </span><span class="kw">with</span>(CommuteAtlanta, <span class="kw">boot.mean</span>(Distance, <span class="dt">B =</span> <span class="dv">1000</span>))</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre><code>## [1] 16.88967 19.42233</code></pre>
</div>
<div id="sample-function" class="section level2">
<h2><span class="header-section-number">5.4</span> Sample function</h2>
<p>To understand the function of sample in R.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">sample</span>(<span class="dv">20</span>,<span class="dt">replace =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>##  [1] 10 10  7  9 18 10 11  9  9  7 10 10 18 14  6  5  9 17  1 14</code></pre>
<p>The following uses loop to do the resampling. It uses sample function to index the numbers that they want to sample from the original sample. That is, [] suggests the indexing.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1">n =<span class="st"> </span><span class="kw">length</span>(CommuteAtlanta<span class="op">$</span>Distance)</a>
<a class="sourceLine" id="cb35-2" title="2">B =<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb35-3" title="3">result =<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, B)</a>
<a class="sourceLine" id="cb35-4" title="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B)</a>
<a class="sourceLine" id="cb35-5" title="5">{</a>
<a class="sourceLine" id="cb35-6" title="6">boot.sample =<span class="st"> </span><span class="kw">sample</span>(n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb35-7" title="7">result[i] =<span class="st"> </span><span class="kw">mean</span>(CommuteAtlanta<span class="op">$</span>Distance[boot.sample])</a>
<a class="sourceLine" id="cb35-8" title="8">}</a>
<a class="sourceLine" id="cb35-9" title="9"></a>
<a class="sourceLine" id="cb35-10" title="10"><span class="kw">with</span>(CommuteAtlanta, <span class="kw">mean</span>(Distance) <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(result))</a></code></pre></div>
<pre><code>## [1] 16.92086 19.39114</code></pre>
</div>
<div id="proportion" class="section level2">
<h2><span class="header-section-number">5.5</span> Proportion</h2>
<p>So far, we have dealed with means. How about porpotions?Remember that, when calculating means, it starts with a single column of data to calculate the mean. Similarly, when calculating porpotions, you can just use a single column of data.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1">reeses =<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">11</span>), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">19</span>))</a>
<a class="sourceLine" id="cb37-2" title="2">reeses.boot =<span class="st"> </span><span class="kw">boot.mean</span>(reeses, <span class="dv">1000</span>, <span class="dt">binwidth =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">30</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<pre><code>## [1] 0.1972970 0.5360364</code></pre>
<p>However, if we have 48 students (i.e., 48 observations) and thus we have a bigger sample. However, how can we do re-sampling? Based on the note, it is kind of simple. They group them together and then resample from it. Note that, when they re-sampling, the programming do not distinguish the difference between 48 observations. But just combined them as a single column (741+699=1440), and then generate a very long column (1440 times 1000) and then reshape it into a matrix (1440 time 1000). This is the basic logic of the boot.mean function.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">reeses =<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">741</span>), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">699</span>))</a>
<a class="sourceLine" id="cb39-2" title="2">reeses.boot =<span class="st"> </span><span class="kw">boot.mean</span>(reeses, <span class="dv">1000</span>, <span class="dt">binwidth =</span> <span class="fl">0.005</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre><code>## [1] 0.4888569 0.5403097</code></pre>
</div>
<div id="boot-package" class="section level2">
<h2><span class="header-section-number">5.6</span> boot package</h2>
<p>After having a basic idea of boostrapping, we can then use the package of boot.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="kw">library</span>(boot)</a></code></pre></div>
<pre><code>## Warning: package &#39;boot&#39; was built under R version 3.6.3</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="kw">data</span>(CommuteAtlanta)</a>
<a class="sourceLine" id="cb43-2" title="2"></a>
<a class="sourceLine" id="cb43-3" title="3">my.mean =<span class="st"> </span><span class="cf">function</span>(x, indices)</a>
<a class="sourceLine" id="cb43-4" title="4">{</a>
<a class="sourceLine" id="cb43-5" title="5"><span class="kw">return</span>( <span class="kw">mean</span>( x[indices] ) )</a>
<a class="sourceLine" id="cb43-6" title="6">}</a>
<a class="sourceLine" id="cb43-7" title="7"></a>
<a class="sourceLine" id="cb43-8" title="8">time.boot =<span class="st"> </span><span class="kw">boot</span>(CommuteAtlanta<span class="op">$</span>Time, my.mean, <span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb43-9" title="9"></a>
<a class="sourceLine" id="cb43-10" title="10"><span class="kw">boot.ci</span>(time.boot)</a></code></pre></div>
<pre><code>## Warning in boot.ci(time.boot): bootstrap variances needed for studentized
## intervals</code></pre>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 10000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = time.boot)
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   (27.33, 30.90 )   (27.27, 30.83 )  
## 
## Level     Percentile            BCa          
## 95%   (27.39, 30.95 )   (27.46, 31.06 )  
## Calculations and Intervals on Original Scale</code></pre>
</div>
<div id="concept-of-percentile" class="section level2">
<h2><span class="header-section-number">5.7</span> Concept of Percentile</h2>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="kw">require</span>(Lock5Data)</a>
<a class="sourceLine" id="cb46-2" title="2"><span class="kw">data</span>(ImmuneTea)</a>
<a class="sourceLine" id="cb46-3" title="3">tea =<span class="st"> </span><span class="kw">with</span>(ImmuneTea, InterferonGamma[Drink<span class="op">==</span><span class="st">&quot;Tea&quot;</span>])</a>
<a class="sourceLine" id="cb46-4" title="4">coffee =<span class="st"> </span><span class="kw">with</span>(ImmuneTea, InterferonGamma[Drink<span class="op">==</span><span class="st">&quot;Coffee&quot;</span>])</a>
<a class="sourceLine" id="cb46-5" title="5">tea.mean =<span class="st"> </span><span class="kw">mean</span>(tea)</a>
<a class="sourceLine" id="cb46-6" title="6">coffee.mean =<span class="st"> </span><span class="kw">mean</span>(coffee)</a>
<a class="sourceLine" id="cb46-7" title="7">tea.n =<span class="st"> </span><span class="kw">length</span>(tea)</a>
<a class="sourceLine" id="cb46-8" title="8">coffee.n =<span class="st"> </span><span class="kw">length</span>(coffee)</a>
<a class="sourceLine" id="cb46-9" title="9"></a>
<a class="sourceLine" id="cb46-10" title="10"></a>
<a class="sourceLine" id="cb46-11" title="11"></a>
<a class="sourceLine" id="cb46-12" title="12">B =<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb46-13" title="13"><span class="co"># create empty arrays for the means of each sample</span></a>
<a class="sourceLine" id="cb46-14" title="14">tea.boot =<span class="st"> </span><span class="kw">numeric</span>(B)</a>
<a class="sourceLine" id="cb46-15" title="15">coffee.boot =<span class="st"> </span><span class="kw">numeric</span>(B)</a>
<a class="sourceLine" id="cb46-16" title="16"><span class="co"># Use a for loop to take the samples</span></a>
<a class="sourceLine" id="cb46-17" title="17"><span class="cf">for</span> ( i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B )</a>
<a class="sourceLine" id="cb46-18" title="18">  {</a>
<a class="sourceLine" id="cb46-19" title="19">tea.boot[i] =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sample</span>(tea,<span class="dt">size=</span>tea.n,<span class="dt">replace=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb46-20" title="20">coffee.boot[i] =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sample</span>(coffee,<span class="dt">size=</span>coffee.n,<span class="dt">replace=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb46-21" title="21">}</a>
<a class="sourceLine" id="cb46-22" title="22"></a>
<a class="sourceLine" id="cb46-23" title="23">boot.stat =<span class="st"> </span>tea.boot <span class="op">-</span><span class="st"> </span>coffee.boot</a>
<a class="sourceLine" id="cb46-24" title="24">boot.stat</a></code></pre></div>
<pre><code>##   [1] 28.345454545 21.000000000 16.254545455 30.690909091 19.518181818
##   [6]  7.845454545 27.309090909 17.436363636 21.690909091  9.918181818
##  [11] 19.200000000 10.563636364 16.463636364 17.218181818 14.527272727
##  [16] 38.618181818  9.172727273 26.563636364 21.809090909  2.790909091
##  [21] 14.436363636 28.927272727 17.918181818 14.663636364 37.163636364
##  [26] 21.054545455 24.345454545 11.890909091 17.618181818 13.063636364
##  [31] 26.990909091  8.200000000 24.663636364  0.590909091 13.645454545
##  [36] 21.490909091 21.900000000 29.445454545 17.472727273  9.790909091
##  [41] 20.945454545  8.590909091  5.872727273 22.472727273 18.981818182
##  [46] 11.563636364 11.972727273 25.490909091 25.927272727 34.872727273
##  [51]  9.490909091  9.627272727 11.218181818 24.872727273 36.163636364
##  [56] 14.800000000 22.254545455 11.663636364 22.336363636 17.300000000
##  [61] 21.254545455  9.272727273 21.418181818 25.700000000 15.736363636
##  [66] 13.563636364 20.354545455  5.181818182  6.209090909 11.672727273
##  [71]  8.763636364 27.527272727 20.272727273 16.054545455 18.209090909
##  [76]  7.800000000 26.754545455 28.572727273 34.036363636 14.345454545
##  [81] 22.490909091 22.390909091 30.390909091 21.790909091  2.854545455
##  [86] 19.000000000 29.172727273 26.027272727 19.736363636 18.327272727
##  [91] 16.281818182 23.445454545 18.200000000  8.509090909 12.990909091
##  [96] 21.872727273 19.945454545 28.127272727 15.245454545 24.318181818
## [101] 39.481818182 21.718181818 -1.454545455 16.872727273 15.172727273
## [106] 20.854545455 30.836363636 18.609090909  4.500000000 15.481818182
## [111] 13.845454545 13.945454545 18.136363636 17.709090909 16.563636364
## [116] 18.654545455 19.454545455 20.200000000  9.854545455 19.154545455
## [121] 22.127272727 16.100000000 24.527272727  4.281818182 19.281818182
## [126] 17.790909091  9.318181818 27.181818182 12.372727273 15.718181818
## [131] 19.500000000 23.918181818 15.672727273 12.427272727 23.954545455
## [136] 15.009090909  9.090909091 24.236363636 14.936363636 27.136363636
## [141] 12.854545455  8.981818182 34.100000000  9.727272727 20.809090909
## [146] 17.900000000 28.509090909 17.327272727 26.209090909 21.127272727
## [151] 21.027272727 13.909090909 32.845454545  2.854545455 32.845454545
## [156] 28.045454545 23.954545455  6.418181818  8.800000000  7.727272727
## [161] 15.518181818  6.336363636 17.227272727 26.636363636 18.754545455
## [166] 19.136363636 13.500000000  6.700000000 11.681818182 23.390909091
## [171] 17.345454545 29.872727273  9.136363636 25.163636364 22.890909091
## [176] 10.518181818 22.345454545 22.390909091 14.654545455 20.318181818
## [181] 30.218181818 24.100000000 20.581818182 24.000000000 23.536363636
## [186] 28.709090909 11.590909091  7.218181818 25.490909091 27.109090909
## [191] 21.145454545 15.900000000 15.281818182 14.254545455 25.436363636
## [196] 18.245454545 17.045454545 22.854545455  8.290909091  0.609090909
## [201] 30.081818182 18.009090909  3.636363636 18.200000000 17.036363636
## [206] 15.063636364 22.036363636 29.263636364 10.927272727 28.600000000
## [211] 23.781818182 17.045454545 25.472727273 15.200000000 14.000000000
## [216] 17.454545455 17.827272727 18.300000000 20.018181818 14.718181818
## [221] 13.627272727 19.927272727 15.781818182 19.054545455 31.190909091
## [226] 17.936363636 21.381818182 13.827272727  3.309090909  7.118181818
## [231] 18.454545455 13.172727273 15.381818182 -0.600000000 23.181818182
## [236]  5.545454545  9.336363636 15.890909091 22.209090909 28.918181818
## [241] 19.481818182 15.172727273 35.836363636 35.500000000 14.563636364
## [246] 18.245454545 24.545454545 14.118181818 13.909090909 13.645454545
## [251] 22.709090909 18.727272727  6.736363636 27.572727273 22.018181818
## [256] 26.527272727 21.272727273 22.718181818 21.136363636 22.427272727
## [261]  8.581818182 24.845454545  9.172727273  2.300000000 23.072727273
## [266] 21.663636364 13.045454545 23.981818182 21.063636364 17.700000000
## [271] 33.181818182  4.390909091 16.845454545 18.836363636 12.400000000
## [276] 13.581818182 24.309090909 24.272727273 16.736363636 25.481818182
## [281] 17.345454545 11.354545455 17.145454545 16.800000000 -0.890909091
## [286]  2.018181818  8.518181818 25.972727273 15.727272727  6.163636364
## [291] 11.845454545 15.463636364 27.836363636 15.154545455 22.700000000
## [296] 25.154545455 11.481818182 13.681818182 14.918181818  9.654545455
## [301] 12.254545455 18.354545455 28.772727273 12.900000000 15.645454545
## [306] 21.363636364 21.500000000 17.890909091  8.963636364 18.045454545
## [311] 10.427272727 11.509090909 13.809090909 -1.181818182 30.063636364
## [316] 22.372727273 16.481818182 12.818181818 16.363636364  8.136363636
## [321] 17.690909091  6.627272727 18.800000000 18.636363636 15.854545455
## [326] 14.109090909 11.218181818 17.518181818 21.081818182 11.809090909
## [331] 33.090909091 11.081818182 14.709090909 18.918181818  0.345454545
## [336] 11.372727273 13.454545455 21.018181818 17.409090909 27.436363636
## [341] 19.009090909 18.863636364 15.881818182 31.427272727 14.736363636
## [346] 18.118181818 28.345454545 20.654545455 19.609090909 23.854545455
## [351] 15.972727273 20.627272727 22.963636364 23.400000000 20.036363636
## [356] 32.363636364 28.272727273 17.218181818 12.963636364 10.445454545
## [361]  4.900000000 21.472727273 25.290909091 23.981818182 24.145454545
## [366] 25.100000000 12.818181818 24.963636364  3.900000000  1.336363636
## [371] 11.618181818 20.881818182 28.709090909 10.981818182  8.436363636
## [376] 17.236363636 23.263636364 29.445454545 23.727272727 16.700000000
## [381] 31.890909091 11.845454545  5.209090909 22.309090909 20.736363636
## [386]  0.009090909 14.654545455 15.209090909 15.045454545 14.163636364
## [391] 11.645454545 31.390909091  8.345454545 13.445454545 23.663636364
## [396] 28.209090909 19.036363636 13.600000000 23.572727273  7.936363636
## [401]  6.245454545 22.081818182 30.618181818 20.700000000 25.654545455
## [406] 31.600000000 -3.154545455 16.681818182  9.227272727 26.190909091
## [411] 23.827272727  9.381818182 24.181818182 29.445454545 11.945454545
## [416] 31.236363636 13.936363636 18.336363636 11.663636364 19.372727273
## [421]  8.009090909 19.636363636 11.118181818 37.354545455 17.081818182
## [426] 21.872727273 10.745454545 29.209090909 29.100000000 16.654545455
## [431] 24.445454545 18.536363636 16.100000000 19.672727273 18.754545455
## [436]  4.572727273  8.100000000 20.227272727  5.909090909  4.800000000
## [441] 11.909090909 21.372727273 20.554545455 17.881818182 23.309090909
## [446] 18.036363636 11.636363636 14.309090909 14.454545455 15.163636364
## [451] 22.100000000 23.227272727 25.727272727 10.036363636 23.390909091
## [456] 17.545454545 25.600000000 21.309090909  3.845454545 -1.590909091
## [461] 24.090909091 18.472727273 22.645454545  6.154545455 10.118181818
## [466]  2.709090909 16.972727273 12.954545455  9.945454545 14.000000000
## [471] 25.372727273 15.245454545 22.954545455 17.218181818 13.072727273
## [476]  6.354545455 23.636363636 14.172727273 19.836363636 38.218181818
## [481] 16.627272727 24.190909091 31.381818182 19.981818182  8.463636364
## [486] 15.618181818 22.954545455 13.000000000 31.981818182 18.363636364
## [491] 13.590909091 19.236363636 21.590909091 14.245454545 16.909090909
## [496]  7.590909091 16.463636364 19.309090909 17.563636364 16.818181818</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="co"># Find endpoints for 90%, 95%, and 99% bootstrap confidence intervals using percentiles.</span></a>
<a class="sourceLine" id="cb48-2" title="2"></a>
<a class="sourceLine" id="cb48-3" title="3"><span class="co"># 90%:  5% 95%</span></a>
<a class="sourceLine" id="cb48-4" title="4"><span class="kw">quantile</span>(boot.stat,<span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.95</span>))</a></code></pre></div>
<pre><code>##        5%       95% 
##  4.788636 30.698182</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="co"># 95%: 2.5% 97.5%</span></a>
<a class="sourceLine" id="cb50-2" title="2"><span class="kw">quantile</span>(boot.stat,<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</a></code></pre></div>
<pre><code>##      2.5%     97.5% 
##  2.494318 32.974318</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="co"># 99%:  0.5% 99.5%</span></a>
<a class="sourceLine" id="cb52-2" title="2"><span class="kw">quantile</span>(boot.stat,<span class="kw">c</span>(<span class="fl">0.005</span>,<span class="fl">0.995</span>))</a></code></pre></div>
<pre><code>##      0.5%     99.5% 
## -1.319545 37.790682</code></pre>
</div>
<div id="use-boot-for-correlation" class="section level2">
<h2><span class="header-section-number">5.8</span> Use Boot for correlation</h2>
<p>The following code is from: <a href="https://blog.methodsconsultants.com/posts/understanding-bootstrap-confidence-interval-output-from-the-r-boot-package/" class="uri">https://blog.methodsconsultants.com/posts/understanding-bootstrap-confidence-interval-output-from-the-r-boot-package/</a></p>
<p>This page is for my own personal study purpose. Distribution is prohibited.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1">data_correlation&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;data_correlation.csv&quot;</span>,<span class="dt">fileEncoding=</span><span class="st">&quot;UTF-8-BOM&quot;</span>)</a>
<a class="sourceLine" id="cb54-2" title="2"></a>
<a class="sourceLine" id="cb54-3" title="3">data_correlation</a></code></pre></div>
<pre><code>##    Student LSAT  GPA
## 1        1  576 3.39
## 2        2  635 3.30
## 3        3  558 2.81
## 4        4  578 3.03
## 5        5  666 3.44
## 6        6  580 3.07
## 7        7  555 3.00
## 8        8  661 3.43
## 9        9  651 3.36
## 10      10  605 3.13
## 11      11  653 3.12
## 12      12  575 2.74
## 13      13  545 2.76
## 14      14  572 2.88
## 15      15  594 2.96</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="kw">cor.test</span>(data_correlation<span class="op">$</span>LSAT,data_correlation<span class="op">$</span>GPA)</a></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  data_correlation$LSAT and data_correlation$GPA
## t = 4.4413, df = 13, p-value = 0.0006651
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.4385108 0.9219648
## sample estimates:
##       cor 
## 0.7763745</code></pre>
</div>
<div id="use-r-for-mediation" class="section level2">
<h2><span class="header-section-number">5.9</span> Use R for mediation</h2>
<p><a href="https://advstats.psychstat.org/book/mediation/index.php" class="uri">https://advstats.psychstat.org/book/mediation/index.php</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="real-data-example-multiple-linear-regression.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
